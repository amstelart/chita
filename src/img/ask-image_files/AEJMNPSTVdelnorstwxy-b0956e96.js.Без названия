flexbe_cli.entity.setClientJs("element","media01",{components:["image","video","slider"]});

!function(){const t={},i={};flexbe_cli.entity.setClientJs("element","spoiler01",{components:["image"],onReady(){this.$list=this.$area.find(".spoiler-list"),this.$items=this.$area.find(".spoiler-list-item"),this.isSpoilered=+this.$list.attr("data-spoiler"),this.isAccordion=+this.$list.attr("data-accordion"),i[this.id]||(i[this.id]=this.$items.length),i[this.id]!==this.$items.length&&(t[this.id]=[],i[this.id]=this.$items.length),t[this.id]||(t[this.id]=[]),this.isSpoilered?(this.isAccordion&&t[this.id].length>1&&(t[this.id]=t[this.id].slice(0,1)),t[this.id].forEach((t=>{const i=t&&this.$list.find(`[uid="${t}"]`);i.length&&this.toggleSpoiler({$item:i,state:!0,duration:0,force:!0})}))):t[this.id]=[],this.bindEvents()},bindEvents(){if(!this.isSpoilered)return!1;const t=".clickable";let i;this.$list.on("mousedown",t,(t=>{i=(!flexbe_cli.is_admin||!$(t.target).closest(".element-text, .component-image, .editor-simple-handle").length)&&(!$(t.target).closest(".not-clickable").length&&{target:t.currentTarget,x:t.screenX,y:t.screenY})})),this.$list.on("mouseup",t,(t=>{if(!i||i.target!==t.currentTarget||flexbe_cli.is_admin&&$(t.target).closest(".element-text").length)return;Math.sqrt((i.x-t.screenX)**2+(i.y-t.screenY)**2)<5&&this.toggleSpoiler({$item:$(t.currentTarget)}),i=!1}))},toggleSpoiler({$item:i,state:e,force:s,duration:n}){let o=0;const l=i.attr("uid");void 0===e&&(e="true"!==i.attr("data-expanded")),e?t[this.id].find((t=>t===l))||t[this.id].push(l):t[this.id]=t[this.id].filter((t=>t!==l));const r=i.find(".collapsed");if(r[0].inAnimation&&!s)return;r[0].inAnimation=!0;const h=i.find(".spoiler-text"),a=h.find(".spoiler-text-content"),d=r[0].scrollHeight,c="number"==typeof n?n:Math.max(250,Math.min(400,3*d));if(e){o=(h.height()-a.innerHeight())/2,o<10&&a.css("margin",`${o}px 0`)}if(r.off("transitionend").one("transitionend",(()=>{r.css("height","").toggleClass("collapsed--auto",e),r[0].inAnimation=!1})),r.css({height:`${d}px`,transitionDuration:`${c}ms`}),r[0].offsetHeight,r.toggleClass("collapsed--show",e),e||r.css("height","0"),i.attr("data-expanded",e),this.isAccordion&&e){i.siblings("[data-expanded=true]").each(((t,i)=>this.toggleSpoiler({$item:$(i),state:!1,force:!0})))}}})}();

flexbe_cli.entity.setClientJs("element","zone_cards",{components:["cards"],onUpdate(e){e.originId===e.id&&this.fixSwiper(e)},fixSwiper(e={}){var i;clearTimeout(this._changeTimer);const s=null==(i=flexbe_cli.components.getInstances(this).filter((e=>"cards"===e.is)))?void 0:i[0],t=s&&s.swiper;if(!t)return!1;if(document.body.contains(t.el)){if(e&&"items_add"===e.reason){const i=t.realIndex,s=e.reasonData.to;let n=i;i+t.params.slidesPerView<=s&&(n=s-t.params.slidesPerView+1),n!==i&&(this._changeTimer=setTimeout((()=>{t.slideTo(n)}),30))}e.styleRendered&&t.update(!1)}else this._changeTimer=setTimeout((()=>{this.fixSwiper(e)}),16)}});

flexbe_cli.entity.setClientJs("element","zone",{components:["backgroundElement"],onInit(){this.setMeta()},onUpdate(){this.setMeta()},setMeta(){const i=this.lastViewport,e=this.lastVisibility;this.lastViewport=flexbe_cli.resize.viewportWidth,this.lastVisibility=flexbe_cli.is_admin&&$("body").hasClass("show-hidden"),this.needFixOrder=this.needFixOrder||this.lastViewport!==i||this.lastVisibility!==e},onResize(){this.inScreen&&this.isVisible&&this.fixElementOrder()},fixElementOrder(){if(this.setMeta(),!this.needFixOrder)return;this.needFixOrder=!1;const i=this.$area.find(".elements-list");i.find("[data-hidden]").length&&i.each(((i,e)=>{const t=$(e).find(".element-item--static"),s=t.filter(":visible");t.removeClass("is-first-child is-last-child"),s.first().addClass("is-first-child"),s.last().addClass("is-last-child")}))}});

flexbe_cli.entity.setClientJs("modal","BASIC",{components:["background","icon"],onOpen(){this.$scroll=this.$scroll||this.$area.find(".scroller"),this.$content=this.$content||this.$area.find(".modal-content"),this.$close=this.$close||this.$scroll.find("> .close--outside"),this.dispatchClasses(),this.$scroll.on("scroll.close-check",$.throttle((()=>{this.dispatchClasses()}),60))},onClose(){this.$area.find(".component-form .is_error").removeClass("is_error"),this.$scroll.off("scroll.close-check")},dispatchClasses(){if("mobile"!==flexbe_cli.resize.responsiveMode||!this.$close.length)return;const s=this.$scroll[0].scrollTop,e=this.$content[0].offsetTop,o=this.$close[0].offsetHeight;this.$close.toggleClass("stuck",e-s<o)}});

flexbe_cli.entity.setClientJs("modal","GRID",{components:["background"],onClose(){this.$area.find(".component-form .is_error").removeClass("is_error")}});

!function(){const t=new WeakMap,e=e=>{const{is:i,component:s}=e;t.has(s)||t.set(s,Math.floor(999999999*Math.random()));return`.component-${i}-${t.get(s)}`};class i{get is(){return this.constructor.is}constructor({component:t,core:e,reason:i}){this.require=[],this.core=null,this.owner=null,this.root=null,this.component=null,this.$component=null,this.componentWidth=null,this.componentHeight=null,this.isPageLoaded=!1,this.isInited=!1,this.isLoaded=!1,this.isUpdated=!1,this.isOpen=null,this.isVisible=null,this.inScreen=!1,this.inBeside=!1,this.inView=!1,this.inFocus=!1,this.wasVisible=null,this.wasScreen=!1,this.wasBeside=!1,this.wasView=!1,this.wasFocus=!1,this.core=e,this.owner=e.area,this.root=e.root,this.component=t,this.$component=$(t),this.isPageLoaded="complete"===document.readyState,this.isUpdated="update"===i}onInit(){}onLoad(){}onVisible(t){}onScreen(t){}onBeside(t){}onView(t){}onFocus(t){}onResize(t){}onOpen(t){}onClose(t){}onPageLoad(){}onWindowResize(){}onDestroy(){}_inheritEvents(){this._clearEvents();const t=e(this);this.core.$area.on(`tween${t}`,(t=>this._syncStates(t.detail))),this.core.$area.on(`open${t}`,(t=>this._onOpen(t.detail))),this.core.$area.on(`close${t}`,(t=>this._onClose(t.detail)))}_clearEvents(){const t=e(this);this.core.$area.off(t)}_syncStates({force:t=!1}={}){const e=this.component.offsetWidth,i=this.component.offsetHeight,s=null==this.componentWidth||null==this.componentHeight,n=this.core.isVisible&&!(!e&&!i),a=this.core.inBeside&&n,r=this.core.inScreen&&n,o=this.core.inView&&n,u=this.core.inFocus&&n,l=this.componentWidth!==e,h=this.componentHeight!==i,c=t||n&&!s&&(l||h);n&&(this.componentWidth=e,this.componentHeight=i),n!==this.isVisible&&this._onVisible({state:n}),c&&this._onResize({force:t}),a!==this.inBeside&&this._onBeside({state:a}),r!==this.inScreen&&this._onScreen({state:r}),o!==this.inView&&this._onView({state:o}),u!==this.inFocus&&this._onFocus({state:u})}_onInit(){this.isInited=!0,this._inheritEvents(),this._syncStates(),"function"==typeof this.onInit&&this.onInit(),flexbe_cli.require(this.require,(()=>this._onLoad()))}_onLoad(){this.isLoaded=!0,"function"==typeof this.onLoad&&this.onLoad()}_onVisible({state:t}){if(null==this.isVisible)return this.isVisible=t,void(this.wasVisible=t);const e=t&&!this.wasVisible;this.isVisible=t,this.onVisible({state:t,first:e}),t&&(this.wasVisible=!0)}_onScreen({state:t}){const e=t&&!this.wasScreen;this.inScreen=t,this.onScreen({state:t,first:e}),t&&(this.wasScreen=!0)}_onView({state:t}){const e=t&&!this.wasView;this.inView=t,this.onView({state:t,first:e}),t&&(this.wasView=!0)}_onBeside({state:t}){const e=t&&!this.wasBeside;this.inBeside=t,this.onBeside({state:t,first:e}),t&&(this.wasBeside=!0)}_onFocus({state:t}){const e=t&&!this.wasFocus;this.inFocus=t,this.onFocus({state:t,first:e}),t&&(this.wasFocus=!0)}_onResize(t){this.onResize(t)}_onOpen(t){this.isOpen=!0,this._syncStates(),this.onOpen(t)}_onClose(t){this.isOpen=!1,this._syncStates(),this.onClose(t)}_onPageLoad(){this.isPageLoaded=!0,this.onPageLoad()}_onWindowResize(){this.onWindowResize()}destroy(){this._clearEvents(),this.onDestroy()}}i.is=null;class s{static getRecaptchaSettings(){const t={env:{},...flexbe_cli.vars._group.flood&&flexbe_cli.vars._group.flood.captcha||{}};return!t.visible&&flexbe_cli.is_admin&&(t.enabled=0),t}constructor(t,e=s.getRecaptchaSettings()){this.id=t.id,this.options=t,this.$form=t.$form,this.enabled=e.enabled,this.isOptional=e.ttl>0,this.isVisible=e.visible,this.isInvisible=!e.visible,this.inModal=!(!this.isVisible||!this.isOptional&&!t.inModal),this._widgetId=null,this._token=null}get loaded(){return"undefined"!=typeof grecaptcha}get recaptchaSiteKey(){const{env:t}=s.getRecaptchaSettings();return this.isVisible?t.RECAPTCHA_VISIBLE_SITE_KEY:t.RECAPTCHA_INVISIBLE_SITE_KEY}init(){if(!this.enabled||!this.loaded||this._inited)return;this._inited=!0;const t=this.$form.find(".g-recaptcha-"+(this.isVisible?"visible":"invisible"));t[0]&&this.render(t[0])}getToken(){return this._token}render(t){if(!this.enabled||!this.loaded)return;let e=flexbe_cli.run.is_screen_mobile_s?"compact":"normal";this.isInvisible&&(e="invisible");const i={size:e,sitekey:this.recaptchaSiteKey,callback:t=>{this._token=t,this.closeModal(),this._onSuccess(t)},"expired-callback":()=>{this.reset(),this._onExpired()},"error-callback":()=>{this.reset(),this._onError()}};grecaptcha.ready((()=>{try{this._widgetId=grecaptcha.render(t,i)}catch(t){}"function"==typeof this.options.onRecaptchaRendered&&this.options.onRecaptchaRendered(this)}))}runModalCaptcha(){const t=`captcha-${this.id}`;if(!this._modal){const e=$(`\n                <div class="m_modal m_${t}" data-is="modal" data-id="${t}" data-m-id="CAPTCHA">\n                    <div class="modal-data">\n                        <div class="component-bg bg-color" data-type="color" data-parallax="0" data-component="background">\n                            <div class="overlay" data-opacity="1"></div>\n                        </div>\n\n                        <div class="modal-content" data-contrast="dark" data-v="1" data-as="1">\n                            <div class="close close-times"></div>\n\n                            <div class="recaptcha-title">\n                                ${flexbe_cli.locale.tr("quiz::captcha_label")}\n                            </div>\n\n                            <div id="recaptcha-${this.id}" class="g-recaptcha g-recaptcha-visible"></div>\n                        </div>\n                    </div>\n                </div>\n            `);flexbe_cli.modal.$list.append(e),this._modal=flexbe_cli.entity.initArea(e)}flexbe_cli.events.emit("ui_modal_open",{id:t,options:{hash:!1,rise:!0,onClose:()=>{this._token||this._onError()}}});const e=this._modal.$area.find(".g-recaptcha");null!=this._widgetId?this.reset():this.render(e[0])}closeModal(){this._modal&&flexbe_cli.events.emit("ui_modal_close",{id:this._modal.id})}runInvisibleChallenge(){this.enabled&&this.loaded&&!this.isVisible&&(grecaptcha.ready((()=>grecaptcha.execute(this._widgetId))),$('iframe[title="recaptcha challenge"]').parent().parent().css("z-index",2e3))}reset(){this.enabled&&this.loaded&&(this._token=null,null!=this._widgetId&&grecaptcha.ready((()=>grecaptcha.reset(this._widgetId))),"function"==typeof this.options.onReset&&this.options.onReset(this))}_onError(...t){"function"==typeof this.options.onError&&this.options.onError(this,...t)}_onSuccess(...t){"function"==typeof this.options.onSuccess&&this.options.onSuccess(this,...t)}_onExpired(...t){"function"==typeof this.options.onExpired&&this.options.onExpired(this,...t)}}function n(t){if(!t||!t.offsetParent)return null;let e=0,i=0;for(;t;){if("fixed"===$.css(t,"position")){e+=window.scrollY,i+=window.scrollX;break}e+=t.offsetTop-t.scrollTop,i+=t.offsetLeft-t.scrollLeft,t=t.offsetParent}return{top:Math.round(e),left:Math.round(i)}}const a={selectClass:"",dropdownClass:"",selectedClass:"selected",optionSelector:"option",attrValue:"value",position:"over",padding:10,title:!1};class r{static create(t){return new this(t)}constructor(t){this.opts=t,this.config={...a,...t.config},this.element=t.element,this.$select=$(this.element),this.isNativeSelect=this.$select.is("select"),this.selectAllDevice="select"===this.$select.data("type"),this.blurTimeOut=!1,this.blurListTimeOut=!1,this.focused=!1,this.active=!1,this.createSelect()}createSelect(){this.$customSelect=$(`\n            <div class="dropdown-container ${this.config.selectClass}">\n                <div tabindex="0" class="dropdown-select">\n                    <span class="dropdown-select__content selected"></span>\n\n                    <span class="arrow">\n                        <svg viewBox="0 0 10 6" xmlns="http://www.w3.org/2000/svg">\n                            <path fill="currentColor" d="M 1.4 6.99441e-15L 0 1.34043L 5 6L 10 1.34043L 8.6 0L 5 3.34998L 1.4 6.99441e-15Z"/>\n                        </svg>\n                    </span>\n                </div>\n            </div>\n        `),this.$customSelect__content=this.$customSelect.find(".dropdown-select__content"),this.$select.after(this.$customSelect),this.syncSelect(),this.selectAllDevice||flexbe_cli.run.is_screen_desktop||!flexbe_cli.responsive?(this.$customSelect.off("click.selected").on("click.selected",".dropdown-select",(()=>{clearTimeout(this.blurListTimeOut),this.active?this.collapse():this.activate()})),this.$customSelect.off("focus.selectFocus").on("focus.selectFocus",".dropdown-select",(()=>{this.focused=!0,this.$listWrapper||this.createList()})),this.isNativeSelect&&this.$select.off("change.changeSelect").on("change.changeSelect",(t=>{const e=this.$listWrapper.find(".dropdown-select-ul li"),i=t.currentTarget.value;e.removeClass(this.config.selectedClass),e.filter(((t,e)=>e.getAttribute(this.config.attrValue)===i)).addClass(this.config.selectedClass),this.$customSelect__content.text(i),"function"==typeof this.opts.onChange&&this.opts.onChange(t)})),this.$customSelect.off("keydown.selectKeydown").on("keydown.selectKeydown",".dropdown-select",(t=>{if(this.focused&&[13,27,32,38,40].includes(t.keyCode)){t.preventDefault();const e=this.$list.find(`.option-e.${this.config.selectedClass}`).filter((t=>!$(t).attr("disabled")));if(40===t.keyCode)t.preventDefault(),this.select(e.next(),!1),this.scrollToSelected();else if(38===t.keyCode)t.preventDefault(),this.select(e.prev(),!1),this.scrollToSelected();else if(this.active||32!==t.keyCode){if(this.active&&[13,27,32].includes(t.keyCode))return t.preventDefault(),this.collapse(),!1}else t.preventDefault(),this.activate()}}))):this.$select.off("change.selected").on("change.selected",(t=>{const e=t.target.value;this.$customSelect__content.text(e)}))}syncSelect(){const t=this.$select.children(this.config.optionSelector).filter(((t,e)=>{var i;return(null!=(i=e.selected)?i:$(e).attr("selected"))||$(e).hasClass(this.config.selectedClass)})).eq(0),e=t.html()||"—";this.$customSelect__content.attr(this.config.attrValue,t.attr(this.config.attrValue)),this.$customSelect__content.html(e)}createList(){const t=this.$select.children(this.config.optionSelector);this.$listWrapper=$(`\n            <div class="select-container-in-body">\n                <div class="overlay"></div>\n                <ul class="dropdown-select-ul scrollable ${this.config.dropdownClass}" tabindex="0"></ul>\n            </div>\n        `),this.$list=this.$listWrapper.find(".dropdown-select-ul"),t.each(((t,e)=>{var i,s,n;const a=$(e),r=(null!=(i=e.selected)?i:a.attr("selected"))||a.hasClass(this.config.selectedClass),o=(null!=(s=e.disabled)?s:a.attr("disabled"))||a.hasClass("disabled"),u=(null!=(n=e.locked)?n:a.attr("locked"))||a.hasClass("locked"),l=this.isNativeSelect?a.val():a.attr(this.config.attrValue),h=a.html().trim()||"—";let c="";this.config.title&&(c=a.attr("data-title"));const d=$(`<li title='${c}' class="option-e"></li>`);r&&!o&&d.addClass(this.config.selectedClass),o&&d.attr("disabled","disabled"),u&&d.attr("locked","locked"),d.attr(this.config.attrValue,l),d.html(h),this.$list.append(d)}))}select(t,e){if(!t[0])return;if(t.attr("disabled"))return clearTimeout(this.blurTimeOut),void this.$list.off("blur.listBlur").on("blur.listBlur",(()=>{this.focused=!1,this.blurListTimeOut=setTimeout((()=>{this.$listWrapper&&this.collapse()}),200)}));const i=t.attr(this.config.attrValue);if(t.siblings("li").removeClass(this.config.selectedClass),t.addClass(this.config.selectedClass),this.isNativeSelect)this.$select.val(i);else{const t=this.$select.children(this.config.optionSelector);t.removeAttr("selected").removeClass(this.config.selectedClass),t.filter(`[${this.config.attrValue}=${i}]`).addClass(this.config.selectedClass).attr("selected","selected")}this.syncSelect(),e&&this.collapse()}scrollToSelected(){const t=this.$list[0].offsetHeight;if(this.$list[0].scrollHeight<=t)return!1;const e=this.$list.children(".option-e").find(`.${this.config.selectedClass}`)[0];e&&e.scrollIntoView()}collapse(){clearTimeout(this.blurTimeOut),this.active=!1,this.$listWrapper.removeClass("active rise"),this.$listWrapper.detach(),"function"==typeof this.opts.onCollapse&&this.opts.onCollapse()}activate(){if(this.active)return!1;this.active=!0,this.createList();const t=this.config.padding||0,e={...n(this.$customSelect[0]),width:this.$customSelect.width(),height:this.$customSelect.height()};"under"===this.config.position&&(e.top=e.top+e.height+t),this.$listWrapper.off("click.closeSelect").on("click.closeSelect",".overlay",(t=>{this.collapse();const e=document.elementFromPoint(t.clientX,t.clientY);e&&e.focus()})),this.$listWrapper.off("click.selectLi").on("click.selectLi",".dropdown-select-ul li",(t=>{const e=$(t.currentTarget);this.select(e,!0),"function"==typeof this.opts.onSelect&&this.opts.onSelect(t)})),this.$listWrapper.off("mousewheel.selectUl").on("mousewheel.selectUl",".dropdown-select-ul",(t=>{const e=t.currentTarget.scrollHeight,i=t.currentTarget.clientHeight;return!(t.currentTarget.scrollTop===e-i&&t.deltaY>0||0===t.currentTarget.scrollTop&&t.deltaY<0)})),$("body").append(this.$listWrapper),clearTimeout(this.blurTimeOut),this.$list.css({left:`${e.left}px`,top:`${e.top}px`,width:`${e.width}px`}),this.$listWrapper.outerWidth(),this.$listWrapper.toggleClass("rise",!!this.$select.closest(".m_modal, .w_widget").length),this.$listWrapper.addClass("active"),this.scrollToSelected(),"function"==typeof this.opts.onActivate&&this.opts.onActivate()}}class o{constructor(t){if(this.$legend=t.find(".range-legend"),this.$component=t.find(".range-outer"),this.$input=t.find("input"),this.startEdge=this.$component.data("start"),this.isDouble=!!this.$component.data("double"),this.endEdge=this.$component.data("end"),this.range=this.endEdge-this.startEdge,this.barWidth=this.$component.width(),this.step=this.$component.data("step")||1,this.steps=Math.round(this.range/this.step),this.legendType=this.$legend.data("type"),this.legendText=1==+this.$legend.data("text"),this.animated=!0,this.duration=this.steps<10&&1/this.steps*300,this.fractExponent=Math.max(this.getFract(this.startEdge),this.getFract(this.endEdge),this.getFract(this.step)),this.fractDevider=10**this.fractExponent,this.$value=$(".range-value",this.$component),this.$endRunner=$(".range-runner-right",this.$component),this.$endRunnerTip=$(".runner-tip",this.$endRunner),this.$endRunnerValue=$(".value",this.$endRunner),this.endRunnerWidth=this.$endRunner.width(),this.$startRunner=$(".range-runner-left",this.$component),this.$startRunnerValue=$(".value",this.$startRunner),this.$startRunnerTip=$(".runner-tip",this.$startRunner),this.startRunnerWidth=this.$startRunner.width(),this.maxAllowedLeft=20,this.maxAllowedRight=flexbe_cli.resize.viewportWidth-20,this.defaultShift=this.$endRunner.width()/2,this.activeRunner=!1,this.isDouble){const t=this.$input.data("value").split(" — ");this.startValue=+t[0],this.endValue=+t[1]}else this.endValue=+this.$input.data("value"),this.startValue=+this.startEdge;this.endParams={},this.drawLegend(),this.updateTooltip(this.$startRunnerTip),this.updateTooltip(this.$endRunnerTip),this.setEvents(),this.setRunnersValue()}formatN(t){return`${t<0?"-":""}${flexbe_cli.locale.formatNumber(t,this.fractExponent)}`}getFract(t){const e=`${t}`.split(".");return e[1]&&e[1].length||0}drawLegend(){if(this.legendText)return!1;const t=this.$legend.find(".from"),e=this.$legend.find(".to");if(t.text(this.formatN(this.startEdge)),e.text(this.formatN(this.endEdge)),"complex"!==this.legendType)return!1;this.$legend.find(".legend-point:not(.from, .to)").off("click").remove(),this.$legend.removeClass("complex").addClass("limits");const i=[`${this.formatN(this.startEdge)}`.length,`${this.formatN(this.endEdge)}`.length,`${this.formatN(this.step)}`.length],s=(i[0]+i[1]+i[2])/3,n=Math.max(this.startEdge,this.endEdge),a=[5*this.step*this.fractDevider/this.fractDevider];for(let t=1;t<=12;t++){const e=10**t*this.step;e<n&&d(a,e,this.fractDevider)}let r;const o=Math.ceil(this.$legend.find(i[0]>i[1]?".from":".to").width()/Math.max(i[1],i[0])),u=Math.round(.83*this.barWidth/(o*s)),l=this.range>0?1:-1;for(let t=Math.min(u,10);t>=3;t--){const e=c(this.step,Math.abs(this.steps),t,a);if(e&&Number.isInteger(e/this.step)&&Number.isInteger(this.range/e)){r=e;break}}if(!r||!Number.isInteger(this.range/(r*l))||this.range/(r*l)<3)for(let t=Math.min(Math.round(this.range/this.step),u,10);t>=2;t-=1){const e=this.roundFraction(this.range/t);if(e%this.step==0){r=e*l;break}}const h=this.roundFraction(this.range/(r*l));if(r&&Number.isInteger(h)){const t=[];for(let e=1;e<h;e+=1){const i=Math.round((this.startEdge+r*e*l)*this.fractDevider)/this.fractDevider;t.push(`<div class="legend-point" data-value="${i}">${this.formatN(i)}</div>`)}h>2&&(this.$legend.attr("data-count",h),this.$legend.removeClass("limits").addClass("complex"));const e=$(t.join(""));this.$legend.find(".from").after(e)}else this.$legend.removeClass("complex").addClass("limits");function c(t,e,i,s){return s.includes(e/i*t)?e/i*t:s.includes((e+1)/i*t)?(e+1)/i*t:s.includes((e+2)/i*t)?(e+2)/i*t:s.includes((e+3)/i*t)?(e+3)/i*t:s.includes((e+4)/i*t)?(e+4)/i*t:s.includes((e+5)/i*t)?(e+5)/i*t:s.includes((e+6)/i*t)?(e+6)/i*t:s.includes((e+7)/i*t)?(e+7)/i*t:s.includes((e+8)/i*t)?(e+8)/i*t:!!s.includes((e+9)/i*t)&&(e+9)/i*t}function d(t,e,i){for(let s=1;s<10;s+=1)t.push(Math.round(e*s*i)/i),t.push(Math.round(e*s*i+e/2)/i)}this.$legend.find(".legend-point:not(.to), .legend-point:not(.from)").each(((t,e)=>{$(e).on("click",(()=>{if(this.updateBarWidth(),this.isDouble){const t=(this.startValue+this.endValue)/2,i=+$(e).data("value"),s=this.startEdge<this.endEdge?1:-1;i*s>=t*s?this.endValue=i:this.startValue=i}else this.endValue=$(e).data("value");this.setRunnersValue()}))}))}roundFraction(t){return Math.round(1e10*t)/1e10}setRunnersValue(t=!1){if(!Number.isFinite(this.endValue)||!Number.isFinite(this.range)||this.isDouble&&!Number.isFinite(this.startValue))return!1;const e=this.startEdge<this.endEdge?1:-1;"start"===this.activeRunner?this.startValue*e<=this.startEdge*e?this.startValue=this.startEdge:this.startValue*e>=this.endValue*e&&(this.startValue=this.endValue):this.endValue*e>=this.endEdge*e?this.endValue=this.endEdge:this.endValue*e<=this.startValue*e&&(this.endValue=this.startValue);const i=this.isDouble?this.startValue:this.startEdge,s=this.isDouble?(this.startValue-this.startEdge)/(this.range/100):0,n=(this.endValue-i)/(this.range/100);this.endValue=Math.round(this.endValue*this.fractDevider)/this.fractDevider,this.startValue=Math.round(this.startValue*this.fractDevider)/this.fractDevider,requestAnimationFrame((()=>{this.$endRunnerValue.text(this.formatN(this.endValue)),this.$startRunnerValue.text(this.formatN(this.startValue))})),"end"===this.activeRunner?this.updateTooltip(this.$endRunnerTip):this.updateTooltip(this.$startRunnerTip),this.$value.css({width:`${n}%`,marginLeft:`${s}%`}),t||(this.isDouble?this.$input.val(`${this.startValue} — ${this.endValue}`):this.$input.val(this.endValue))}updateTooltip(t){const e=t.closest(".range-runner");if(e&&e.length){const e=t.innerWidth(),i=t.closest(".range-runner")[0].getBoundingClientRect().left+this.startRunnerWidth/2;let s;s=e/2>i+this.maxAllowedLeft?e/2-(i-this.maxAllowedLeft):e/2+i>this.maxAllowedRight?this.maxAllowedRight-i-e/2:0,t.css({transform:`translateX(${s}px)`})}}getValueFromLength(t){const e=this.range/(this.barWidth/t);return(Math.round(e/this.step)+this.startEdge/this.step)*this.step}applyEndPosition(t){return this["start"===this.activeRunner?"startValue":"endValue"]=this.getValueFromLength(t),this.setRunnersValue(),!0}touchHendler(t){if(!this.endParams.active||1!==t.touches.length)return $("body")[0].removeEventListener("touchmove",this.touchHendler),!1;this.toggleAnimation(!1),t.preventDefault(),t.stopPropagation();const e=t.touches[0].pageX-this.endParams.left-this.endParams.shift;this.applyEndPosition(e)}startWatchingEvents(t=this.defaultShift){this.endParams={active:!0,left:this.$component.offset().left,shift:t},clearTimeout(this.calmRunnersTimeout),"end"===this.activeRunner?this.$endRunner.addClass("active"):this.$startRunner.addClass("active")}toggleAnimation(t){t?Math.abs(this.barWidth/this.steps)<15?this.$component.addClass("animated"):(this.$component.removeClass("active-animation"),this.duration&&this.$component.removeClass("animation-speed-"+(12-Math.abs(Math.round(this.steps))))):Math.abs(this.barWidth/this.steps)<15?this.$component.removeClass("animated"):(this.$component.addClass("active-animation"),this.duration&&this.$component.addClass("animation-speed-"+(12-Math.abs(Math.round(this.steps)))))}afterRunnerReleased(){this.endParams.active&&("start"===this.activeRunner?this.$startRunner.focus():this.$endRunner.focus()),this.endParams.active=!1,this.debounceActive(),this.barWidth/this.steps<15?this.$component.addClass("animated"):this.$component.removeClass("active-animation"),this.toggleAnimation(!0)}updateBarWidth(){const t=this.$component.width();t!==this.barWidth&&(this.barWidth=t,"complex"===this.legendType&&this.drawLegend())}setEvents(){const t=$(window),e=this;function i(i){if(!e.endParams.active)return t.off("mousemove.dragRange"),!1;e.toggleAnimation(!1);const s=i.pageX-e.endParams.left-e.endParams.shift;return e.applyEndPosition(s),!0}this.$component.on("resized",(()=>{this.updateBarWidth()})),this.$component.on("touchstart",(e=>{if(1!==e.touches.length)return!1;if(this.isDouble){const t=(this.$endRunner.offset().left+this.$startRunner.offset().left)/2;this.activeRunner=e.touches[0].pageX>=t?"end":"start","start"===this.activeRunner?(this.$startRunner.addClass("upper-runner"),this.$endRunner.removeClass("upper-runner")):(this.$endRunner.addClass("upper-runner"),this.$startRunner.removeClass("upper-runner"))}else this.activeRunner="end";e.stopPropagation(),this.updateBarWidth();const i=e.touches[0].pageX-this.$value.offset().left;this.startWatchingEvents(),this.applyEndPosition(i-this.defaultShift),t[0].addEventListener("touchmove",this.touchHendler.bind(this),{passive:!1}),t.on("touchend.range",(()=>{this.afterRunnerReleased(),t[0].removeEventListener("touchmove",this.touchHendler),t.off("touchend.range")}))})),this.$component.on("mousedown",(e=>{const s=e.pageX-this.$component.offset().left;if(this.isDouble){const t=(this.$endRunner.offset().left+this.$startRunner.offset().left)/2;this.activeRunner=e.pageX>=t?"end":"start","start"===this.activeRunner?(this.$startRunner.addClass("upper-runner"),this.$endRunner.removeClass("upper-runner")):(this.$endRunner.addClass("upper-runner"),this.$startRunner.removeClass("upper-runner"))}this.updateBarWidth(),this.startWatchingEvents(),this.applyEndPosition(s-this.defaultShift),"start"===this.activeRunner?this.$startRunner.focus():this.$endRunner.focus(),t.on("mousemove.dragRange",i),t.on("mouseup.range",(()=>{this.afterRunnerReleased(),t.off("mousemove.dragRange"),t.off("mouseup.range")}))})),this.$endRunner.on("touchstart",(e=>{if(1!==e.touches.length)return!1;e.stopPropagation(),this.updateBarWidth(),this.activeRunner="end",this.$startRunner.removeClass("upper-runner"),this.$endRunner.addClass("upper-runner"),e.stopPropagation(),this.startWatchingEvents(e.touches[0].pageX-this.$endRunner.offset().left),this.toggleAnimation(!1),t[0].addEventListener("touchmove",this.touchHendler.bind(this),{passive:!1}),t.on("touchend.range",(()=>{this.afterRunnerReleased(),t[0].removeEventListener("touchmove",this.touchHendler),t.off("touchend.range")}))})),this.$startRunner.on("touchstart",(e=>{if(1!==e.touches.length)return!1;e.stopPropagation(),this.updateBarWidth(),this.activeRunner="start",this.$startRunner.addClass("upper-runner"),this.$endRunner.removeClass("upper-runner"),e.stopPropagation(),this.startWatchingEvents(e.touches[0].pageX-this.$startRunner.offset().left),this.toggleAnimation(!1),t[0].addEventListener("touchmove",this.touchHendler.bind(this),{passive:!1}),t.on("touchend.range",(()=>{this.afterRunnerReleased(),t[0].removeEventListener("touchmove",this.touchHendler),t.off("touchend.range")}))})),this.$endRunner.on("mousedown",(e=>{e.stopPropagation(),this.activeRunner="end",this.$startRunner.removeClass("upper-runner"),this.$endRunner.addClass("upper-runner"),this.updateBarWidth(),this.$endRunner.focus(),this.startWatchingEvents(e.pageX-this.$endRunner.offset().left),this.toggleAnimation(!1),t.on("mousemove.dragRange",i),t.on("mouseup.range",(()=>{this.afterRunnerReleased(),t.off("mousemove.dragRange"),t.off("mouseup.range")}))})),this.$startRunner.on("mousedown",(e=>{e.stopPropagation(),this.activeRunner="start",this.$startRunner.addClass("upper-runner"),this.$endRunner.removeClass("upper-runner"),this.updateBarWidth(),this.$startRunner.focus(),this.startWatchingEvents(e.pageX-this.$startRunner.offset().left),this.toggleAnimation(!1),t.on("mousemove.dragRange",i),t.on("mouseup.range",(()=>{this.afterRunnerReleased(),t.off("mousemove.dragRange"),t.off("mouseup.range")}))})),this.$legend.find(".legend-point.to, .legend-point.from").each(((t,e)=>{$(e).on("click",(()=>{if(this.updateBarWidth(),this.isDouble){const t=this.startEdge<this.endEdge?1:-1,i=(this.startValue+this.endValue)/2,s=+$(e).data("value");s*t>=i*t?this.endValue=s:this.startValue=s}else this.endValue=$(e).data("value");this.setRunnersValue()}))})),this.$input.on("change",(()=>{if(this.isDouble){const t=this.$input.val().split(" — ");this.startValue=+t[0],this.endValue=+t[1]}else this.endValue=+this.$input.val();this.setRunnersValue(!0)})),this.$startRunner.on("keyup",(t=>{t.preventDefault(),this.activeRunner="start",this.handleKeydown(t,this.$startRunner)})),this.$endRunner.on("keyup",(t=>{t.preventDefault(),this.activeRunner="end",this.handleKeydown(t,this.$endRunner)})),this.$startRunner.on("keydown",(t=>{this.activeRunner="start",this.handleKeyup(t,this.$startRunner)})),this.$endRunner.on("keydown",(t=>{this.activeRunner="end",this.handleKeyup(t,this.$endRunner)})),this.$startRunner.on("blur",(()=>{this.handleBlur()}))}handleBlur(){this.movingInterval&&(clearInterval(this.movingInterval),this.movingInterval=!1),this.movingDebounceTimeout&&(clearTimeout(this.movingDebounceTimeout),this.movingDebounceTimeout=!1)}handleKeydown(t,e){if(this.movingInterval&&(clearInterval(this.movingInterval),this.movingInterval=!1),this.movingDebounceTimeout&&(clearTimeout(this.movingDebounceTimeout),this.movingDebounceTimeout=!1),[37,38,39,40].includes(t.keyCode)){const i=t.shiftKey?10:1,s="start"===this.activeRunner?"startValue":"endValue";38===t.keyCode||39===t.keyCode?this[s]=(this[s]/this.step+i)*this.step:37!==t.keyCode&&40!==t.keyCode||(this[s]=(this[s]/this.step-i)*this.step),e.addClass("active"),this.debounceActive(),this.setRunnersValue()}}handleKeyup(t,e){9!==t.keyCode&&[37,38,39,40].includes(t.keyCode)&&(t.preventDefault(),e.addClass("active"),this.debounceActive(),this.startDebouncedMove(t))}startDebouncedMove(t){this.movingDebounceTimeout&&(clearTimeout(this.movingDebounceTimeout),this.movingDebounceTimeout=!1),this.movingDebounceTimeout=setTimeout((()=>{this.movingInterval=setInterval((()=>{this.debounceActive();const e=t.shiftKey?10:1,i="start"===this.activeRunner?"startValue":"endValue";38===t.keyCode||39===t.keyCode?this[i]=(Math.round(this[i]/this.step)+e)*this.step:37!==t.keyCode&&40!==t.keyCode||(this[i]=(Math.round(this[i]/this.step)-e)*this.step),this.setRunnersValue()}),50)}),300)}debounceActive(){this.calmRunnersTimeout&&clearTimeout(this.calmRunnersTimeout),this.calmRunnersTimeout=setTimeout((()=>{this.$endRunner.removeClass("active"),this.$startRunner.removeClass("active")}),500)}}const u={phone:{RU:["+7 (***) ***-**-**","8 (***) ***-**-**"],KZ:["+7 (***) ***-**-**","8 (***) ***-**-**"],UA:["+38 (***) ***-****"],BY:["+375 ** *******"],US:["+1 (***) ***-****"]}};function l(t){if(void 0===window.IMask)return;const e={signed:!0,lazy:!0,padFractionalZeros:!0,definitions:"tel"===t.getAttribute("type")?{"*":/\d/,"#":/\d/}:{"#":/\d/,"@":/[A-Za-z\u00AA\u00B5\u00BA\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u0527\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0\u08A2-\u08AC\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0977\u0979-\u097F\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C33\u0C35-\u0C39\u0C3D\u0C58\u0C59\u0C60\u0C61\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D60\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F4\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191C\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19C1-\u19C7\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FCC\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA697\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA78E\uA790-\uA793\uA7A0-\uA7AA\uA7F8-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA80-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uABC0-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]/,"*":/./}},i=t.getAttribute("data-required");let s=t.getAttribute("data-mask");s=s&&!/[ #()*@{}]/.test(s)?function(t){const e=String(t).toLowerCase(),i=flexbe_cli.locale.country;let s=u[e]&&u[e][i];return s&&"string"==typeof s&&(s=[s]),Object.assign([],s)}(s):[s];try{if(s=s.filter((t=>/[ #()*@_{}]/.test(t))),s=s.map((t=>t.replace(/0/g,"\\0"))),0===s.length)throw{message:"Mask is empty"};s=1===s.length?String(s[0]):s.map((t=>({...e,mask:t})));const n=new window.IMask(t,{...e,mask:s,dispatch:(t,e)=>{const i=e.compiledMasks;if(1===i.length)return i[0];const s=(e.value+t).replace(/\W/g,"");return i.find((t=>{const e=t.mask.replace(/\W/g,"")[0];return s[0]===e}))||i[0]}}),a=()=>{n.masked.isComplete||!i&&!n.value?t.setAttribute("data-mask-complete",!0):t.removeAttribute("data-mask-complete"),t.setAttribute("value",n.value)};t.value&&a(),n.on("accept",a),$(t).on("focus",(e=>{requestAnimationFrame((()=>{$(t).trigger("click")}))})),t._mask=n}catch(e){e instanceof Error&&console.error("MASK ERROR:",{masks:s,errorMessage:e.message}),t.removeAttribute("data-mask")}}const h="next",c="result";class d extends i{constructor(...t){super(...t),this.id=this.core.id,this.eventId=`.quiz${this.id}`,this.createQuiz()}onInit(){this.$masked=this.$form.find("[data-mask]"),this.require=[],this.$masked.length&&(this.needInitMasks=!0,this.require.push("/_s/lib/imask/imask.min.js?v1")),this.$calendars=this.$form.find(".form-field-date__input"),this.$calendars.length&&(this.needInitCalendar=!0,this.require.push("/_s/lib/scroll-lock/scroll-lock.min.js"),this.require.push("/_s/lib/calendar/dist/js/calendar.js?v2.3.2","/_s/lib/calendar/dist/css/calendar.min.css?v2.3.2"))}onLoad(){(this.core.wasScreen||this.core.wasBeside)&&(this.needInitMasks&&this.initFieldMask(),this.needInitCalendar&&this.initFieldDate()),this.isLoaded=!0}onScreen({state:t}){if(!t)return!1;this.initQuiz()}onBeside({state:t}){if(!t)return!1;this.initQuiz()}onOpen(t={}){this.initQuiz(),this.started||this.startQuiz(),t&&t.data&&this.setData(t.data)}onResize(){this.$component.find(".range-outer").trigger("resize")}createQuiz(){this.timeouts=[],this.history=[],this.swiper=[],this.$area=this.core.$area,this.$root=this.core.$root,this.$form=this.$component.find("form"),this.$steps=this.$component.find(".quiz-steps"),this.$actions=this.$component.find(".quiz-actions"),this.$progress=this.$component.find(".quiz-progress"),this.$scroller=this.$root.find(".scroller"),this.$stepsWrapper=this.$steps.find(".steps-wrapper"),this.$outerWrapper=this.$area.find('[data-quiz-part="wrapper"]'),this.$welcomeScreen=this.$outerWrapper.find('[data-quiz-part="welcome"]'),this.$progress.length||(this.$progress=this.$area.find('[data-quiz-part="progress"]')),this.rootModal="modal"===this.core.is&&this.core,this.hasWelcome=!!this.rootModal||this.$welcomeScreen.length>0,this.autoNextEnabled=+this.$steps.attr("data-autonext")||0,this.currentId=null,this.currentIndex=-1,this.total=parseInt(this.$component.attr("data-total-steps"),10)}initQuiz(){if(this.inited)return;this.inited=!0,this.$form.attr("action","/mod/lead/send/"),this.resetForm(),this.bindEvents(),this.initFields(),this.initControls(),this.initCaptcha();const t=flexbe_cli.is_admin&&this.$area.data("initialQuizStepId"),e=flexbe_cli.is_admin&&this.$area.data("initialQuizStepIndex");t?this.toStep({id:t,index:e,animated:!1}):this.hasWelcome||this.startQuiz({animated:!1})}bindEvents(){flexbe_cli.events.off(this.eventId),this.$form.off(this.eventId),this.$scroller.off(this.eventId),flexbe_cli.events.on(`quiz_command${this.eventId}`,((t,e)=>{this.id===e.id&&("welcome"===e.command?this.toWelcome():"start"===e.command?this.startQuiz():"step"===e.command&&this.toStep({id:e.stepId,index:e.stepIndex,force:e.force,animated:e.animated,scrl:e.scroll}))})),this.$form.on(`change${this.eventId}`,".policy-data-warning__input",(t=>{this.$form.find(".policy-data-warning__input").prop("checked",t.target.checked)})),this.$form.on(`input${this.eventId} change${this.eventId}`,"input, textarea",(t=>{const e=t.currentTarget,i=e.value,s=$(e);s.attr("value",i),s.closest(".is_error").removeClass("is_error")})),this.$form.on(`keydown${this.eventId}`,"input, textarea",(t=>{const e=t.currentTarget,i=e.getAttribute("data-check"),s=t.key||"",n=t.ctrlKey||t.metaKey;return!("phone"===i&&!e._mask&&!n&&1===s.length&&/[^\d ()+-]/.test(s))&&(("email"!==i||!/[\s,]/.test(s))&&void 0)})),this.needInitCalendar&&"modal"===this.core.is&&setTimeout((()=>{this.$calendars.toArray().forEach((t=>{const e=$(t).data("calendar");this.$scroller.on(`scroll${this.eventId}`,(()=>{e.main.toPosition()}))}))}),150),this.$form.on(`submit${this.eventId}`,(()=>this.onSubmit()))}initControls(){$("body").off(`keydown${this.eventId}`).on(`keydown${this.eventId}`,(t=>{const e=9===t.keyCode,i=13===t.keyCode;if(!i&&!e)return;const s=this.inFocus,n=t.metaKey||t.ctrlKey,a=t.shiftKey;if(s&&("TEXTAREA"!==t.target.tagName||!i||n)){if(a&&e)this.toPrevStep();else if(!a&&!n){const t=this.$currentStep.find(":focus").closest(".field").next(".field");this.focusField(t)||this.toNextStep()}return t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation(),!1}})),this.$component.off("click.control").on("click.control","[data-quiz-action]",(t=>{const e=t.currentTarget.getAttribute("data-quiz-action");"welcome"===e?this.toWelcome():"prev"===e?this.toPrevStep():"next"===e&&this.toNextStep()}))}setProgress(){const t=this.$progress.find(".progress-loader-bar .current"),e=this.total,i=t.data("unit");let s=this.realIndex+1;if(flexbe_cli.is_admin&&-1===this.realIndex&&"welcome"!==this.currentId){s=(+this.$currentStep.prevAll('[data-linked="linked"]').first().attr("data-real-index")+1||0)+1}let n=parseInt(100*s/e,10)||0;if(s=Math.max(0,Math.min(e,s)),n=Math.max(0,Math.min(100,n)),t.length&&i){let a=`${n}%`;"step"===i?a=`${s} / ${e}`:"none"===i&&(a=""),t.attr("data-value",a)}this.$progress.attr("data-current-progress",n),this.$progress.attr("data-current",s),this.$progress.attr("data-total",e),this.$progress.find(".progress-text .current").text(s),this.$progress.find(".progress-text .total").text(e),this.$progress.find(".progress-percent .current").text(n),this.$progress.find(".progress-loader-bar .current").css("width",`${n}%`),this.$progress.find(".progress-loader-circle .current").attr("stroke-dashoffset",`${Math.abs(100-n)}`)}setActionButtons(){let t=this.hasWelcome||this.history.length>1||!!(flexbe_cli.is_admin&&0!==this.realIndex&&this.currentIndex>0);!flexbe_cli.is_admin||!this.rootModal||this.realIndex&&this.currentIndex||(t=!1),this.$actions.toggleClass("show-prev",t)}toWelcome({scrl:t=!0}={}){if(!this.hasWelcome)return this.startQuiz({scrl:t}),!0;if(this.started=!1,this.currentIndex=-1,this.realIndex=-1,this.currentId="welcome",this.$area.data("initialQuizStepId",this.currentId),this.$area.data("initialQuizStepIndex",this.currentIndex),this.$outerWrapper.attr("data-active-step",this.currentId),this.$outerWrapper.attr("data-active-index",this.currentIndex),this.$outerWrapper.toggleClass("quiz-state-welcome",!0),this.$outerWrapper.toggleClass("quiz-state-started",!1),this.rootModal)flexbe_cli.is_admin||flexbe_cli.events.emit("ui_modal_close",{id:this.rootModal.id});else if(this.$outerWrapper.length){const t=this.$welcomeScreen.outerHeight()||0;this.$outerWrapper.css("minHeight",t)}return this.setProgress(),this.setActionButtons(),t&&"block"===this.core.is&&!flexbe_cli.is_admin&&flexbe_cli.scroll.toElement(this.$area),flexbe_cli.events.emit("quiz_event",{event:"welcome",sender:"core",quiz:this}),!0}startQuiz({animated:t,scrl:e}={}){this.sessionId=parseInt(Date.now()/1e3,10);const i=this.$stepsWrapper.find('.step[data-type="root"][data-linked="linked"]').first();i.length&&this.toStep({$step:i,force:!0,animated:t,scrl:e})}autoNextStep(){!this.autoNextEnabled||this.$currentStep.find(".quiz-fields").data("count")>1||setTimeout((()=>{this.toNextStep()}),150)}toPrevStep(){const t=this.history[this.history.length-2];if(!t){const t=this.$currentStep.prevAll('.step[data-type="root"][data-linked="linked"]').first();return t.length?this.toStep({$step:t}):this.hasWelcome&&this.toWelcome(),!1}return this.toStep(t),!0}toNextStep({force:t}={}){if(!(t||this.validateStep()))return!1;const e=this.$currentStep.attr("data-goto"),i=this.$currentStep.attr("data-goal"),s=this.$currentStep.attr("data-html-goal"),n=this.history.find((t=>t.id===this.currentId))||{},a=this.$currentStep.find("[data-field-id]").map(((t,e)=>{const i=$(e),s=i.attr("data-field-id"),n=i.find("input, textarea").not('[type="hidden"]'),a=i.find("[data-goto]"),r=i.attr("data-type"),o=i.find(`[name="vars[${s}]"]`).val();let u=n.attr("type"),l=a,h=n.val();["checkbox","radio","image"].includes(r)?l=a.filter(":checked"):"select"===r?(l=l.filter(((t,e)=>e.selected)),u="select"):"file"===r&&(h=Array.from(n[0].files));const c=l.toArray(),d=c.map((t=>t.getAttribute("data-goto"))).filter((t=>t));return{id:s,title:o,type:r,inputType:u,value:h,variants:c.map((t=>({id:t.getAttribute("data-id"),value:t.value}))).filter((t=>t.id)),goto:d}})).toArray(),r=a.map((t=>{const e={id:t.id,title:t.title,type:t.type};return["radio","checkbox","select","image"].includes(t.inputType)?e.variants=t.variants:e.value=t.value,e})),o=a.reduce(((t,e)=>t.concat(e.goto)),[]),u=this.getNextStep({gotoId:o[0]||e||h});n&&(n.fields=a,n.answers=r,n.toId=u,n.goal=i,n.htmlGoal=s),this.toStep({id:u,historyItem:n})}getNextStep({gotoId:t,$current:e=this.$currentStep}={}){if(t===c){const t=this.history.map((t=>t.$step[0])),e=this.$stepsWrapper.find('[data-type="root"][data-linked="linked"][data-required]').filter(((e,i)=>!t.includes(i)));return e.length?e.eq(0).attr("data-id"):c}let i=t;if(t===h||!this.$stepsWrapper.find(`.step[data-id="${i}"]`).length){i=e.nextAll('.step[data-type="root"][data-linked="linked"]').first().attr("data-id")}if(t===h&&!i)return this.getNextStep({gotoId:c,$current:e});if(!this.checkStepCondition({id:i})){const t=e.nextAll('.step[data-type="root"][data-linked="linked"]').first();return this.getNextStep({gotoId:h,$current:t})}return i}toStep({id:t,index:e,$step:i,force:s,scrl:n=!0,animated:a=!0,historyItem:r}){var o,u;if(this.inStepAnimation)return!1;if(null==r&&(r=this.history.find((t=>t.id===this.currentId))),t===c)return void this.toResult({historyItem:r});if(i&&i.length||null==t||(i=this.$stepsWrapper.find(`.step[data-id="${t}"]`)),i&&i.length||null==e||(i=this.$stepsWrapper.find(`.step[data-index="${e}"]`)),!i||!i.length)return!1;if(t=null!=(o=t)?o:i.attr("data-id"),e=parseInt(null!=(u=e)?u:i.attr("data-index"),10),t===this.currentId)return this.enableStep(i),!1;const l=flexbe_cli.is_admin?parseInt(i.attr("data-real-index"),10):e,h=e>this.currentIndex;a||this.$area.addClass("noanimate"),i.find(".is_error").removeClass("is_error");const d=i.outerHeight(),p={$step:i,id:t,title:i.find(".step-title").text().trim(),index:e,realIndex:l,fields:[],answers:[]};let f=[];s?(f=this.history,this.history=[]):(f=this.history.filter((t=>t.index>=p.index)),this.history=this.history.filter((t=>!f.includes(t)))),f.forEach((t=>{this.disableStep(t.$step)})),this.enableStep(i),this.started=!0,this.history.push(p),this.$component.addClass("quiz-started"),a&&this.$component.addClass("step-change-animation");const m=window.scrollParent(this.$component[0])||document.scrollingElement,g=m&&m.scrollTop||0,$=this.$stepsWrapper.outerHeight();if(this.$area.data("initialQuizStepId",t),this.$area.data("initialQuizStepIndex",e),this.$outerWrapper.attr("data-active-step",t),this.$outerWrapper.attr("data-active-index",e),this.$outerWrapper.toggleClass("quiz-state-welcome",!1),this.$outerWrapper.toggleClass("quiz-state-started",!0),i.toggleClass("higher",d>$),a&&this.$stepsWrapper.css("height",`${$}px`),this.$outerWrapper.css("minHeight",`${$}px`),i.prevAll().removeClass("active next").addClass("prev"),i.nextAll().removeClass("active prev").addClass("next"),i.removeClass("next prev").addClass("active"),this.currentId=t,this.currentIndex=e,this.realIndex=l,this.$currentStep=i,this.core.updateTween(),this.setProgress(),this.setActionButtons(),this.initImages(),2===flexbe_cli.theme_id){const t=this.$area.find(".b_head");t.length&&flexbe_cli.header.fixHeaderHeight(this.$area,t)}return this.timeouts=this.timeouts.filter((t=>clearTimeout(t))),this.timeouts.push(setTimeout((()=>{a||this.$area.removeClass("noanimate")}),20)),a?(this.inStepAnimation=!0,this.timeouts.push(setTimeout((()=>{this.$stepsWrapper.css("height",""),this.$component.removeClass("step-change-animation"),this.$component.find(".range-outer").trigger("resize"),this.inStepAnimation=!1}),250)),n&&(this.timeouts.push(setTimeout((()=>{const t=this.$area.get(0).getBoundingClientRect();this.$stepsWrapper.css("height",`${d}px`);const e=m.scrollTop,i=this.$area.get(0).getBoundingClientRect().bottom-t.bottom-(g-e);i&&m.scrollTo(0,e+i)}),150)),flexbe_cli.is_admin||this.timeouts.push(setTimeout((()=>{let t=this.$component;this.$area.outerHeight()<=flexbe_cli.resize.viewportHeight&&(t=this.$area),flexbe_cli.scroll.toElement(t,{centered:!0,force:!1,complete:()=>{flexbe_cli.run.is_mobile||this.focusField(i)}})}),450)))):this.$component.find(".range-outer").trigger("resize"),r=r||{},this.lastHistoryItem=r,flexbe_cli.events.emit("quiz_event",{event:"step",sender:"core",quiz:this,payload:{fromId:r.id,fromTitle:r.title,fromAnswers:r.answers,toNext:h,toId:t,sessionId:this.sessionId},answerGoals:{goal:r.goal,htmlGoal:r.htmlGoal}}),!0}toResult({force:t,historyItem:e}={}){const i=t||this.validateStep();return!!(t||!this.busy&&i)&&(null==e&&(e=this.history[this.history.length-1]),this.result=this.getResult(),this.lastHistoryItem=e,this.$form.submit(),!0)}validateStep(){let t=!0;if(!this.$currentStep||!this.$currentStep.length)return!0;const e=this.$currentStep.find(".policy-data-warning--checkbox"),i=e.find("input")[0];return i&&!i.checked&&(t=!1,e.addClass("is_error animate")),this.$currentStep.find(".field[data-type]").each(((e,i)=>{const s=$(i),n=s.attr("data-type");let a;if(s.removeClass("is_error"),"captcha"===n){if(!this.captcha)return;a=!this.captcha.getToken()&&flexbe_cli.locale.tr("form::captcha_not_checked")}else a=this.checkField(s);a&&(s.outerWidth(),s.addClass("is_error animate"),setTimeout((()=>{s.removeClass("animate")}),500),s.find(".error").text(a),t&&this.focusField(s,500),t=!1)})),t}getResult(){const t=this.$form.find("input[name=results]").data("value")||[];let e=t.filter((t=>null!=t.id&&"default"!==t.id)).find((t=>this.checkResultCondition(t)));return e||(e=t.find((t=>null==t.id||"default"===t.id))||t[0]),"object"!=typeof e.action&&(e.action={pay:e.pay,name:e.action,modal_id:e.modal_id,action_redirect:e.action_redirect}),e}checkStepCondition(){return!0}checkResultCondition(t){const e=t.conditions||{},i=e.union,s=e.list||[],n=this.history.reduce(((t,e)=>t.concat(e.fields)),[]);let a=s.map((t=>{const e=n.find((e=>String(e.id)===String(t.field)));return{condition:t,field:e}}));return!!a.length&&(a=a["and"===i?"every":"some"]((({condition:t,field:e})=>{let i=!0;if(!e)return!1;if("vars"===t.type){const s=e.variants||[],n=(t.variants||[]).map((t=>`${t}`));if(!s.length)return!!t.emptyVariant;if(t.unionExtra||(i=s.every((t=>n.includes(`${t.id}`)))),i){let a=t.union;"radio"!==e.inputType&&"select"!==e.inputType||(a="or"),i=n["and"===a?"every":"some"]((t=>s.find((e=>e.id===t))))}}else if("range"===t.type){const s=`${e.value}`.replace(/\s+/g,"").split(/\s[—-]\s/).map((t=>+t)).filter((t=>"number"==typeof t&&!Number.isNaN(t))),n=Math.min.apply(null,s),a=Math.max.apply(null,s),o=n!==a;let u=+t.rangeLimitFrom,l=+t.rangeLimitTo;if("equal"===t.operator)return o?n<=u&&u<=a:u===n;r(u)&&r(l)&&(u=Math.min(t.rangeLimitFrom,t.rangeLimitTo),l=Math.max(t.rangeLimitTo,t.rangeLimitFrom)),i&&r(u)&&(i=u<=n),i&&r(l)&&(i=a<=l)}else if("text"===t.type){const i=t.fill,s=(e.value||"").trim().replace(/ +/g," ").replace(/\+/g,"∔"),n=t.answers.map((t=>`${t}`.toLowerCase().replace(/\+/g,"∔"))).filter((t=>t));if("fill"===i)return!!s;if("empty"===i)return!s;if("include"===i)return n.some((t=>new RegExp(`^${t}|\\s${t}`,"i").test(s)));if("exclude"===i)return n.every((t=>!new RegExp(`^${t}|\\s${t}`,"i").test(s)))}else if("file"===t.type){const i=t.fill,s=e.value;if("fill"===i)return!!s.length;if("empty"===i)return!s.length}return i})),a);function r(t){return!Number.isNaN(+t)&&null!=t&&""!==t}}checkField(t){const e=t.find("input, textarea, select").not('[type="hidden"]'),i=e[0],s=t[0];if(!i)return;const n=s.getAttribute("data-type"),a=[!0,1,"true","1"].includes(s.getAttribute("data-is-required")),r=i.getAttribute("data-check")||!1,o=i._mask&&i.getAttribute("data-mask")||!1;let u;u=["checkbox","radio","image"].includes(n)?!!e.closest(":checked").length:"file"===n?i.files:i.value;let l=!(!a||u)&&"form.required";if(o){!a&&!u||i.getAttribute("data-mask-complete")||(l="phone"===n&&u?"form.phone":"text"===n&&u?"form.text":"form.required")}else if(r)if(u.length&&"email"===n){/^(([^\s"(),.:;<>@[\\\]]+(\.[^\s"(),.:;<>@[\\\]]+)*)|(".+"))@((\[(?:\d{1,3}\.){3}\d{1,3}])|(([\wЁА-яё-]+\.)+[A-Za-zЁА-яё]{2,}))$/.test(u)||(l="form.email")}else if(u.length&&"phone"===n)if(/[^\d\s()+-]/.test(u))l="form.digits";else{u.replace(/\D/g,"").length<5&&(l="form.minlength")}else if("file"===n)l=!(!a||u.length)&&"form.required";else if("date"===n||"datetime"===n){const t=$(i).data("calendar"),e=t&&t.input.checkError();e&&(l=e)}return l=l&&flexbe_cli.locale.tr(l)||!1,l}disableStep(t){t.find("input, textarea, select").prop("disabled",!0)}enableStep(t){t.find("input, textarea, select").prop("disabled",!1)}focusField(t,e=200){if(!t||!t.length)return!1;if(flexbe_cli.run.is_ios)return!1;const i=t.find(".form-field-text__input, .dropdown-select").not(".form-field-date__input").first();return!!i.length&&(e?setTimeout((()=>i.focus()),e):i.focus(),!0)}initImages(){setTimeout((()=>{const t=$(this.component).find(".step.active");$(t).find(".component-image").length&&function(t,e,i,s={}){const n=$(t),a=e?`[data-component="${e}"]`:"[data-component]";n.is(a)?n.trigger(i,s):$(t).find(a).each(((t,e)=>{$(e).trigger(i,s)}))}(t,"image","setImage")}),100)}initFields(){this.initFieldImage(),this.initFieldCheckbox(),this.initFieldRadio(),this.initFieldSelect(),this.initFieldTextarea(),this.initFieldFile(),this.initFieldRange(),this.isLoaded&&(this.needInitMasks&&this.initFieldMask(),this.needInitCalendar&&this.initFieldDate())}initFieldImage(){this.$component.off("click.fieldImages").on("click.fieldImages",".form-field-image-item",(t=>{const e=t.currentTarget.querySelector("input"),i=!e.checked;e.checked=i,i&&"radio"===e.type&&this.autoNextStep()}))}initFieldFile(){this.$component.off("change.uploadFile").on("change.uploadFile",".file-input",(t=>{const e=$(t.currentTarget),i=e.parents(".form-field-file"),s=i.find(".form-field-file--files"),n=e.val(),a=t.currentTarget.files.length;if(i.addClass("active"),e.parents(".field").removeClass("is_error"),0===a)i.removeClass("active");else if(1===a)s.find(".text").text(n);else if(a>1){const t=a%100,e=a%10;let i;i=1===e&&11!==t?"form.filesMult":e>1&&e<5?"form.filesMult1":"form.filesMult2",s.find(".text").text(`${a} ${flexbe_cli.locale.tr(i)}`)}})),this.$component.off("click.clearFiles").on("click.clearFiles",".clear-files",(t=>{const e=$(t.currentTarget).parents(".form-field-file");e.find(".file-input").val(""),e.removeClass("active")}))}initFieldCheckbox(){}initFieldRadio(){this.autoNextEnabled&&this.$component.off("change.initRadio").on("change.initRadio",".form-field-radio-item",(()=>{this.autoNextStep()}))}initFieldSelect(){this.$component.find(".dropdown-container").remove();const t=this.$component.find("select.atom-custom-select"),e={position:"under",dropdownClass:this.$component.hasClass("style-underlined")?"sharp size--large":"size--large"};t.each(((t,i)=>{const s=$(i).closest('[data-type="select"]');r.create({element:i,config:e,onChange:this.autoNextStep.bind(this),onSelect:this.autoNextStep.bind(this),onCollapse:()=>{s.removeClass("active")},onActivate:()=>{s.addClass("active"),s.siblings('[data-type="select"]').removeClass("active")}})}))}initFieldTextarea(){this.$component.find("textarea.autosize").each(((t,e)=>{const i=e.offsetHeight-e.clientHeight,s=$(e);s.removeAttr("data-autoresize"),s.off("keyup input").on("keyup input",(function(t){t.currentTarget.style.height="auto",t.currentTarget.style.height=`${t.currentTarget.scrollHeight+i}px`}))}))}initFieldRange(){this.$component.find(".form-field-range").each(((t,e)=>new o($(e))))}addSubmitting(){this.busy=+Date.now(),this.$component.addClass("submitting"),this.$form.addClass("submitting")}clearSubmitting(t=!1){this.busy&&(this.$component.removeClass("submitting"),this.$form.removeClass("submitting"),t?(this.$component.addClass("success"),setTimeout((()=>{this.busy=!1,this.$component.removeClass("success")}),1e3)):this.busy=!1)}onSubmit(){const t={p_id:flexbe_cli.p_id,id:this.core.id,name:this.result.name,action:this.result.action.name,jsform:parseInt(448312,10)};if(flexbe_cli.stat.u_id&&(t.f_uid=flexbe_cli.stat.u_id),"pay"===this.result.action.name&&this.result.action.pay){const e=this.result.action.pay;e.desc&&(t["pay[desc]"]=e.desc),e.price&&(t["pay[price]"]=e.price,e.title&&(t["product[items]"]=JSON.stringify([{title:e.title,id:`${flexbe_cli.p_id}_${flexbe_cli.s_id}`,img:e.img,count:1,price:e.price}]),t["product[price]"]=e.price,t["product[total]"]=1))}return Object.entries(t).forEach((([t,e])=>{null!=e&&this.addFields([{name:t,value:e,type:"hidden"}],!1)})),this.sendForm(),!1}async sendForm(){const t=this.captcha&&this.captcha.getToken();if(this.captcha&&this.captcha.enabled&&!this.captcha.isOptional&&!t)return void(this.captcha.isVisible?this.toStep({id:"captcha"}):this.captchaInvisibleRun());this.addSubmitting();const e=new FormData(this.$form.get(0));if(e.append("is_ajax","true"),"undefined"!=typeof flexbeAPI&&void 0!==flexbeAPI.customLeadData&&e.append("customLeadData",JSON.stringify(flexbeAPI.customLeadData)),e.append("f_ab",JSON.stringify(flexbe_cli.stat.AB.getCookie())),"function"==typeof e.delete&&e.delete("g-recaptcha-response"),t&&e.append("captcha-token",t),flexbe_cli.run.is_OSX&&"function"==typeof e.entries)for(const t of e.entries()){const[i,s]=t;"object"==typeof s&&s instanceof File&&0===s.size&&"function"==typeof e.delete&&e.delete(i)}try{const t=await flexbe_cli.helpers.fetch(this.$form.attr("action"),{processData:!1,contentType:!1,data:e});void 0!==t.pay&&(this.pay=t.pay),this.clearSubmitting(!0),this.captchaRemoveError(),this.showDone()}catch(e){const i=e.data;if(i.captcha)return this.captcha||await this.initCaptcha({...s.getRecaptchaSettings(),enabled:!0,visible:"visible"===i.captcha,ttl:1}),void(t?this.captchaAddError():this.captcha.isVisible?(this.captcha.isOptional=!1,this.total=parseInt(this.$component.attr("data-total-steps"),10)+1,this.clearSubmitting(!1),this.toStep({id:"captcha"})):this.captcha.isInvisible&&this.captchaInvisibleRun());this.clearSubmitting(!1),console.error("sendForm error: ",e),alert("Form submitting error!")}}showDone(){const t=()=>{setTimeout((()=>{this.resetForm(),this.toWelcome({scrl:!1})}),500)},e=this.result.action.name,i=this.lastHistoryItem;if(i){const t=i.answers,e=i.id,s=i.title,n=this.result.goals||{};flexbe_cli.events.emit("quiz_event",{event:"submit",sender:"core",quiz:this,payload:{fromAnswers:t,fromId:e,fromTitle:s,sessionId:this.sessionId},answerGoals:{goal:i.goal,htmlGoal:i.htmlGoal},resultGoals:{mainGoal:flexbe_cli.stat.goals.order_done,goal:n.goal,htmlGoal:n.goal_html}})}if("function"==typeof this.afterSent&&this.afterSent(),"pay"===e&&void 0!==this.pay&&null!==this.pay&&this.pay.pay_link.length>0){const e=`${window.location.origin+window.location.pathname+(window.location.search?`${window.location.search}&`:"?")}pay_id=${this.pay.pay_id}&h=${this.pay.pay_hash}`;try{window.history.pushState(null,null,e),setTimeout((()=>{flexbe_cli.events.emit("pay",{action:"init"})}),200)}catch(t){setTimeout((()=>{document.location=e}),500)}t()}else if(["redirect","anchor"].includes(e)){const e=this.result.action.action_redirect,i=this.result.action.action_link;if(e)setTimeout((()=>{flexbe_cli.helpers.links.gotoLink(e),t()}),1e3);else if(i){const e=$(`a[name="${i.replace("#","")}"]`);e.length>0&&flexbe_cli.scroll.toElement(e.parent()),t()}else t()}else{const e=this.result.action.modal_id;flexbe_cli.events.emit("ui_modal_open",{id:e}),t()}}resetForm(){this.$form.find(".form-field-file, .file-input-outer").removeClass("active");const t=this.$stepsWrapper.find("input, textarea, select"),e=t.not("select").not('[type="hidden"]').not(".form-field-range__input"),i=t.filter("select"),s=t.filter(".form-field-range__input");t.prop("disabled",!0),i.each(((t,e)=>{const i=e.querySelector("option"),s=i&&i.value||"";e.value!==s&&(e.value=s,e.dispatchEvent(new Event("change")))})),s.each(((t,e)=>{e.value=e.getAttribute("data-value"),e.dispatchEvent(new Event("change"))})),e.each(((t,e)=>{const i=e.defaultChecked;["radio","checkbox"].includes(e.type)?e.checked=i:(e.removeAttribute("value"),e.value="",e.removeAttribute("data-mask-complete"),e._mask&&e._mask.updateValue()),e.dispatchEvent(new Event("change"))})),this.captcha&&this.captcha.enabled&&(this.captcha.reset(),this.captchaRemoveError()),this.$form[0].reset()}async initCaptcha(t){return null==t&&(t=s.getRecaptchaSettings()),new Promise(((e,i)=>{!this.captcha&&t.enabled&&(this.captcha=new s({id:this.id,$form:this.$component,onSuccess:()=>{this.captchaRemoveError(),this.toResult({force:!0})},onError:()=>{this.captchaAddError()}},t),flexbe_cli.require(`https://www.google.com/recaptcha/api.js?render=explicit&hl=${flexbe_cli.vars._group.language}`,(()=>{let t=150;const s=setInterval((()=>{t-=1,this.captcha.loaded?(this.captcha.init(),clearInterval(s),e()):0===t&&i(new Error("Can not load grecaptcha"))}),10)})))}))}captchaAddError(t){if(!this.captcha||!this.captcha.enabled)return;null==t&&(t=flexbe_cli.locale.tr("form::captcha_error"));const e=this.$component.find(".captcha-global-error");e.find(".error-text").text(t),e.addClass("show"),this.busy&&this.clearSubmitting()}captchaRemoveError(){if(!this.captcha||!this.captcha.enabled)return;const t=this.$component.find('.field[data-type="captcha"]'),e=this.$component.find(".captcha-global-error");t.removeClass("is_error"),e.removeClass("show")}captchaInvisibleRun(){if(!this.captcha||!this.captcha.enabled||!this.captcha.loaded||this.captcha.isVisible)return;this.addSubmitting(),this.captcha.runInvisibleChallenge();const t=this.busy;setTimeout((()=>{t===this.busy&&this.clearSubmitting()}),2500)}setData(t){if(!t)return!1;t&&t.fields&&this.addFields(t.fields),t&&t.items&&this.addItems(t.items)}addFields(t,e=!0){const i=this.$component.find(".form-fields-advanced");t.length&&i[0]&&(e&&i.empty(),t.forEach((t=>{i.find(`input[name="${t.name}"]`).remove();const e=$("<input>").attr("type",t.type).attr("name",t.name).attr("value",t.value);i.append(e)})))}addItems(t=[]){if(!t||!t.length)return;let e=0,i=0,s="";const n=[];t=t.map((t=>"object"!=typeof t?{}:(t.count=parseInt(t.count,10)||1,t.price=parseFloat(t.price)||0,t.title="string"==typeof t.title&&t.title.trim()||t.title||"",e+=t.price*t.count||0,i+=t.count,t)));try{s=JSON.stringify(t)}catch(t){}let a={"product[items]":s,"product[price]":e,"product[total]":i};e&&(a={...a,"pay[price]":e,"pay[desc]":""}),Object.entries(a).forEach((([t,e])=>{n.push({type:"hidden",name:t,value:e})})),this.addFields(n)}initFieldMask(){return"undefined"!=typeof IMask&&(this.needInitMasks=!1,this.$masked.each(((t,e)=>{l(e);const i=!!e.getAttribute("data-placeholder"),s=e._mask;i&&s&&($(e).on(`focus${this.eventId}`,(()=>{s.updateOptions({lazy:!1})})),$(e).on(`blur${this.eventId}`,(()=>{if(!s.unmaskedValue){const t=s.mask.replace(/\*/g,"_"),e=s.value;s.updateOptions({lazy:!0}),s.masked.rawInputValue&&t!==e||(s.unmaskedValue="",s.value="",s.updateValue())}})))})),!0)}initFieldDate(){this.needInitCalendar=!1;const t=this.$component.closest(".scroller")[0];return this.$calendars.each(((e,i)=>{!function(t,e){const i=$(t),s=i.closest("[data-type]").attr("data-type"),n=i.attr("data-date-range")||"any",a=i.attr("data-date-work-days")||"0,1,2,3,4,5,6";let r=(new Date).getFullYear()+3;"datetime"===s&&(r=(new Date).getMonth()>=8?(new Date).getFullYear()+1:(new Date).getFullYear());let o=new Date((new Date).getFullYear()-100,0,1),u=new Date(r,11,31);"datetime"!==s&&"future"!==n||(o=new Date),"date"===s&&"past"===n&&(u=new Date);const l={type:s,lowerLimit:o,upperLimit:u,dateRange:n,locale:flexbe_cli.locale.translation.calendar,dateFormat:flexbe_cli.locale.date_format,showDateSelector:"date"===s&&"future"!==n,insertTo:e,workDays:a.split(","),workTime:null};if("datetime"===s){const t=i.attr("data-date-time-interval")||30,e=i.attr("data-date-time-start")||"00:00",s=i.attr("data-date-time-finish")||"00:00";l.workTime={interval:t,start:{hour:+e.substring(0,2),minute:+e.substring(3,5)},finish:{hour:+s.substring(0,2),minute:+s.substring(3,5)}}}i.calendar(l)}(i,t)})),!0}}d.is="quiz";flexbe_cli.entity.setClientJs("modal","QUIZ",{components:["background","image",class extends d{setProgress(){const t=this.$progress.find(".progress-loader-bar .current"),e="step"===this.$progress.attr("data-text-style"),i=t.attr("data-unit"),s=this.total;let n=this.realIndex;if(flexbe_cli.is_admin&&-1===this.realIndex&&"welcome"!==this.currentId){n=+this.$currentStep.prevAll('[data-linked="linked"]').first().attr("data-real-index")+1||0}n=Math.max(0,Math.min(s-1,n));const a=e?n+1:n,r=parseInt(100*a/s,10);if(this.$progress.attr("data-current",a),this.$progress.attr("data-total",s),this.$progress.attr("data-current-progress",r>0?r:0),t&&i){const e=t.find(".progress-runner");let n=`${r}%`;"step"===i?n=`${a} / ${s}`:"none"===i&&(n=""),e.attr("data-value",n)}this.$progress.find(".progress-text .current").text(a),this.$progress.find(".progress-text .total").text(s),this.$progress.find(".progress-percent .current").text(r),this.$progress.find(".progress-loader-bar .current").css("width",`${r}%`),this.$progress.find(".progress-loader-circle .current").attr("stroke-dashoffset",`${Math.abs(100-r)}`)}initFieldFile(){this.$form.on(`change.file${this.eventId}`,".file-input--original",(t=>{const e=$(t.currentTarget),i=e.parents(".file-input-outer"),s=e.val(),n=t.currentTarget.files.length;if(i.addClass("active"),e.closest("[data-type]").removeClass("is_error"),1===n)i.find(".file-item--title").text(s);else if(n>1){const t=n%100,e=n%10;let s;s=1===e&&11!==t?"form.filesMult":e>1&&e<5?"form.filesMult1":"form.filesMult2",i.find(".file-item--title").text(`${n} ${flexbe_cli.locale.tr(s)}`)}else i.removeClass("active")})),this.$form.on(`click${this.eventId}`,".clear-files",(t=>{const e=$(t.currentTarget).parents(".file-input-outer");e.find(".file-input--original").val(""),e.removeClass("active")}))}}]})}();

flexbe_cli.entity.setClientJs("widget","ANCHORS",{require:["/_s/lib/anime/anime.min.js?321"],$list:null,onLoad(){this.$list=this.$widget.find(".anchors-list"),this.list="object"==typeof this.$list.data("anchors")&&this.$list.data("anchors").list||[];const t={style:1,show_title:0,...this.$list.data("anchors")};this.style=t.style,this.show_title=t.show_title,this.$list.removeAttr("data-anchors"),flexbe_cli.run.is_mobile||(this.drawList(),this.bindEvents(),flexbe_cli.is_admin&&(flexbe_cli.events.off("layout_change.anchors").on("layout_change.anchors",((t,e)=>{"block"===e.is&&this.drawList()})),flexbe_cli.events.off("page-settings_update").on("page-settings_update",((t,e)=>{e.p_data.p_data.show_bullets?this.$list.show():this.$list.hide()}))))},check(){const t=flexbe_cli.block.$blocks.not("[data-overlayed]");this.list=this.list.filter((e=>{const i=t.closest(`[data-id="${e.id}"]`),s=i.attr("data-hidden")||"none";return e.enabled&&i[0]&&["none","mobile"].includes(s)}))},drawList(){flexbe_cli.block.$blocks.length&&flexbe_cli.vars._page.showBullets||this.$list.hide(),this.check();let t="";flexbe_cli.is_admin&&this.list.length<2?t='<svg style="color: #adadad" width="18" height="98" viewBox="0 0 18 98" xmlns="http://www.w3.org/2000/svg">\n                <g fill="none" fill-rule="evenodd">\n                    <circle opacity=".05" cx="9" cy="5" r="5"/>\n                    <circle opacity=".2" cx="9" cy="25" r="5"/>\n                    <circle opacity=".2" cx="9" cy="73" r="5"/>\n                    <circle opacity=".05" cx="9" cy="93" r="5"/>\n                    <path d="M9 40a9 9 0 1 0 0 18 9 9 0 0 0 0-18zm5.126 9.626h-4.5v4.5H8.34v-4.5h-4.5V48.34h4.5v-4.5h1.286v4.5h4.5v1.286z" opacity=".45"/>\n                </g>\n            </svg>':this.list.length>=2&&(this.list.forEach((e=>{const i=this.show_title&&e.title?` data-title="${e.title}"`:"";t+=`<li${i}><a href="#${e.id}"></a></li>`})),t+='<li class="helper"><a></a></li>'),this.$list.find("ul").html(t),this.$helper=this.$list.find(".helper"),this.animateList()},animateList(){if(!(this.list.length<1)){if(flexbe_cli.is_admin)this.$helper.css({opacity:1,transform:`translateY(${24*this.index}px)`});else{const t=anime({targets:this.$list.find("li").not(this.$helper).get(),duration:350,opacity:[0,1],scale:[.8,1],translateY:[10,0],easing:"easeInOutQuad",autoplay:!1,delay:(t,e)=>30*e,complete:()=>{anime({targets:this.$helper.get(),duration:400,translateY:24*this.index,scale:[2.5,1],opacity:[0,1],easing:"easeInExpo"})}});this.$list.addClass("hide"),setTimeout((()=>{this.$list.removeClass("hide"),t.play()}),800)}this.$list.find("li").removeClass("active").eq(this.index).addClass("active")}},index:0,bindEvents(){flexbe_cli.events.off("entity_event.anchors").on("entity_event.anchors",((t,{type:e,core:i,params:s})=>{"focus"===e&&s.state&&"block"===i.is&&this.setBlock(i)})),flexbe_cli.block.$blocks.each(((t,e)=>{const i=e._core;i&&i.inFocus&&this.setBlock(i)})),this.$list.on("click","li",(t=>{if(!$(t.target).is("a"))return $(t.currentTarget).find("[href]").trigger("click"),t.preventDefault(),!1}))},setBlock(t){let e=this.index,i="#6a6a6a";const s=t.content||t.$area.find(".container")[0];if(s){const e=t.content.getAttribute("data-contrast");i=e?"light"===e?"#FFF":"#1B1B1C":getComputedStyle(s).color}this.$list.css("color",i),this.list.some(((i,s)=>i.id===t.id&&(e=s,!0))),e=Math.max(0,Math.min(this.list.length-1,e)),e!==this.index&&(this.animate(e),this.index=e)},animate(t){if(this.$list.find("li").removeClass("active"),this.$list.find("li").eq(t).addClass("active"),1==+this.style){const e=24*t,i=t-this.index>0?12:-12;anime.remove(this.$helper[0]),anime({targets:this.$helper[0],translateY:e-i,scaleY:2.5,scaleX:.6,duration:100,easing:"easeInQuad",complete:()=>{anime({targets:this.$helper[0],translateY:e,scaleY:1,scaleX:1,duration:100,easing:"easeOutQuad"})}})}}});

!function(){const e="hidden-mobile",t="mobile-navigation--created",a="nav-header-controls--cart",n="nav-header-controls--burger",s=".b_block",i=".element-item",o=".mobile-navigation",r=".header-wrapper",l=".widget-list .cart-button",c=".header-cart-button",d=".nav-header",h=".nav-header-content",u=".nav-header-controls",b=".nav-menu",m=(t,a=!1)=>{let n=$(t);if(!n.is(i)){const e=n.closest(i);n=e.length?e:n}n.toggleClass(e,!a)};flexbe_cli.entity.setClientJs("widget","MENU01",{created:{},navbarStyle:null,onLoad(){requestAnimationFrame((()=>this.createWidget()));let e=flexbe_cli.resize.responsiveMode;$(window).on("resized",(()=>{const t=flexbe_cli.resize.responsiveMode;e!==t&&"mobile"===t&&this.createWidget(),e=t}))},onMsg(e){"postProcessSave"===e&&this.createWidget(e)},createWidget(){this.clickEvent="click",this.navbarStyle=!1,this.navmenuCreated=!1,this.created={},this.contrast="dark",this.background="#FFFFFF";const e=flexbe_cli.block.$list,t=$(s),a=e.find(r);if(m(a,!0),m(t,!0),this.mobileHeadersMap=t.not('[data-hidden="mobile"]').toArray().map((e=>{const t=$(e),a=t.find(r),n=a.hasClass("floating-header"),s=!!a.data("mobile-menu"),i=a.data("widget-color"),o=a.data("widget-contrast"),l=a.closest("[data-contrast]").attr("data-contrast");return{$block:t,$header:a,isFixed:n,hasMobileMenu:s,widgetColor:i,widgetContrast:o,contrast:l}})).filter((e=>e.hasMobileMenu)),this.mobileHeadersMap.length){var n;const e=null!=(n=this.mobileHeadersMap.find((e=>e.isFixed)))?n:this.mobileHeadersMap[0];"contrast"===e.widgetColor?(this.contrast=e.contrast,this.background="dark"===this.contrast?"#ffffff":"#1b1b1c"):(this.background=e.widgetColor,this.contrast=e.widgetContrast)}if(this.$headers=$(this.mobileHeadersMap.map((e=>e.$header[0]))),this.$nav=this.$area.find(o),this.$navbar=this.$area.find(d),this.$navmenu=this.$area.find(b),this.shouldBeFixed=!flexbe_cli.is_admin&&this.mobileHeadersMap.some((e=>e.isFixed)),this.fillNavMenu(),this.fillNavbar(),this.$navbar.css("background-color",""),this.$navmenu.css("background-color",""),a.closest(".b_block").each(((e,t)=>{t._core&&t._core.updateTween()})),this.navbarStyle){if(this.background&&(this.$navbar.css("background",this.background),this.$navmenu.css("background",this.background),i=this.background,!/^\s*(?:linear-gradient|repeat-linear-gradient)\(.*\)/i.test(i))){const e=$("head"),t=e.find('meta[name="theme-color"]');t.length?t.attr("content",this.background):e.append(`<meta name="theme-color" content="${this.background}"/>`)}this.contrast?this.$nav.attr("data-contrast",this.contrast):this.color&&this.$nav.css("color",this.color),this.shouldBeFixed=this.shouldBeFixed||"round"===this.navbarStyle,this.$nav.toggleClass("menu-fixed",this.shouldBeFixed),this.$nav.toggleClass("menu-static",!this.shouldBeFixed),this.animationMobileShow()}else $("body").removeClass("is-mobile-menu--round is-mobile-menu--panel");var i;this.navmenuCreated&&(flexbe_cli.entity.initArea(this.$nav),flexbe_cli.events.off("ui_mobilemenu_open").on("ui_mobilemenu_open",(()=>{this.openMenu()})),flexbe_cli.events.off("ui_mobilemenu_close").on("ui_mobilemenu_close",(()=>{this.$nav.length&&[!0,"true"].includes(this.$nav.attr("data-opened"))&&this.closeMenu()})));const l=flexbe_cli.components.getGlobalInstance("lazyLoading");l&&(l.forceLoadInlineInArea(this.$area[0]),l.forceLoadLazyInArea(this.$area[0]))},animationMobileShow(){const e=$("body");this.$nav.removeClass("header-style-round header-style-panel"),this.$nav.addClass(`${t} header-style-${this.navbarStyle}`),this.$headers.each(((e,t)=>{$(t).find(".element-item").toArray().every((e=>!e.offsetHeight))&&m($(t).closest(".header-area, .b_block"),!1);$(t).find(".elements-list").each(((e,t)=>{$(t).find(".element-item").toArray().every((e=>!e.offsetHeight))&&m($(t).closest(".elements-list"),!1)}))})),e.removeClass("is-mobile-menu--round is-mobile-menu--panel"),e.addClass(`is-mobile-menu--${this.navbarStyle}`)},fillNavbar(){const e=this,{created:t,$navbar:s,$headers:i,navmenuCreated:o}=e,r=s.find(h),d=s.find(u);r.empty(),d.empty();const b=[],g=[];!function(){const n=$(l).eq(0),s=$(c).eq(0);if(s.length||n.length){t.cart=!0,g.push("cart");const i=n.find(".cart-button-icon"),o=n.find(".cart-button-count"),r=s.find(".header-cart-button-icon"),l=s.find(".header-cart-button-count");let c,h,u;c=r.length?r.html():i.html(),l.length?(h=l.css("color"),u=l.css("background-color"),"rgba(0, 0, 0, 0)"===u&&(h="rgb(255, 255, 255, 1)",u="rgb(234, 127, 84, 1)")):(h=o.css("color"),u=o.css("background-color"));const b=`\n                        <li class="${a}">\n                            <div class="cart-button">\n                                <svg class="cart-button-icon">\n                                    ${c}\n                                </svg>\n                                <div class="cart-button-count" style="color: ${h}; background: ${u}">0</div>\n                            </div>\n                        </li>`;e.$cart=$(b),d.append(e.$cart),s.length||e.background||(e.color=n.css("color"),e.background=n.css("background-color"))}else t.cart=!1;if(t.cart){const t=e.$area.find(".cart-button"),a=t.find(".cart-button-count"),n=flexbe_cli.ecommerce.cartStore.getCount();d.toggleClass("cart-empty",!n),a.text(n),e.$cart.on(e.clickEvent,(()=>{e.toggleMenu(!1),flexbe_cli.events.emit("ui_cart_open")})),setTimeout((()=>{flexbe_cli.ecommerce.cartStore.on("dispatch.mobilemenu",((e,{name:n})=>{const s=flexbe_cli.ecommerce.cartStore.getCount();d.toggleClass("cart-empty",!s),a.text(s),"addItem"===n&&(t.addClass("blink"),setTimeout((()=>{t.removeClass("blink")}),300))}))}))}t.cart}(),function(){o?(e.$burger=$(`<li class="${n}"><i></i><i></i><i></i></li>`),d.append(e.$burger),g.push("burger"),e.$burger.on(e.clickEvent,(()=>{e.toggleMenu()})),t.burger=!0):t.burger=!1;t.burger}(),this.$nav.attr("data-enabled",!!g.length),g.length&&function(){const e=i.find(".component-logo").eq(0);if(e.length){const a=40/Math.max(.25,e.innerHeight()/e.innerWidth()),n=e.clone();t.logo=!0,n.css({fontSize:"",maxWidth:`${a}px`}),r.append(n),b.push("logo"),m(e,!1)}else t.logo=!1;t.logo}(),b.length&&g.length||g.length>1?this.navbarStyle="panel":0===b.length&&1===g.length?(this.navbarStyle="round",this.shouldBeFixed=!0):this.navbarStyle=!1},fillNavMenu(){const{created:e,$navmenu:t,$headers:a}=this;return["header_menu","header_text","header_contacts","header_social","header_button","header_html","header_cart","header_spacer"].forEach((n=>{const s=t.find(`[data-element=${n}]`),i=a.find(`[data-e-id="${n}"]`),o=i.length,r=s.hasClass("nav-menu-item--cart"),l=s.hasClass("nav-menu-item--spacer");if(s.empty(),o){if(!r&&!l){const e=i.clone();e.find('[class^="editor-"]').remove(),e.attr("data-cloned",!0),s.append(e),s.find("[data-direction]").attr("data-direction","column"),s.find("[data-direction-adaptive]").attr("data-direction-adaptive","column"),s.find(".element-content").removeClass("justify-content-center justify-content-end").addClass("justify-content-start")}m(i,!1),e[n]=e[n]?e[n]+o:o}})),this.navmenuCreated=Object.keys(e).length,this.navmenuCreated},toggleMenu(e){this[(e=void 0===e?!(e=[!0,"true"].includes(this.$nav.attr("data-opened"))):!!e)?"openMenu":"closeMenu"]()},openMenu(){this.isOpen=!0,this.$area.addClass("show"),this.$nav.outerHeight(),this.$nav.attr("data-opened",!0),this.$navmenu.addClass("active"),this.$burger&&this.$burger.addClass("active"),flexbe_cli.is_admin||flexbe_cli.scroll.scrollLock.lock(),this.setAreaSize(),this._onOpen(),$(window).on("resized.mobilemenu",(()=>{this.setAreaSize()})),"mobile"===flexbe_cli.resize.responsiveMode&&($("body").addClass("is-widget-open").css("background",this.background),this.shouldBeFixed||$("body, html").scrollTop(0))},closeMenu(){this.isOpen=!1,"mobile"===flexbe_cli.resize.responsiveMode&&($("body").removeClass("is-widget-open").css("background",""),Array.from(this.$navmenu.find(".folder-item")).forEach((e=>{$(e).removeClass("show"),$(e.lastElementChild).slideUp(0)}))),this.$area.removeClass("show"),this.$area.css("height",""),this.$nav.attr("data-opened",!1),this.$navmenu.removeClass("active"),this.$burger&&this.$burger.removeClass("active"),flexbe_cli.is_admin||flexbe_cli.scroll.scrollLock.unlock(),$(window).off("resized.mobilemenu"),this._onClose()},setAreaSize(){const e=this.isOpen?`${flexbe_cli.resize.viewportHeight}px`:"";this.$area.css("height",e)}})}();

!function(){class t{constructor(t){this.interacted=!1,this.inited=!1,this.activeUid=void 0,this.$activeTab=void 0,this.$activeSection=void 0,this.opts=t,this.$area=t.$area,this.dataAttr=t.dataAttr,this.classContainer=t.classContainer,this.initTabs(),t.activeUid&&this.selectTab(t.activeUid),this.$area.on("bringIntoView",(t=>this.selectTabFromTarget(t.target)))}initTabs(){if(this.$mainContainer="self"===this.classContainer?this.$area:this.$area.find(this.classContainer),this.$tabsContainer=this.$area.find(".container-tabs"),this.$tabsList=this.$area.find('[role="tablist"]'),this.$swiperHelper=this.$area.find(".tab-swiper-helper"),this.inited=!!this.$tabsList.length,this.inited&&(this.$tabs=this.$tabsList.find('[role="tab"]'),this.$sections=this.$mainContainer.find('[role="tabpanel"]'),this.normalizeLines(),setTimeout((()=>{this.$mainContainer.addClass("main-area--tabs-inited")}),50),this.$tabsContainer.on("click",".tab",(t=>{const i=$(t.currentTarget).closest(`[${this.dataAttr}]`).attr(`${this.dataAttr}`);i&&(this.selectTab(i),this.setHash())})),this.$tabsList.on("touchstart",(()=>{this.interacted=!0,this.destroySwipeAnimation()})),flexbe_cli.is_admin)){let t;this.$tabsContainer.on("mouseenter",".tab",(i=>{clearTimeout(t),1===i.buttons&&(t=setTimeout((()=>{const t=$(i.target).closest(`[${this.dataAttr}]`).attr(`${this.dataAttr}`);this.selectTab(t),this.setHash()}),700))})),this.$tabsContainer.on("mouseleave",".tab",(()=>{clearTimeout(t)}))}}isTabsOnScreen(){if(!this.inited)return!1;const{top:t,height:i}=this.$tabsList[0].getBoundingClientRect();return t>0&&t+i<flexbe_cli.resize.viewportHeight}swipeAnimationController(){if(!this.inited)return;const t=this.$tabsList[0]&&this.$tabsList[0].scrollWidth>this.$tabsList[0].clientWidth,i=this.isTabsOnScreen();t&&i?this.initSwiperAnimation():i||this.destroySwipeAnimation()}initSwiperAnimation(){this.$swiperHelper.hasClass("show")||this.interacted||this.$swiperHelper.addClass("show")}destroySwipeAnimation(){this.$swiperHelper.hasClass("show")&&this.$swiperHelper.removeClass("show")}selectTabFromTarget(t){const i=$(t).closest(`[${this.dataAttr}]`).attr(`${this.dataAttr}`);this.selectTab(i)}selectTab(t,{force:i}={}){var s,e;if(!t||!i&&this.activeUid===t)return;this.inited||this.initTabs();const a=null!=(s=null==(e=this.$tabs)?void 0:e.filter(`[${this.dataAttr}="${t}"]`))?s:[];if(!a.length)return;const n=this.$sections.filter(".active"),r=n[0]&&n[0].offsetTop,o=this.$sections.filter(`[${this.dataAttr}="${t}"]`);this.scrollToTab(a),this.$tabs.removeClass("active").attr("aria-selected",!1).attr("tabindex",-1),a.addClass("active").attr("aria-selected",!0).attr("tabindex",0),this.$sections.removeClass("active").prop("hidden",!0),o.addClass("active").prop("hidden",!1);const l=o[0]&&o[0].offsetTop;if(this.activeUid=t,this.$activeTab=a,this.$activeSection=o,"function"==typeof this.opts.onSelectTab&&this.opts.onSelectTab({uid:t,$tab:a}),!flexbe_cli.run.is_mobile&&null!=r&&null!=l&&Math.abs(r-l)>0&&"undefined"!=typeof anime){const t=this.$mainContainer,i=r-l;t.css("will-change","transform"),anime({targets:t[0],translateY:[i,0],duration:250,easing:"easeOutCubic",complete:()=>{t.css({transform:"","will-change":""})}})}}normalizeLines(){if(!this.inited)return;let t;const i=this.$tabs;this.$tabsList.find(".tab-spacer").remove(),i.removeClass("first-in-line last-in-line"),i.first().addClass("first-in-line"),i.last().addClass("last-in-line"),i.each(((i,s)=>{t&&t.offsetTop!==s.offsetTop&&($(s).addClass("first-in-line"),$(t).addClass("last-in-line"),$(t).after('<span class="tab-spacer"></span>')),t=s}))}scrollToTab(t){if(!this.inited)return;const i=this.$tabsList,s=i[0].scrollWidth;if(s>i[0].offsetWidth){const e=t[0].offsetLeft,a=t[0].getBoundingClientRect(),n=flexbe_cli.resize.viewportWidth;let r;a.width>n||a.left<20?r=e-20:a.right>n-20&&(r=e-(n-20-a.width)),null!=r&&(r=Math.max(0,Math.min(s-n,r)),i.animate({scrollLeft:r},{duration:250}))}}setHash(){const t=this.$activeSection.find("._anchor").eq(0).attr("name");this.currentAnchor=t,t&&i(t)}resetHash(){if(!this.inited)return;String(window.location.hash).replace(/^#{1,2}/,"")===this.currentAnchor&&i("")}}function i(t){flexbe_cli.is_admin||(flexbe_cli.lockPopstate=!0,window.history.replaceState(null,null,`#${t}`),flexbe_cli.lockPopstate=!1)}flexbe_cli.entity.setClientJs("block","BUNDLE",{components:["background"],tabsController:void 0,shouldInitTabs:!0,onUpdate({templateRendered:t}){t&&(this.shouldInitTabs=!0)},onResize(){this.tabsController&&this.tabsController.normalizeLines()},onBeside(t){t&&this.shouldInitTabs&&this.createTabs()},onFocus(t){this.tabsController&&(t?this.tabsController.swipeAnimationController():this.tabsController.resetHash())},createTabs(){this.$area.find(".layout-type-tabs").length?this.tabsController=new t({$area:this.$area,dataAttr:"data-item-uid",classContainer:".main-area",activeUid:this.selectedTabUid,onSelectTab:({uid:t})=>{this.selectedTabUid=t,this.updateTween()}}):this.tabsController=null}})}();

flexbe_cli.entity.setClientJs("block","FOOTER",{components:["background"]});

!function(){const t=new WeakMap,e=e=>{const{is:i,component:s}=e;t.has(s)||t.set(s,Math.floor(999999999*Math.random()));return`.component-${i}-${t.get(s)}`};class i{get is(){return this.constructor.is}constructor({component:t,core:e,reason:i}){this.require=[],this.core=null,this.owner=null,this.root=null,this.component=null,this.$component=null,this.componentWidth=null,this.componentHeight=null,this.isPageLoaded=!1,this.isInited=!1,this.isLoaded=!1,this.isUpdated=!1,this.isOpen=null,this.isVisible=null,this.inScreen=!1,this.inBeside=!1,this.inView=!1,this.inFocus=!1,this.wasVisible=null,this.wasScreen=!1,this.wasBeside=!1,this.wasView=!1,this.wasFocus=!1,this.core=e,this.owner=e.area,this.root=e.root,this.component=t,this.$component=$(t),this.isPageLoaded="complete"===document.readyState,this.isUpdated="update"===i}onInit(){}onLoad(){}onVisible(t){}onScreen(t){}onBeside(t){}onView(t){}onFocus(t){}onResize(t){}onOpen(t){}onClose(t){}onPageLoad(){}onWindowResize(){}onDestroy(){}_inheritEvents(){this._clearEvents();const t=e(this);this.core.$area.on(`tween${t}`,(t=>this._syncStates(t.detail))),this.core.$area.on(`open${t}`,(t=>this._onOpen(t.detail))),this.core.$area.on(`close${t}`,(t=>this._onClose(t.detail)))}_clearEvents(){const t=e(this);this.core.$area.off(t)}_syncStates({force:t=!1}={}){const e=this.component.offsetWidth,i=this.component.offsetHeight,s=null==this.componentWidth||null==this.componentHeight,n=this.core.isVisible&&!(!e&&!i),a=this.core.inBeside&&n,r=this.core.inScreen&&n,o=this.core.inView&&n,u=this.core.inFocus&&n,l=this.componentWidth!==e,h=this.componentHeight!==i,c=t||n&&!s&&(l||h);n&&(this.componentWidth=e,this.componentHeight=i),n!==this.isVisible&&this._onVisible({state:n}),c&&this._onResize({force:t}),a!==this.inBeside&&this._onBeside({state:a}),r!==this.inScreen&&this._onScreen({state:r}),o!==this.inView&&this._onView({state:o}),u!==this.inFocus&&this._onFocus({state:u})}_onInit(){this.isInited=!0,this._inheritEvents(),this._syncStates(),"function"==typeof this.onInit&&this.onInit(),flexbe_cli.require(this.require,(()=>this._onLoad()))}_onLoad(){this.isLoaded=!0,"function"==typeof this.onLoad&&this.onLoad()}_onVisible({state:t}){if(null==this.isVisible)return this.isVisible=t,void(this.wasVisible=t);const e=t&&!this.wasVisible;this.isVisible=t,this.onVisible({state:t,first:e}),t&&(this.wasVisible=!0)}_onScreen({state:t}){const e=t&&!this.wasScreen;this.inScreen=t,this.onScreen({state:t,first:e}),t&&(this.wasScreen=!0)}_onView({state:t}){const e=t&&!this.wasView;this.inView=t,this.onView({state:t,first:e}),t&&(this.wasView=!0)}_onBeside({state:t}){const e=t&&!this.wasBeside;this.inBeside=t,this.onBeside({state:t,first:e}),t&&(this.wasBeside=!0)}_onFocus({state:t}){const e=t&&!this.wasFocus;this.inFocus=t,this.onFocus({state:t,first:e}),t&&(this.wasFocus=!0)}_onResize(t){this.onResize(t)}_onOpen(t){this.isOpen=!0,this._syncStates(),this.onOpen(t)}_onClose(t){this.isOpen=!1,this._syncStates(),this.onClose(t)}_onPageLoad(){this.isPageLoaded=!0,this.onPageLoad()}_onWindowResize(){this.onWindowResize()}destroy(){this._clearEvents(),this.onDestroy()}}i.is=null;class s{static getRecaptchaSettings(){const t={env:{},...flexbe_cli.vars._group.flood&&flexbe_cli.vars._group.flood.captcha||{}};return!t.visible&&flexbe_cli.is_admin&&(t.enabled=0),t}constructor(t,e=s.getRecaptchaSettings()){this.id=t.id,this.options=t,this.$form=t.$form,this.enabled=e.enabled,this.isOptional=e.ttl>0,this.isVisible=e.visible,this.isInvisible=!e.visible,this.inModal=!(!this.isVisible||!this.isOptional&&!t.inModal),this._widgetId=null,this._token=null}get loaded(){return"undefined"!=typeof grecaptcha}get recaptchaSiteKey(){const{env:t}=s.getRecaptchaSettings();return this.isVisible?t.RECAPTCHA_VISIBLE_SITE_KEY:t.RECAPTCHA_INVISIBLE_SITE_KEY}init(){if(!this.enabled||!this.loaded||this._inited)return;this._inited=!0;const t=this.$form.find(".g-recaptcha-"+(this.isVisible?"visible":"invisible"));t[0]&&this.render(t[0])}getToken(){return this._token}render(t){if(!this.enabled||!this.loaded)return;let e=flexbe_cli.run.is_screen_mobile_s?"compact":"normal";this.isInvisible&&(e="invisible");const i={size:e,sitekey:this.recaptchaSiteKey,callback:t=>{this._token=t,this.closeModal(),this._onSuccess(t)},"expired-callback":()=>{this.reset(),this._onExpired()},"error-callback":()=>{this.reset(),this._onError()}};grecaptcha.ready((()=>{try{this._widgetId=grecaptcha.render(t,i)}catch(t){}"function"==typeof this.options.onRecaptchaRendered&&this.options.onRecaptchaRendered(this)}))}runModalCaptcha(){const t=`captcha-${this.id}`;if(!this._modal){const e=$(`\n                <div class="m_modal m_${t}" data-is="modal" data-id="${t}" data-m-id="CAPTCHA">\n                    <div class="modal-data">\n                        <div class="component-bg bg-color" data-type="color" data-parallax="0" data-component="background">\n                            <div class="overlay" data-opacity="1"></div>\n                        </div>\n\n                        <div class="modal-content" data-contrast="dark" data-v="1" data-as="1">\n                            <div class="close close-times"></div>\n\n                            <div class="recaptcha-title">\n                                ${flexbe_cli.locale.tr("quiz::captcha_label")}\n                            </div>\n\n                            <div id="recaptcha-${this.id}" class="g-recaptcha g-recaptcha-visible"></div>\n                        </div>\n                    </div>\n                </div>\n            `);flexbe_cli.modal.$list.append(e),this._modal=flexbe_cli.entity.initArea(e)}flexbe_cli.events.emit("ui_modal_open",{id:t,options:{hash:!1,rise:!0,onClose:()=>{this._token||this._onError()}}});const e=this._modal.$area.find(".g-recaptcha");null!=this._widgetId?this.reset():this.render(e[0])}closeModal(){this._modal&&flexbe_cli.events.emit("ui_modal_close",{id:this._modal.id})}runInvisibleChallenge(){this.enabled&&this.loaded&&!this.isVisible&&(grecaptcha.ready((()=>grecaptcha.execute(this._widgetId))),$('iframe[title="recaptcha challenge"]').parent().parent().css("z-index",2e3))}reset(){this.enabled&&this.loaded&&(this._token=null,null!=this._widgetId&&grecaptcha.ready((()=>grecaptcha.reset(this._widgetId))),"function"==typeof this.options.onReset&&this.options.onReset(this))}_onError(...t){"function"==typeof this.options.onError&&this.options.onError(this,...t)}_onSuccess(...t){"function"==typeof this.options.onSuccess&&this.options.onSuccess(this,...t)}_onExpired(...t){"function"==typeof this.options.onExpired&&this.options.onExpired(this,...t)}}function n(t){if(!t||!t.offsetParent)return null;let e=0,i=0;for(;t;){if("fixed"===$.css(t,"position")){e+=window.scrollY,i+=window.scrollX;break}e+=t.offsetTop-t.scrollTop,i+=t.offsetLeft-t.scrollLeft,t=t.offsetParent}return{top:Math.round(e),left:Math.round(i)}}const a={selectClass:"",dropdownClass:"",selectedClass:"selected",optionSelector:"option",attrValue:"value",position:"over",padding:10,title:!1};class r{static create(t){return new this(t)}constructor(t){this.opts=t,this.config={...a,...t.config},this.element=t.element,this.$select=$(this.element),this.isNativeSelect=this.$select.is("select"),this.selectAllDevice="select"===this.$select.data("type"),this.blurTimeOut=!1,this.blurListTimeOut=!1,this.focused=!1,this.active=!1,this.createSelect()}createSelect(){this.$customSelect=$(`\n            <div class="dropdown-container ${this.config.selectClass}">\n                <div tabindex="0" class="dropdown-select">\n                    <span class="dropdown-select__content selected"></span>\n\n                    <span class="arrow">\n                        <svg viewBox="0 0 10 6" xmlns="http://www.w3.org/2000/svg">\n                            <path fill="currentColor" d="M 1.4 6.99441e-15L 0 1.34043L 5 6L 10 1.34043L 8.6 0L 5 3.34998L 1.4 6.99441e-15Z"/>\n                        </svg>\n                    </span>\n                </div>\n            </div>\n        `),this.$customSelect__content=this.$customSelect.find(".dropdown-select__content"),this.$select.after(this.$customSelect),this.syncSelect(),this.selectAllDevice||flexbe_cli.run.is_screen_desktop||!flexbe_cli.responsive?(this.$customSelect.off("click.selected").on("click.selected",".dropdown-select",(()=>{clearTimeout(this.blurListTimeOut),this.active?this.collapse():this.activate()})),this.$customSelect.off("focus.selectFocus").on("focus.selectFocus",".dropdown-select",(()=>{this.focused=!0,this.$listWrapper||this.createList()})),this.isNativeSelect&&this.$select.off("change.changeSelect").on("change.changeSelect",(t=>{const e=this.$listWrapper.find(".dropdown-select-ul li"),i=t.currentTarget.value;e.removeClass(this.config.selectedClass),e.filter(((t,e)=>e.getAttribute(this.config.attrValue)===i)).addClass(this.config.selectedClass),this.$customSelect__content.text(i),"function"==typeof this.opts.onChange&&this.opts.onChange(t)})),this.$customSelect.off("keydown.selectKeydown").on("keydown.selectKeydown",".dropdown-select",(t=>{if(this.focused&&[13,27,32,38,40].includes(t.keyCode)){t.preventDefault();const e=this.$list.find(`.option-e.${this.config.selectedClass}`).filter((t=>!$(t).attr("disabled")));if(40===t.keyCode)t.preventDefault(),this.select(e.next(),!1),this.scrollToSelected();else if(38===t.keyCode)t.preventDefault(),this.select(e.prev(),!1),this.scrollToSelected();else if(this.active||32!==t.keyCode){if(this.active&&[13,27,32].includes(t.keyCode))return t.preventDefault(),this.collapse(),!1}else t.preventDefault(),this.activate()}}))):this.$select.off("change.selected").on("change.selected",(t=>{const e=t.target.value;this.$customSelect__content.text(e)}))}syncSelect(){const t=this.$select.children(this.config.optionSelector).filter(((t,e)=>{var i;return(null!=(i=e.selected)?i:$(e).attr("selected"))||$(e).hasClass(this.config.selectedClass)})).eq(0),e=t.html()||"—";this.$customSelect__content.attr(this.config.attrValue,t.attr(this.config.attrValue)),this.$customSelect__content.html(e)}createList(){const t=this.$select.children(this.config.optionSelector);this.$listWrapper=$(`\n            <div class="select-container-in-body">\n                <div class="overlay"></div>\n                <ul class="dropdown-select-ul scrollable ${this.config.dropdownClass}" tabindex="0"></ul>\n            </div>\n        `),this.$list=this.$listWrapper.find(".dropdown-select-ul"),t.each(((t,e)=>{var i,s,n;const a=$(e),r=(null!=(i=e.selected)?i:a.attr("selected"))||a.hasClass(this.config.selectedClass),o=(null!=(s=e.disabled)?s:a.attr("disabled"))||a.hasClass("disabled"),u=(null!=(n=e.locked)?n:a.attr("locked"))||a.hasClass("locked"),l=this.isNativeSelect?a.val():a.attr(this.config.attrValue),h=a.html().trim()||"—";let c="";this.config.title&&(c=a.attr("data-title"));const d=$(`<li title='${c}' class="option-e"></li>`);r&&!o&&d.addClass(this.config.selectedClass),o&&d.attr("disabled","disabled"),u&&d.attr("locked","locked"),d.attr(this.config.attrValue,l),d.html(h),this.$list.append(d)}))}select(t,e){if(!t[0])return;if(t.attr("disabled"))return clearTimeout(this.blurTimeOut),void this.$list.off("blur.listBlur").on("blur.listBlur",(()=>{this.focused=!1,this.blurListTimeOut=setTimeout((()=>{this.$listWrapper&&this.collapse()}),200)}));const i=t.attr(this.config.attrValue);if(t.siblings("li").removeClass(this.config.selectedClass),t.addClass(this.config.selectedClass),this.isNativeSelect)this.$select.val(i);else{const t=this.$select.children(this.config.optionSelector);t.removeAttr("selected").removeClass(this.config.selectedClass),t.filter(`[${this.config.attrValue}=${i}]`).addClass(this.config.selectedClass).attr("selected","selected")}this.syncSelect(),e&&this.collapse()}scrollToSelected(){const t=this.$list[0].offsetHeight;if(this.$list[0].scrollHeight<=t)return!1;const e=this.$list.children(".option-e").find(`.${this.config.selectedClass}`)[0];e&&e.scrollIntoView()}collapse(){clearTimeout(this.blurTimeOut),this.active=!1,this.$listWrapper.removeClass("active rise"),this.$listWrapper.detach(),"function"==typeof this.opts.onCollapse&&this.opts.onCollapse()}activate(){if(this.active)return!1;this.active=!0,this.createList();const t=this.config.padding||0,e={...n(this.$customSelect[0]),width:this.$customSelect.width(),height:this.$customSelect.height()};"under"===this.config.position&&(e.top=e.top+e.height+t),this.$listWrapper.off("click.closeSelect").on("click.closeSelect",".overlay",(t=>{this.collapse();const e=document.elementFromPoint(t.clientX,t.clientY);e&&e.focus()})),this.$listWrapper.off("click.selectLi").on("click.selectLi",".dropdown-select-ul li",(t=>{const e=$(t.currentTarget);this.select(e,!0),"function"==typeof this.opts.onSelect&&this.opts.onSelect(t)})),this.$listWrapper.off("mousewheel.selectUl").on("mousewheel.selectUl",".dropdown-select-ul",(t=>{const e=t.currentTarget.scrollHeight,i=t.currentTarget.clientHeight;return!(t.currentTarget.scrollTop===e-i&&t.deltaY>0||0===t.currentTarget.scrollTop&&t.deltaY<0)})),$("body").append(this.$listWrapper),clearTimeout(this.blurTimeOut),this.$list.css({left:`${e.left}px`,top:`${e.top}px`,width:`${e.width}px`}),this.$listWrapper.outerWidth(),this.$listWrapper.toggleClass("rise",!!this.$select.closest(".m_modal, .w_widget").length),this.$listWrapper.addClass("active"),this.scrollToSelected(),"function"==typeof this.opts.onActivate&&this.opts.onActivate()}}class o{constructor(t){if(this.$legend=t.find(".range-legend"),this.$component=t.find(".range-outer"),this.$input=t.find("input"),this.startEdge=this.$component.data("start"),this.isDouble=!!this.$component.data("double"),this.endEdge=this.$component.data("end"),this.range=this.endEdge-this.startEdge,this.barWidth=this.$component.width(),this.step=this.$component.data("step")||1,this.steps=Math.round(this.range/this.step),this.legendType=this.$legend.data("type"),this.legendText=1==+this.$legend.data("text"),this.animated=!0,this.duration=this.steps<10&&1/this.steps*300,this.fractExponent=Math.max(this.getFract(this.startEdge),this.getFract(this.endEdge),this.getFract(this.step)),this.fractDevider=10**this.fractExponent,this.$value=$(".range-value",this.$component),this.$endRunner=$(".range-runner-right",this.$component),this.$endRunnerTip=$(".runner-tip",this.$endRunner),this.$endRunnerValue=$(".value",this.$endRunner),this.endRunnerWidth=this.$endRunner.width(),this.$startRunner=$(".range-runner-left",this.$component),this.$startRunnerValue=$(".value",this.$startRunner),this.$startRunnerTip=$(".runner-tip",this.$startRunner),this.startRunnerWidth=this.$startRunner.width(),this.maxAllowedLeft=20,this.maxAllowedRight=flexbe_cli.resize.viewportWidth-20,this.defaultShift=this.$endRunner.width()/2,this.activeRunner=!1,this.isDouble){const t=this.$input.data("value").split(" — ");this.startValue=+t[0],this.endValue=+t[1]}else this.endValue=+this.$input.data("value"),this.startValue=+this.startEdge;this.endParams={},this.drawLegend(),this.updateTooltip(this.$startRunnerTip),this.updateTooltip(this.$endRunnerTip),this.setEvents(),this.setRunnersValue()}formatN(t){return`${t<0?"-":""}${flexbe_cli.locale.formatNumber(t,this.fractExponent)}`}getFract(t){const e=`${t}`.split(".");return e[1]&&e[1].length||0}drawLegend(){if(this.legendText)return!1;const t=this.$legend.find(".from"),e=this.$legend.find(".to");if(t.text(this.formatN(this.startEdge)),e.text(this.formatN(this.endEdge)),"complex"!==this.legendType)return!1;this.$legend.find(".legend-point:not(.from, .to)").off("click").remove(),this.$legend.removeClass("complex").addClass("limits");const i=[`${this.formatN(this.startEdge)}`.length,`${this.formatN(this.endEdge)}`.length,`${this.formatN(this.step)}`.length],s=(i[0]+i[1]+i[2])/3,n=Math.max(this.startEdge,this.endEdge),a=[5*this.step*this.fractDevider/this.fractDevider];for(let t=1;t<=12;t++){const e=10**t*this.step;e<n&&d(a,e,this.fractDevider)}let r;const o=Math.ceil(this.$legend.find(i[0]>i[1]?".from":".to").width()/Math.max(i[1],i[0])),u=Math.round(.83*this.barWidth/(o*s)),l=this.range>0?1:-1;for(let t=Math.min(u,10);t>=3;t--){const e=c(this.step,Math.abs(this.steps),t,a);if(e&&Number.isInteger(e/this.step)&&Number.isInteger(this.range/e)){r=e;break}}if(!r||!Number.isInteger(this.range/(r*l))||this.range/(r*l)<3)for(let t=Math.min(Math.round(this.range/this.step),u,10);t>=2;t-=1){const e=this.roundFraction(this.range/t);if(e%this.step==0){r=e*l;break}}const h=this.roundFraction(this.range/(r*l));if(r&&Number.isInteger(h)){const t=[];for(let e=1;e<h;e+=1){const i=Math.round((this.startEdge+r*e*l)*this.fractDevider)/this.fractDevider;t.push(`<div class="legend-point" data-value="${i}">${this.formatN(i)}</div>`)}h>2&&(this.$legend.attr("data-count",h),this.$legend.removeClass("limits").addClass("complex"));const e=$(t.join(""));this.$legend.find(".from").after(e)}else this.$legend.removeClass("complex").addClass("limits");function c(t,e,i,s){return s.includes(e/i*t)?e/i*t:s.includes((e+1)/i*t)?(e+1)/i*t:s.includes((e+2)/i*t)?(e+2)/i*t:s.includes((e+3)/i*t)?(e+3)/i*t:s.includes((e+4)/i*t)?(e+4)/i*t:s.includes((e+5)/i*t)?(e+5)/i*t:s.includes((e+6)/i*t)?(e+6)/i*t:s.includes((e+7)/i*t)?(e+7)/i*t:s.includes((e+8)/i*t)?(e+8)/i*t:!!s.includes((e+9)/i*t)&&(e+9)/i*t}function d(t,e,i){for(let s=1;s<10;s+=1)t.push(Math.round(e*s*i)/i),t.push(Math.round(e*s*i+e/2)/i)}this.$legend.find(".legend-point:not(.to), .legend-point:not(.from)").each(((t,e)=>{$(e).on("click",(()=>{if(this.updateBarWidth(),this.isDouble){const t=(this.startValue+this.endValue)/2,i=+$(e).data("value"),s=this.startEdge<this.endEdge?1:-1;i*s>=t*s?this.endValue=i:this.startValue=i}else this.endValue=$(e).data("value");this.setRunnersValue()}))}))}roundFraction(t){return Math.round(1e10*t)/1e10}setRunnersValue(t=!1){if(!Number.isFinite(this.endValue)||!Number.isFinite(this.range)||this.isDouble&&!Number.isFinite(this.startValue))return!1;const e=this.startEdge<this.endEdge?1:-1;"start"===this.activeRunner?this.startValue*e<=this.startEdge*e?this.startValue=this.startEdge:this.startValue*e>=this.endValue*e&&(this.startValue=this.endValue):this.endValue*e>=this.endEdge*e?this.endValue=this.endEdge:this.endValue*e<=this.startValue*e&&(this.endValue=this.startValue);const i=this.isDouble?this.startValue:this.startEdge,s=this.isDouble?(this.startValue-this.startEdge)/(this.range/100):0,n=(this.endValue-i)/(this.range/100);this.endValue=Math.round(this.endValue*this.fractDevider)/this.fractDevider,this.startValue=Math.round(this.startValue*this.fractDevider)/this.fractDevider,requestAnimationFrame((()=>{this.$endRunnerValue.text(this.formatN(this.endValue)),this.$startRunnerValue.text(this.formatN(this.startValue))})),"end"===this.activeRunner?this.updateTooltip(this.$endRunnerTip):this.updateTooltip(this.$startRunnerTip),this.$value.css({width:`${n}%`,marginLeft:`${s}%`}),t||(this.isDouble?this.$input.val(`${this.startValue} — ${this.endValue}`):this.$input.val(this.endValue))}updateTooltip(t){const e=t.closest(".range-runner");if(e&&e.length){const e=t.innerWidth(),i=t.closest(".range-runner")[0].getBoundingClientRect().left+this.startRunnerWidth/2;let s;s=e/2>i+this.maxAllowedLeft?e/2-(i-this.maxAllowedLeft):e/2+i>this.maxAllowedRight?this.maxAllowedRight-i-e/2:0,t.css({transform:`translateX(${s}px)`})}}getValueFromLength(t){const e=this.range/(this.barWidth/t);return(Math.round(e/this.step)+this.startEdge/this.step)*this.step}applyEndPosition(t){return this["start"===this.activeRunner?"startValue":"endValue"]=this.getValueFromLength(t),this.setRunnersValue(),!0}touchHendler(t){if(!this.endParams.active||1!==t.touches.length)return $("body")[0].removeEventListener("touchmove",this.touchHendler),!1;this.toggleAnimation(!1),t.preventDefault(),t.stopPropagation();const e=t.touches[0].pageX-this.endParams.left-this.endParams.shift;this.applyEndPosition(e)}startWatchingEvents(t=this.defaultShift){this.endParams={active:!0,left:this.$component.offset().left,shift:t},clearTimeout(this.calmRunnersTimeout),"end"===this.activeRunner?this.$endRunner.addClass("active"):this.$startRunner.addClass("active")}toggleAnimation(t){t?Math.abs(this.barWidth/this.steps)<15?this.$component.addClass("animated"):(this.$component.removeClass("active-animation"),this.duration&&this.$component.removeClass("animation-speed-"+(12-Math.abs(Math.round(this.steps))))):Math.abs(this.barWidth/this.steps)<15?this.$component.removeClass("animated"):(this.$component.addClass("active-animation"),this.duration&&this.$component.addClass("animation-speed-"+(12-Math.abs(Math.round(this.steps)))))}afterRunnerReleased(){this.endParams.active&&("start"===this.activeRunner?this.$startRunner.focus():this.$endRunner.focus()),this.endParams.active=!1,this.debounceActive(),this.barWidth/this.steps<15?this.$component.addClass("animated"):this.$component.removeClass("active-animation"),this.toggleAnimation(!0)}updateBarWidth(){const t=this.$component.width();t!==this.barWidth&&(this.barWidth=t,"complex"===this.legendType&&this.drawLegend())}setEvents(){const t=$(window),e=this;function i(i){if(!e.endParams.active)return t.off("mousemove.dragRange"),!1;e.toggleAnimation(!1);const s=i.pageX-e.endParams.left-e.endParams.shift;return e.applyEndPosition(s),!0}this.$component.on("resized",(()=>{this.updateBarWidth()})),this.$component.on("touchstart",(e=>{if(1!==e.touches.length)return!1;if(this.isDouble){const t=(this.$endRunner.offset().left+this.$startRunner.offset().left)/2;this.activeRunner=e.touches[0].pageX>=t?"end":"start","start"===this.activeRunner?(this.$startRunner.addClass("upper-runner"),this.$endRunner.removeClass("upper-runner")):(this.$endRunner.addClass("upper-runner"),this.$startRunner.removeClass("upper-runner"))}else this.activeRunner="end";e.stopPropagation(),this.updateBarWidth();const i=e.touches[0].pageX-this.$value.offset().left;this.startWatchingEvents(),this.applyEndPosition(i-this.defaultShift),t[0].addEventListener("touchmove",this.touchHendler.bind(this),{passive:!1}),t.on("touchend.range",(()=>{this.afterRunnerReleased(),t[0].removeEventListener("touchmove",this.touchHendler),t.off("touchend.range")}))})),this.$component.on("mousedown",(e=>{const s=e.pageX-this.$component.offset().left;if(this.isDouble){const t=(this.$endRunner.offset().left+this.$startRunner.offset().left)/2;this.activeRunner=e.pageX>=t?"end":"start","start"===this.activeRunner?(this.$startRunner.addClass("upper-runner"),this.$endRunner.removeClass("upper-runner")):(this.$endRunner.addClass("upper-runner"),this.$startRunner.removeClass("upper-runner"))}this.updateBarWidth(),this.startWatchingEvents(),this.applyEndPosition(s-this.defaultShift),"start"===this.activeRunner?this.$startRunner.focus():this.$endRunner.focus(),t.on("mousemove.dragRange",i),t.on("mouseup.range",(()=>{this.afterRunnerReleased(),t.off("mousemove.dragRange"),t.off("mouseup.range")}))})),this.$endRunner.on("touchstart",(e=>{if(1!==e.touches.length)return!1;e.stopPropagation(),this.updateBarWidth(),this.activeRunner="end",this.$startRunner.removeClass("upper-runner"),this.$endRunner.addClass("upper-runner"),e.stopPropagation(),this.startWatchingEvents(e.touches[0].pageX-this.$endRunner.offset().left),this.toggleAnimation(!1),t[0].addEventListener("touchmove",this.touchHendler.bind(this),{passive:!1}),t.on("touchend.range",(()=>{this.afterRunnerReleased(),t[0].removeEventListener("touchmove",this.touchHendler),t.off("touchend.range")}))})),this.$startRunner.on("touchstart",(e=>{if(1!==e.touches.length)return!1;e.stopPropagation(),this.updateBarWidth(),this.activeRunner="start",this.$startRunner.addClass("upper-runner"),this.$endRunner.removeClass("upper-runner"),e.stopPropagation(),this.startWatchingEvents(e.touches[0].pageX-this.$startRunner.offset().left),this.toggleAnimation(!1),t[0].addEventListener("touchmove",this.touchHendler.bind(this),{passive:!1}),t.on("touchend.range",(()=>{this.afterRunnerReleased(),t[0].removeEventListener("touchmove",this.touchHendler),t.off("touchend.range")}))})),this.$endRunner.on("mousedown",(e=>{e.stopPropagation(),this.activeRunner="end",this.$startRunner.removeClass("upper-runner"),this.$endRunner.addClass("upper-runner"),this.updateBarWidth(),this.$endRunner.focus(),this.startWatchingEvents(e.pageX-this.$endRunner.offset().left),this.toggleAnimation(!1),t.on("mousemove.dragRange",i),t.on("mouseup.range",(()=>{this.afterRunnerReleased(),t.off("mousemove.dragRange"),t.off("mouseup.range")}))})),this.$startRunner.on("mousedown",(e=>{e.stopPropagation(),this.activeRunner="start",this.$startRunner.addClass("upper-runner"),this.$endRunner.removeClass("upper-runner"),this.updateBarWidth(),this.$startRunner.focus(),this.startWatchingEvents(e.pageX-this.$startRunner.offset().left),this.toggleAnimation(!1),t.on("mousemove.dragRange",i),t.on("mouseup.range",(()=>{this.afterRunnerReleased(),t.off("mousemove.dragRange"),t.off("mouseup.range")}))})),this.$legend.find(".legend-point.to, .legend-point.from").each(((t,e)=>{$(e).on("click",(()=>{if(this.updateBarWidth(),this.isDouble){const t=this.startEdge<this.endEdge?1:-1,i=(this.startValue+this.endValue)/2,s=+$(e).data("value");s*t>=i*t?this.endValue=s:this.startValue=s}else this.endValue=$(e).data("value");this.setRunnersValue()}))})),this.$input.on("change",(()=>{if(this.isDouble){const t=this.$input.val().split(" — ");this.startValue=+t[0],this.endValue=+t[1]}else this.endValue=+this.$input.val();this.setRunnersValue(!0)})),this.$startRunner.on("keyup",(t=>{t.preventDefault(),this.activeRunner="start",this.handleKeydown(t,this.$startRunner)})),this.$endRunner.on("keyup",(t=>{t.preventDefault(),this.activeRunner="end",this.handleKeydown(t,this.$endRunner)})),this.$startRunner.on("keydown",(t=>{this.activeRunner="start",this.handleKeyup(t,this.$startRunner)})),this.$endRunner.on("keydown",(t=>{this.activeRunner="end",this.handleKeyup(t,this.$endRunner)})),this.$startRunner.on("blur",(()=>{this.handleBlur()}))}handleBlur(){this.movingInterval&&(clearInterval(this.movingInterval),this.movingInterval=!1),this.movingDebounceTimeout&&(clearTimeout(this.movingDebounceTimeout),this.movingDebounceTimeout=!1)}handleKeydown(t,e){if(this.movingInterval&&(clearInterval(this.movingInterval),this.movingInterval=!1),this.movingDebounceTimeout&&(clearTimeout(this.movingDebounceTimeout),this.movingDebounceTimeout=!1),[37,38,39,40].includes(t.keyCode)){const i=t.shiftKey?10:1,s="start"===this.activeRunner?"startValue":"endValue";38===t.keyCode||39===t.keyCode?this[s]=(this[s]/this.step+i)*this.step:37!==t.keyCode&&40!==t.keyCode||(this[s]=(this[s]/this.step-i)*this.step),e.addClass("active"),this.debounceActive(),this.setRunnersValue()}}handleKeyup(t,e){9!==t.keyCode&&[37,38,39,40].includes(t.keyCode)&&(t.preventDefault(),e.addClass("active"),this.debounceActive(),this.startDebouncedMove(t))}startDebouncedMove(t){this.movingDebounceTimeout&&(clearTimeout(this.movingDebounceTimeout),this.movingDebounceTimeout=!1),this.movingDebounceTimeout=setTimeout((()=>{this.movingInterval=setInterval((()=>{this.debounceActive();const e=t.shiftKey?10:1,i="start"===this.activeRunner?"startValue":"endValue";38===t.keyCode||39===t.keyCode?this[i]=(Math.round(this[i]/this.step)+e)*this.step:37!==t.keyCode&&40!==t.keyCode||(this[i]=(Math.round(this[i]/this.step)-e)*this.step),this.setRunnersValue()}),50)}),300)}debounceActive(){this.calmRunnersTimeout&&clearTimeout(this.calmRunnersTimeout),this.calmRunnersTimeout=setTimeout((()=>{this.$endRunner.removeClass("active"),this.$startRunner.removeClass("active")}),500)}}const u={phone:{RU:["+7 (***) ***-**-**","8 (***) ***-**-**"],KZ:["+7 (***) ***-**-**","8 (***) ***-**-**"],UA:["+38 (***) ***-****"],BY:["+375 ** *******"],US:["+1 (***) ***-****"]}};function l(t){if(void 0===window.IMask)return;const e={signed:!0,lazy:!0,padFractionalZeros:!0,definitions:"tel"===t.getAttribute("type")?{"*":/\d/,"#":/\d/}:{"#":/\d/,"@":/[A-Za-z\u00AA\u00B5\u00BA\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u0527\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0\u08A2-\u08AC\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0977\u0979-\u097F\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C33\u0C35-\u0C39\u0C3D\u0C58\u0C59\u0C60\u0C61\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D60\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F4\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191C\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19C1-\u19C7\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FCC\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA697\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA78E\uA790-\uA793\uA7A0-\uA7AA\uA7F8-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA80-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uABC0-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]/,"*":/./}},i=t.getAttribute("data-required");let s=t.getAttribute("data-mask");s=s&&!/[ #()*@{}]/.test(s)?function(t){const e=String(t).toLowerCase(),i=flexbe_cli.locale.country;let s=u[e]&&u[e][i];return s&&"string"==typeof s&&(s=[s]),Object.assign([],s)}(s):[s];try{if(s=s.filter((t=>/[ #()*@_{}]/.test(t))),s=s.map((t=>t.replace(/0/g,"\\0"))),0===s.length)throw{message:"Mask is empty"};s=1===s.length?String(s[0]):s.map((t=>({...e,mask:t})));const n=new window.IMask(t,{...e,mask:s,dispatch:(t,e)=>{const i=e.compiledMasks;if(1===i.length)return i[0];const s=(e.value+t).replace(/\W/g,"");return i.find((t=>{const e=t.mask.replace(/\W/g,"")[0];return s[0]===e}))||i[0]}}),a=()=>{n.masked.isComplete||!i&&!n.value?t.setAttribute("data-mask-complete",!0):t.removeAttribute("data-mask-complete"),t.setAttribute("value",n.value)};t.value&&a(),n.on("accept",a),$(t).on("focus",(e=>{requestAnimationFrame((()=>{$(t).trigger("click")}))})),t._mask=n}catch(e){e instanceof Error&&console.error("MASK ERROR:",{masks:s,errorMessage:e.message}),t.removeAttribute("data-mask")}}const h="next",c="result";class d extends i{constructor(...t){super(...t),this.id=this.core.id,this.eventId=`.quiz${this.id}`,this.createQuiz()}onInit(){this.$masked=this.$form.find("[data-mask]"),this.require=[],this.$masked.length&&(this.needInitMasks=!0,this.require.push("/_s/lib/imask/imask.min.js?v1")),this.$calendars=this.$form.find(".form-field-date__input"),this.$calendars.length&&(this.needInitCalendar=!0,this.require.push("/_s/lib/scroll-lock/scroll-lock.min.js"),this.require.push("/_s/lib/calendar/dist/js/calendar.js?v2.3.2","/_s/lib/calendar/dist/css/calendar.min.css?v2.3.2"))}onLoad(){(this.core.wasScreen||this.core.wasBeside)&&(this.needInitMasks&&this.initFieldMask(),this.needInitCalendar&&this.initFieldDate()),this.isLoaded=!0}onScreen({state:t}){if(!t)return!1;this.initQuiz()}onBeside({state:t}){if(!t)return!1;this.initQuiz()}onOpen(t={}){this.initQuiz(),this.started||this.startQuiz(),t&&t.data&&this.setData(t.data)}onResize(){this.$component.find(".range-outer").trigger("resize")}createQuiz(){this.timeouts=[],this.history=[],this.swiper=[],this.$area=this.core.$area,this.$root=this.core.$root,this.$form=this.$component.find("form"),this.$steps=this.$component.find(".quiz-steps"),this.$actions=this.$component.find(".quiz-actions"),this.$progress=this.$component.find(".quiz-progress"),this.$scroller=this.$root.find(".scroller"),this.$stepsWrapper=this.$steps.find(".steps-wrapper"),this.$outerWrapper=this.$area.find('[data-quiz-part="wrapper"]'),this.$welcomeScreen=this.$outerWrapper.find('[data-quiz-part="welcome"]'),this.$progress.length||(this.$progress=this.$area.find('[data-quiz-part="progress"]')),this.rootModal="modal"===this.core.is&&this.core,this.hasWelcome=!!this.rootModal||this.$welcomeScreen.length>0,this.autoNextEnabled=+this.$steps.attr("data-autonext")||0,this.currentId=null,this.currentIndex=-1,this.total=parseInt(this.$component.attr("data-total-steps"),10)}initQuiz(){if(this.inited)return;this.inited=!0,this.$form.attr("action","/mod/lead/send/"),this.resetForm(),this.bindEvents(),this.initFields(),this.initControls(),this.initCaptcha();const t=flexbe_cli.is_admin&&this.$area.data("initialQuizStepId"),e=flexbe_cli.is_admin&&this.$area.data("initialQuizStepIndex");t?this.toStep({id:t,index:e,animated:!1}):this.hasWelcome||this.startQuiz({animated:!1})}bindEvents(){flexbe_cli.events.off(this.eventId),this.$form.off(this.eventId),this.$scroller.off(this.eventId),flexbe_cli.events.on(`quiz_command${this.eventId}`,((t,e)=>{this.id===e.id&&("welcome"===e.command?this.toWelcome():"start"===e.command?this.startQuiz():"step"===e.command&&this.toStep({id:e.stepId,index:e.stepIndex,force:e.force,animated:e.animated,scrl:e.scroll}))})),this.$form.on(`change${this.eventId}`,".policy-data-warning__input",(t=>{this.$form.find(".policy-data-warning__input").prop("checked",t.target.checked)})),this.$form.on(`input${this.eventId} change${this.eventId}`,"input, textarea",(t=>{const e=t.currentTarget,i=e.value,s=$(e);s.attr("value",i),s.closest(".is_error").removeClass("is_error")})),this.$form.on(`keydown${this.eventId}`,"input, textarea",(t=>{const e=t.currentTarget,i=e.getAttribute("data-check"),s=t.key||"",n=t.ctrlKey||t.metaKey;return!("phone"===i&&!e._mask&&!n&&1===s.length&&/[^\d ()+-]/.test(s))&&(("email"!==i||!/[\s,]/.test(s))&&void 0)})),this.needInitCalendar&&"modal"===this.core.is&&setTimeout((()=>{this.$calendars.toArray().forEach((t=>{const e=$(t).data("calendar");this.$scroller.on(`scroll${this.eventId}`,(()=>{e.main.toPosition()}))}))}),150),this.$form.on(`submit${this.eventId}`,(()=>this.onSubmit()))}initControls(){$("body").off(`keydown${this.eventId}`).on(`keydown${this.eventId}`,(t=>{const e=9===t.keyCode,i=13===t.keyCode;if(!i&&!e)return;const s=this.inFocus,n=t.metaKey||t.ctrlKey,a=t.shiftKey;if(s&&("TEXTAREA"!==t.target.tagName||!i||n)){if(a&&e)this.toPrevStep();else if(!a&&!n){const t=this.$currentStep.find(":focus").closest(".field").next(".field");this.focusField(t)||this.toNextStep()}return t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation(),!1}})),this.$component.off("click.control").on("click.control","[data-quiz-action]",(t=>{const e=t.currentTarget.getAttribute("data-quiz-action");"welcome"===e?this.toWelcome():"prev"===e?this.toPrevStep():"next"===e&&this.toNextStep()}))}setProgress(){const t=this.$progress.find(".progress-loader-bar .current"),e=this.total,i=t.data("unit");let s=this.realIndex+1;if(flexbe_cli.is_admin&&-1===this.realIndex&&"welcome"!==this.currentId){s=(+this.$currentStep.prevAll('[data-linked="linked"]').first().attr("data-real-index")+1||0)+1}let n=parseInt(100*s/e,10)||0;if(s=Math.max(0,Math.min(e,s)),n=Math.max(0,Math.min(100,n)),t.length&&i){let a=`${n}%`;"step"===i?a=`${s} / ${e}`:"none"===i&&(a=""),t.attr("data-value",a)}this.$progress.attr("data-current-progress",n),this.$progress.attr("data-current",s),this.$progress.attr("data-total",e),this.$progress.find(".progress-text .current").text(s),this.$progress.find(".progress-text .total").text(e),this.$progress.find(".progress-percent .current").text(n),this.$progress.find(".progress-loader-bar .current").css("width",`${n}%`),this.$progress.find(".progress-loader-circle .current").attr("stroke-dashoffset",`${Math.abs(100-n)}`)}setActionButtons(){let t=this.hasWelcome||this.history.length>1||!!(flexbe_cli.is_admin&&0!==this.realIndex&&this.currentIndex>0);!flexbe_cli.is_admin||!this.rootModal||this.realIndex&&this.currentIndex||(t=!1),this.$actions.toggleClass("show-prev",t)}toWelcome({scrl:t=!0}={}){if(!this.hasWelcome)return this.startQuiz({scrl:t}),!0;if(this.started=!1,this.currentIndex=-1,this.realIndex=-1,this.currentId="welcome",this.$area.data("initialQuizStepId",this.currentId),this.$area.data("initialQuizStepIndex",this.currentIndex),this.$outerWrapper.attr("data-active-step",this.currentId),this.$outerWrapper.attr("data-active-index",this.currentIndex),this.$outerWrapper.toggleClass("quiz-state-welcome",!0),this.$outerWrapper.toggleClass("quiz-state-started",!1),this.rootModal)flexbe_cli.is_admin||flexbe_cli.events.emit("ui_modal_close",{id:this.rootModal.id});else if(this.$outerWrapper.length){const t=this.$welcomeScreen.outerHeight()||0;this.$outerWrapper.css("minHeight",t)}return this.setProgress(),this.setActionButtons(),t&&"block"===this.core.is&&!flexbe_cli.is_admin&&flexbe_cli.scroll.toElement(this.$area),flexbe_cli.events.emit("quiz_event",{event:"welcome",sender:"core",quiz:this}),!0}startQuiz({animated:t,scrl:e}={}){this.sessionId=parseInt(Date.now()/1e3,10);const i=this.$stepsWrapper.find('.step[data-type="root"][data-linked="linked"]').first();i.length&&this.toStep({$step:i,force:!0,animated:t,scrl:e})}autoNextStep(){!this.autoNextEnabled||this.$currentStep.find(".quiz-fields").data("count")>1||setTimeout((()=>{this.toNextStep()}),150)}toPrevStep(){const t=this.history[this.history.length-2];if(!t){const t=this.$currentStep.prevAll('.step[data-type="root"][data-linked="linked"]').first();return t.length?this.toStep({$step:t}):this.hasWelcome&&this.toWelcome(),!1}return this.toStep(t),!0}toNextStep({force:t}={}){if(!(t||this.validateStep()))return!1;const e=this.$currentStep.attr("data-goto"),i=this.$currentStep.attr("data-goal"),s=this.$currentStep.attr("data-html-goal"),n=this.history.find((t=>t.id===this.currentId))||{},a=this.$currentStep.find("[data-field-id]").map(((t,e)=>{const i=$(e),s=i.attr("data-field-id"),n=i.find("input, textarea").not('[type="hidden"]'),a=i.find("[data-goto]"),r=i.attr("data-type"),o=i.find(`[name="vars[${s}]"]`).val();let u=n.attr("type"),l=a,h=n.val();["checkbox","radio","image"].includes(r)?l=a.filter(":checked"):"select"===r?(l=l.filter(((t,e)=>e.selected)),u="select"):"file"===r&&(h=Array.from(n[0].files));const c=l.toArray(),d=c.map((t=>t.getAttribute("data-goto"))).filter((t=>t));return{id:s,title:o,type:r,inputType:u,value:h,variants:c.map((t=>({id:t.getAttribute("data-id"),value:t.value}))).filter((t=>t.id)),goto:d}})).toArray(),r=a.map((t=>{const e={id:t.id,title:t.title,type:t.type};return["radio","checkbox","select","image"].includes(t.inputType)?e.variants=t.variants:e.value=t.value,e})),o=a.reduce(((t,e)=>t.concat(e.goto)),[]),u=this.getNextStep({gotoId:o[0]||e||h});n&&(n.fields=a,n.answers=r,n.toId=u,n.goal=i,n.htmlGoal=s),this.toStep({id:u,historyItem:n})}getNextStep({gotoId:t,$current:e=this.$currentStep}={}){if(t===c){const t=this.history.map((t=>t.$step[0])),e=this.$stepsWrapper.find('[data-type="root"][data-linked="linked"][data-required]').filter(((e,i)=>!t.includes(i)));return e.length?e.eq(0).attr("data-id"):c}let i=t;if(t===h||!this.$stepsWrapper.find(`.step[data-id="${i}"]`).length){i=e.nextAll('.step[data-type="root"][data-linked="linked"]').first().attr("data-id")}if(t===h&&!i)return this.getNextStep({gotoId:c,$current:e});if(!this.checkStepCondition({id:i})){const t=e.nextAll('.step[data-type="root"][data-linked="linked"]').first();return this.getNextStep({gotoId:h,$current:t})}return i}toStep({id:t,index:e,$step:i,force:s,scrl:n=!0,animated:a=!0,historyItem:r}){var o,u;if(this.inStepAnimation)return!1;if(null==r&&(r=this.history.find((t=>t.id===this.currentId))),t===c)return void this.toResult({historyItem:r});if(i&&i.length||null==t||(i=this.$stepsWrapper.find(`.step[data-id="${t}"]`)),i&&i.length||null==e||(i=this.$stepsWrapper.find(`.step[data-index="${e}"]`)),!i||!i.length)return!1;if(t=null!=(o=t)?o:i.attr("data-id"),e=parseInt(null!=(u=e)?u:i.attr("data-index"),10),t===this.currentId)return this.enableStep(i),!1;const l=flexbe_cli.is_admin?parseInt(i.attr("data-real-index"),10):e,h=e>this.currentIndex;a||this.$area.addClass("noanimate"),i.find(".is_error").removeClass("is_error");const d=i.outerHeight(),p={$step:i,id:t,title:i.find(".step-title").text().trim(),index:e,realIndex:l,fields:[],answers:[]};let f=[];s?(f=this.history,this.history=[]):(f=this.history.filter((t=>t.index>=p.index)),this.history=this.history.filter((t=>!f.includes(t)))),f.forEach((t=>{this.disableStep(t.$step)})),this.enableStep(i),this.started=!0,this.history.push(p),this.$component.addClass("quiz-started"),a&&this.$component.addClass("step-change-animation");const m=window.scrollParent(this.$component[0])||document.scrollingElement,g=m&&m.scrollTop||0,$=this.$stepsWrapper.outerHeight();if(this.$area.data("initialQuizStepId",t),this.$area.data("initialQuizStepIndex",e),this.$outerWrapper.attr("data-active-step",t),this.$outerWrapper.attr("data-active-index",e),this.$outerWrapper.toggleClass("quiz-state-welcome",!1),this.$outerWrapper.toggleClass("quiz-state-started",!0),i.toggleClass("higher",d>$),a&&this.$stepsWrapper.css("height",`${$}px`),this.$outerWrapper.css("minHeight",`${$}px`),i.prevAll().removeClass("active next").addClass("prev"),i.nextAll().removeClass("active prev").addClass("next"),i.removeClass("next prev").addClass("active"),this.currentId=t,this.currentIndex=e,this.realIndex=l,this.$currentStep=i,this.core.updateTween(),this.setProgress(),this.setActionButtons(),this.initImages(),2===flexbe_cli.theme_id){const t=this.$area.find(".b_head");t.length&&flexbe_cli.header.fixHeaderHeight(this.$area,t)}return this.timeouts=this.timeouts.filter((t=>clearTimeout(t))),this.timeouts.push(setTimeout((()=>{a||this.$area.removeClass("noanimate")}),20)),a?(this.inStepAnimation=!0,this.timeouts.push(setTimeout((()=>{this.$stepsWrapper.css("height",""),this.$component.removeClass("step-change-animation"),this.$component.find(".range-outer").trigger("resize"),this.inStepAnimation=!1}),250)),n&&(this.timeouts.push(setTimeout((()=>{const t=this.$area.get(0).getBoundingClientRect();this.$stepsWrapper.css("height",`${d}px`);const e=m.scrollTop,i=this.$area.get(0).getBoundingClientRect().bottom-t.bottom-(g-e);i&&m.scrollTo(0,e+i)}),150)),flexbe_cli.is_admin||this.timeouts.push(setTimeout((()=>{let t=this.$component;this.$area.outerHeight()<=flexbe_cli.resize.viewportHeight&&(t=this.$area),flexbe_cli.scroll.toElement(t,{centered:!0,force:!1,complete:()=>{flexbe_cli.run.is_mobile||this.focusField(i)}})}),450)))):this.$component.find(".range-outer").trigger("resize"),r=r||{},this.lastHistoryItem=r,flexbe_cli.events.emit("quiz_event",{event:"step",sender:"core",quiz:this,payload:{fromId:r.id,fromTitle:r.title,fromAnswers:r.answers,toNext:h,toId:t,sessionId:this.sessionId},answerGoals:{goal:r.goal,htmlGoal:r.htmlGoal}}),!0}toResult({force:t,historyItem:e}={}){const i=t||this.validateStep();return!!(t||!this.busy&&i)&&(null==e&&(e=this.history[this.history.length-1]),this.result=this.getResult(),this.lastHistoryItem=e,this.$form.submit(),!0)}validateStep(){let t=!0;if(!this.$currentStep||!this.$currentStep.length)return!0;const e=this.$currentStep.find(".policy-data-warning--checkbox"),i=e.find("input")[0];return i&&!i.checked&&(t=!1,e.addClass("is_error animate")),this.$currentStep.find(".field[data-type]").each(((e,i)=>{const s=$(i),n=s.attr("data-type");let a;if(s.removeClass("is_error"),"captcha"===n){if(!this.captcha)return;a=!this.captcha.getToken()&&flexbe_cli.locale.tr("form::captcha_not_checked")}else a=this.checkField(s);a&&(s.outerWidth(),s.addClass("is_error animate"),setTimeout((()=>{s.removeClass("animate")}),500),s.find(".error").text(a),t&&this.focusField(s,500),t=!1)})),t}getResult(){const t=this.$form.find("input[name=results]").data("value")||[];let e=t.filter((t=>null!=t.id&&"default"!==t.id)).find((t=>this.checkResultCondition(t)));return e||(e=t.find((t=>null==t.id||"default"===t.id))||t[0]),"object"!=typeof e.action&&(e.action={pay:e.pay,name:e.action,modal_id:e.modal_id,action_redirect:e.action_redirect}),e}checkStepCondition(){return!0}checkResultCondition(t){const e=t.conditions||{},i=e.union,s=e.list||[],n=this.history.reduce(((t,e)=>t.concat(e.fields)),[]);let a=s.map((t=>{const e=n.find((e=>String(e.id)===String(t.field)));return{condition:t,field:e}}));return!!a.length&&(a=a["and"===i?"every":"some"]((({condition:t,field:e})=>{let i=!0;if(!e)return!1;if("vars"===t.type){const s=e.variants||[],n=(t.variants||[]).map((t=>`${t}`));if(!s.length)return!!t.emptyVariant;if(t.unionExtra||(i=s.every((t=>n.includes(`${t.id}`)))),i){let a=t.union;"radio"!==e.inputType&&"select"!==e.inputType||(a="or"),i=n["and"===a?"every":"some"]((t=>s.find((e=>e.id===t))))}}else if("range"===t.type){const s=`${e.value}`.replace(/\s+/g,"").split(/\s[—-]\s/).map((t=>+t)).filter((t=>"number"==typeof t&&!Number.isNaN(t))),n=Math.min.apply(null,s),a=Math.max.apply(null,s),o=n!==a;let u=+t.rangeLimitFrom,l=+t.rangeLimitTo;if("equal"===t.operator)return o?n<=u&&u<=a:u===n;r(u)&&r(l)&&(u=Math.min(t.rangeLimitFrom,t.rangeLimitTo),l=Math.max(t.rangeLimitTo,t.rangeLimitFrom)),i&&r(u)&&(i=u<=n),i&&r(l)&&(i=a<=l)}else if("text"===t.type){const i=t.fill,s=(e.value||"").trim().replace(/ +/g," ").replace(/\+/g,"∔"),n=t.answers.map((t=>`${t}`.toLowerCase().replace(/\+/g,"∔"))).filter((t=>t));if("fill"===i)return!!s;if("empty"===i)return!s;if("include"===i)return n.some((t=>new RegExp(`^${t}|\\s${t}`,"i").test(s)));if("exclude"===i)return n.every((t=>!new RegExp(`^${t}|\\s${t}`,"i").test(s)))}else if("file"===t.type){const i=t.fill,s=e.value;if("fill"===i)return!!s.length;if("empty"===i)return!s.length}return i})),a);function r(t){return!Number.isNaN(+t)&&null!=t&&""!==t}}checkField(t){const e=t.find("input, textarea, select").not('[type="hidden"]'),i=e[0],s=t[0];if(!i)return;const n=s.getAttribute("data-type"),a=[!0,1,"true","1"].includes(s.getAttribute("data-is-required")),r=i.getAttribute("data-check")||!1,o=i._mask&&i.getAttribute("data-mask")||!1;let u;u=["checkbox","radio","image"].includes(n)?!!e.closest(":checked").length:"file"===n?i.files:i.value;let l=!(!a||u)&&"form.required";if(o){!a&&!u||i.getAttribute("data-mask-complete")||(l="phone"===n&&u?"form.phone":"text"===n&&u?"form.text":"form.required")}else if(r)if(u.length&&"email"===n){/^(([^\s"(),.:;<>@[\\\]]+(\.[^\s"(),.:;<>@[\\\]]+)*)|(".+"))@((\[(?:\d{1,3}\.){3}\d{1,3}])|(([\wЁА-яё-]+\.)+[A-Za-zЁА-яё]{2,}))$/.test(u)||(l="form.email")}else if(u.length&&"phone"===n)if(/[^\d\s()+-]/.test(u))l="form.digits";else{u.replace(/\D/g,"").length<5&&(l="form.minlength")}else if("file"===n)l=!(!a||u.length)&&"form.required";else if("date"===n||"datetime"===n){const t=$(i).data("calendar"),e=t&&t.input.checkError();e&&(l=e)}return l=l&&flexbe_cli.locale.tr(l)||!1,l}disableStep(t){t.find("input, textarea, select").prop("disabled",!0)}enableStep(t){t.find("input, textarea, select").prop("disabled",!1)}focusField(t,e=200){if(!t||!t.length)return!1;if(flexbe_cli.run.is_ios)return!1;const i=t.find(".form-field-text__input, .dropdown-select").not(".form-field-date__input").first();return!!i.length&&(e?setTimeout((()=>i.focus()),e):i.focus(),!0)}initImages(){setTimeout((()=>{const t=$(this.component).find(".step.active");$(t).find(".component-image").length&&function(t,e,i,s={}){const n=$(t),a=e?`[data-component="${e}"]`:"[data-component]";n.is(a)?n.trigger(i,s):$(t).find(a).each(((t,e)=>{$(e).trigger(i,s)}))}(t,"image","setImage")}),100)}initFields(){this.initFieldImage(),this.initFieldCheckbox(),this.initFieldRadio(),this.initFieldSelect(),this.initFieldTextarea(),this.initFieldFile(),this.initFieldRange(),this.isLoaded&&(this.needInitMasks&&this.initFieldMask(),this.needInitCalendar&&this.initFieldDate())}initFieldImage(){this.$component.off("click.fieldImages").on("click.fieldImages",".form-field-image-item",(t=>{const e=t.currentTarget.querySelector("input"),i=!e.checked;e.checked=i,i&&"radio"===e.type&&this.autoNextStep()}))}initFieldFile(){this.$component.off("change.uploadFile").on("change.uploadFile",".file-input",(t=>{const e=$(t.currentTarget),i=e.parents(".form-field-file"),s=i.find(".form-field-file--files"),n=e.val(),a=t.currentTarget.files.length;if(i.addClass("active"),e.parents(".field").removeClass("is_error"),0===a)i.removeClass("active");else if(1===a)s.find(".text").text(n);else if(a>1){const t=a%100,e=a%10;let i;i=1===e&&11!==t?"form.filesMult":e>1&&e<5?"form.filesMult1":"form.filesMult2",s.find(".text").text(`${a} ${flexbe_cli.locale.tr(i)}`)}})),this.$component.off("click.clearFiles").on("click.clearFiles",".clear-files",(t=>{const e=$(t.currentTarget).parents(".form-field-file");e.find(".file-input").val(""),e.removeClass("active")}))}initFieldCheckbox(){}initFieldRadio(){this.autoNextEnabled&&this.$component.off("change.initRadio").on("change.initRadio",".form-field-radio-item",(()=>{this.autoNextStep()}))}initFieldSelect(){this.$component.find(".dropdown-container").remove();const t=this.$component.find("select.atom-custom-select"),e={position:"under",dropdownClass:this.$component.hasClass("style-underlined")?"sharp size--large":"size--large"};t.each(((t,i)=>{const s=$(i).closest('[data-type="select"]');r.create({element:i,config:e,onChange:this.autoNextStep.bind(this),onSelect:this.autoNextStep.bind(this),onCollapse:()=>{s.removeClass("active")},onActivate:()=>{s.addClass("active"),s.siblings('[data-type="select"]').removeClass("active")}})}))}initFieldTextarea(){this.$component.find("textarea.autosize").each(((t,e)=>{const i=e.offsetHeight-e.clientHeight,s=$(e);s.removeAttr("data-autoresize"),s.off("keyup input").on("keyup input",(function(t){t.currentTarget.style.height="auto",t.currentTarget.style.height=`${t.currentTarget.scrollHeight+i}px`}))}))}initFieldRange(){this.$component.find(".form-field-range").each(((t,e)=>new o($(e))))}addSubmitting(){this.busy=+Date.now(),this.$component.addClass("submitting"),this.$form.addClass("submitting")}clearSubmitting(t=!1){this.busy&&(this.$component.removeClass("submitting"),this.$form.removeClass("submitting"),t?(this.$component.addClass("success"),setTimeout((()=>{this.busy=!1,this.$component.removeClass("success")}),1e3)):this.busy=!1)}onSubmit(){const t={p_id:flexbe_cli.p_id,id:this.core.id,name:this.result.name,action:this.result.action.name,jsform:parseInt(448312,10)};if(flexbe_cli.stat.u_id&&(t.f_uid=flexbe_cli.stat.u_id),"pay"===this.result.action.name&&this.result.action.pay){const e=this.result.action.pay;e.desc&&(t["pay[desc]"]=e.desc),e.price&&(t["pay[price]"]=e.price,e.title&&(t["product[items]"]=JSON.stringify([{title:e.title,id:`${flexbe_cli.p_id}_${flexbe_cli.s_id}`,img:e.img,count:1,price:e.price}]),t["product[price]"]=e.price,t["product[total]"]=1))}return Object.entries(t).forEach((([t,e])=>{null!=e&&this.addFields([{name:t,value:e,type:"hidden"}],!1)})),this.sendForm(),!1}async sendForm(){const t=this.captcha&&this.captcha.getToken();if(this.captcha&&this.captcha.enabled&&!this.captcha.isOptional&&!t)return void(this.captcha.isVisible?this.toStep({id:"captcha"}):this.captchaInvisibleRun());this.addSubmitting();const e=new FormData(this.$form.get(0));if(e.append("is_ajax","true"),"undefined"!=typeof flexbeAPI&&void 0!==flexbeAPI.customLeadData&&e.append("customLeadData",JSON.stringify(flexbeAPI.customLeadData)),e.append("f_ab",JSON.stringify(flexbe_cli.stat.AB.getCookie())),"function"==typeof e.delete&&e.delete("g-recaptcha-response"),t&&e.append("captcha-token",t),flexbe_cli.run.is_OSX&&"function"==typeof e.entries)for(const t of e.entries()){const[i,s]=t;"object"==typeof s&&s instanceof File&&0===s.size&&"function"==typeof e.delete&&e.delete(i)}try{const t=await flexbe_cli.helpers.fetch(this.$form.attr("action"),{processData:!1,contentType:!1,data:e});void 0!==t.pay&&(this.pay=t.pay),this.clearSubmitting(!0),this.captchaRemoveError(),this.showDone()}catch(e){const i=e.data;if(i.captcha)return this.captcha||await this.initCaptcha({...s.getRecaptchaSettings(),enabled:!0,visible:"visible"===i.captcha,ttl:1}),void(t?this.captchaAddError():this.captcha.isVisible?(this.captcha.isOptional=!1,this.total=parseInt(this.$component.attr("data-total-steps"),10)+1,this.clearSubmitting(!1),this.toStep({id:"captcha"})):this.captcha.isInvisible&&this.captchaInvisibleRun());this.clearSubmitting(!1),console.error("sendForm error: ",e),alert("Form submitting error!")}}showDone(){const t=()=>{setTimeout((()=>{this.resetForm(),this.toWelcome({scrl:!1})}),500)},e=this.result.action.name,i=this.lastHistoryItem;if(i){const t=i.answers,e=i.id,s=i.title,n=this.result.goals||{};flexbe_cli.events.emit("quiz_event",{event:"submit",sender:"core",quiz:this,payload:{fromAnswers:t,fromId:e,fromTitle:s,sessionId:this.sessionId},answerGoals:{goal:i.goal,htmlGoal:i.htmlGoal},resultGoals:{mainGoal:flexbe_cli.stat.goals.order_done,goal:n.goal,htmlGoal:n.goal_html}})}if("function"==typeof this.afterSent&&this.afterSent(),"pay"===e&&void 0!==this.pay&&null!==this.pay&&this.pay.pay_link.length>0){const e=`${window.location.origin+window.location.pathname+(window.location.search?`${window.location.search}&`:"?")}pay_id=${this.pay.pay_id}&h=${this.pay.pay_hash}`;try{window.history.pushState(null,null,e),setTimeout((()=>{flexbe_cli.events.emit("pay",{action:"init"})}),200)}catch(t){setTimeout((()=>{document.location=e}),500)}t()}else if(["redirect","anchor"].includes(e)){const e=this.result.action.action_redirect,i=this.result.action.action_link;if(e)setTimeout((()=>{flexbe_cli.helpers.links.gotoLink(e),t()}),1e3);else if(i){const e=$(`a[name="${i.replace("#","")}"]`);e.length>0&&flexbe_cli.scroll.toElement(e.parent()),t()}else t()}else{const e=this.result.action.modal_id;flexbe_cli.events.emit("ui_modal_open",{id:e}),t()}}resetForm(){this.$form.find(".form-field-file, .file-input-outer").removeClass("active");const t=this.$stepsWrapper.find("input, textarea, select"),e=t.not("select").not('[type="hidden"]').not(".form-field-range__input"),i=t.filter("select"),s=t.filter(".form-field-range__input");t.prop("disabled",!0),i.each(((t,e)=>{const i=e.querySelector("option"),s=i&&i.value||"";e.value!==s&&(e.value=s,e.dispatchEvent(new Event("change")))})),s.each(((t,e)=>{e.value=e.getAttribute("data-value"),e.dispatchEvent(new Event("change"))})),e.each(((t,e)=>{const i=e.defaultChecked;["radio","checkbox"].includes(e.type)?e.checked=i:(e.removeAttribute("value"),e.value="",e.removeAttribute("data-mask-complete"),e._mask&&e._mask.updateValue()),e.dispatchEvent(new Event("change"))})),this.captcha&&this.captcha.enabled&&(this.captcha.reset(),this.captchaRemoveError()),this.$form[0].reset()}async initCaptcha(t){return null==t&&(t=s.getRecaptchaSettings()),new Promise(((e,i)=>{!this.captcha&&t.enabled&&(this.captcha=new s({id:this.id,$form:this.$component,onSuccess:()=>{this.captchaRemoveError(),this.toResult({force:!0})},onError:()=>{this.captchaAddError()}},t),flexbe_cli.require(`https://www.google.com/recaptcha/api.js?render=explicit&hl=${flexbe_cli.vars._group.language}`,(()=>{let t=150;const s=setInterval((()=>{t-=1,this.captcha.loaded?(this.captcha.init(),clearInterval(s),e()):0===t&&i(new Error("Can not load grecaptcha"))}),10)})))}))}captchaAddError(t){if(!this.captcha||!this.captcha.enabled)return;null==t&&(t=flexbe_cli.locale.tr("form::captcha_error"));const e=this.$component.find(".captcha-global-error");e.find(".error-text").text(t),e.addClass("show"),this.busy&&this.clearSubmitting()}captchaRemoveError(){if(!this.captcha||!this.captcha.enabled)return;const t=this.$component.find('.field[data-type="captcha"]'),e=this.$component.find(".captcha-global-error");t.removeClass("is_error"),e.removeClass("show")}captchaInvisibleRun(){if(!this.captcha||!this.captcha.enabled||!this.captcha.loaded||this.captcha.isVisible)return;this.addSubmitting(),this.captcha.runInvisibleChallenge();const t=this.busy;setTimeout((()=>{t===this.busy&&this.clearSubmitting()}),2500)}setData(t){if(!t)return!1;t&&t.fields&&this.addFields(t.fields),t&&t.items&&this.addItems(t.items)}addFields(t,e=!0){const i=this.$component.find(".form-fields-advanced");t.length&&i[0]&&(e&&i.empty(),t.forEach((t=>{i.find(`input[name="${t.name}"]`).remove();const e=$("<input>").attr("type",t.type).attr("name",t.name).attr("value",t.value);i.append(e)})))}addItems(t=[]){if(!t||!t.length)return;let e=0,i=0,s="";const n=[];t=t.map((t=>"object"!=typeof t?{}:(t.count=parseInt(t.count,10)||1,t.price=parseFloat(t.price)||0,t.title="string"==typeof t.title&&t.title.trim()||t.title||"",e+=t.price*t.count||0,i+=t.count,t)));try{s=JSON.stringify(t)}catch(t){}let a={"product[items]":s,"product[price]":e,"product[total]":i};e&&(a={...a,"pay[price]":e,"pay[desc]":""}),Object.entries(a).forEach((([t,e])=>{n.push({type:"hidden",name:t,value:e})})),this.addFields(n)}initFieldMask(){return"undefined"!=typeof IMask&&(this.needInitMasks=!1,this.$masked.each(((t,e)=>{l(e);const i=!!e.getAttribute("data-placeholder"),s=e._mask;i&&s&&($(e).on(`focus${this.eventId}`,(()=>{s.updateOptions({lazy:!1})})),$(e).on(`blur${this.eventId}`,(()=>{if(!s.unmaskedValue){const t=s.mask.replace(/\*/g,"_"),e=s.value;s.updateOptions({lazy:!0}),s.masked.rawInputValue&&t!==e||(s.unmaskedValue="",s.value="",s.updateValue())}})))})),!0)}initFieldDate(){this.needInitCalendar=!1;const t=this.$component.closest(".scroller")[0];return this.$calendars.each(((e,i)=>{!function(t,e){const i=$(t),s=i.closest("[data-type]").attr("data-type"),n=i.attr("data-date-range")||"any",a=i.attr("data-date-work-days")||"0,1,2,3,4,5,6";let r=(new Date).getFullYear()+3;"datetime"===s&&(r=(new Date).getMonth()>=8?(new Date).getFullYear()+1:(new Date).getFullYear());let o=new Date((new Date).getFullYear()-100,0,1),u=new Date(r,11,31);"datetime"!==s&&"future"!==n||(o=new Date),"date"===s&&"past"===n&&(u=new Date);const l={type:s,lowerLimit:o,upperLimit:u,dateRange:n,locale:flexbe_cli.locale.translation.calendar,dateFormat:flexbe_cli.locale.date_format,showDateSelector:"date"===s&&"future"!==n,insertTo:e,workDays:a.split(","),workTime:null};if("datetime"===s){const t=i.attr("data-date-time-interval")||30,e=i.attr("data-date-time-start")||"00:00",s=i.attr("data-date-time-finish")||"00:00";l.workTime={interval:t,start:{hour:+e.substring(0,2),minute:+e.substring(3,5)},finish:{hour:+s.substring(0,2),minute:+s.substring(3,5)}}}i.calendar(l)}(i,t)})),!0}}d.is="quiz";flexbe_cli.entity.setClientJs("block","QUIZ",{components:["background","image",class extends d{setProgress(){const t=this.$progress.find(".progress-loader-bar .current"),e="step"===this.$progress.attr("data-text-style"),i=t.attr("data-unit"),s=this.total;let n=this.realIndex;if(flexbe_cli.is_admin&&-1===this.realIndex&&"welcome"!==this.currentId){n=+this.$currentStep.prevAll('[data-linked="linked"]').first().attr("data-real-index")+1||0}n=Math.max(0,Math.min(s-1,n));const a=e?n+1:n,r=parseInt(100*a/s,10);if(this.$progress.attr("data-current",a),this.$progress.attr("data-total",s),this.$progress.attr("data-current-progress",r>0?r:0),t&&i){const e=t.find(".progress-runner");let n=`${r}%`;"step"===i?n=`${a} / ${s}`:"none"===i&&(n=""),e.attr("data-value",n)}this.$progress.find(".progress-text .current").text(a),this.$progress.find(".progress-text .total").text(s),this.$progress.find(".progress-percent .current").text(r),this.$progress.find(".progress-loader-bar .current").css("width",`${r}%`),this.$progress.find(".progress-loader-circle .current").attr("stroke-dashoffset",`${Math.abs(100-r)}`)}initFieldFile(){this.$form.on(`change.file${this.eventId}`,".file-input--original",(t=>{const e=$(t.currentTarget),i=e.parents(".file-input-outer"),s=e.val(),n=t.currentTarget.files.length;if(i.addClass("active"),e.closest("[data-type]").removeClass("is_error"),1===n)i.find(".file-item--title").text(s);else if(n>1){const t=n%100,e=n%10;let s;s=1===e&&11!==t?"form.filesMult":e>1&&e<5?"form.filesMult1":"form.filesMult2",i.find(".file-item--title").text(`${n} ${flexbe_cli.locale.tr(s)}`)}else i.removeClass("active")})),this.$form.on(`click${this.eventId}`,".clear-files",(t=>{const e=$(t.currentTarget).parents(".file-input-outer");e.find(".file-input--original").val(""),e.removeClass("active")}))}}]})}();

flexbe_cli.entity.setClientJs("element","avatar01",{components:["icon","image"]});

flexbe_cli.entity.setClientJs("element","button01",{components:["icon"]});

flexbe_cli.entity.setClientJs("element","form01",{components:["form","icon"]});

flexbe_cli.entity.setClientJs("element","form02",{components:["form","icon"]});

flexbe_cli.entity.setClientJs("element","header_button",{components:["icon"]});

flexbe_cli.entity.setClientJs("element","header_menu",{components:["menu"]});

flexbe_cli.entity.setClientJs("element","icon01",{components:["image","icon"]});

flexbe_cli.entity.setClientJs("element","image01",{components:["image"]});
