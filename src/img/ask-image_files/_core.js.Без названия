!function(){"use strict";function e(e){if((e=Math.trunc(e)||0)<0&&(e+=this.length),!(e<0||e>=this.length))return this[e]}const t=Reflect.getPrototypeOf(Int8Array);for(const i of[Array,String,t])Object.defineProperty(i.prototype,"at",{value:e,writable:!0,enumerable:!1,configurable:!0});function i(e){console.warn("video load error, gif fallback used");const t=e.querySelector("img");t&&e.parentNode.replaceChild(t,e)}function o(e){const t=document.cookie.match(new RegExp(`(?:^|; )${e.replace(/([$()*+./?[\\\]^{|}])/g,"\\$1")}=([^;]*)`));return t?decodeURIComponent(t[1]):void 0}function s(e,t,i={}){let o=i.expires;if("number"==typeof o&&o){const e=new Date;e.setTime(e.getTime()+1e3*o),o=e,i.expires=e}o&&o.toUTCString&&(i.expires=o.toUTCString());let s=`${e}=${t=encodeURIComponent(t)}`;Object.keys(i).forEach((e=>{s+=`; ${e}`;const t=i[e];!0!==t&&(s+=`=${t}`)})),document.cookie=s}function n(e){window.setCookie(e,"",{expires:-1})}function a(e){let t;if(e){const e=window.location.href.indexOf("?");if(-1===e)return[];t=window.location.href.substr(e+1)}else t=window.location.search.substr(1);const i={};return t.split("&").forEach((e=>{if(!e)return;const t=(e=e.split("+").join(" ")).indexOf("=");let o=t>-1?e.substr(0,t):e;const s=t>-1?r(e.substr(t+1)):"",n=o.indexOf("[");if(-1===n)i[r(o)]=s;else{const e=o.indexOf("]",n),t=r(o.substring(n+1,e));o=r(o.substring(0,n)),i[o]||(i[o]=[]),t?i[o][t]=s:i[o].push(s)}})),i}function r(e){try{return decodeURIComponent(e)}catch(t){return e}}function l(e,t=3,i=" "){return(e+="").split("").reverse().join("").match(new RegExp(`.{0,${t}}`,"g")).join(i).split("").reverse().join("").trim()}function c(e){e.preventDefault()}function d(e=!1){document.body[!0===e?"addEventListener":"removeEventListener"]("touchmove",c,!1)}const h=function(){const e=/(auto|scroll)/,t=(e,i)=>null===e.parentNode?i:t(e.parentNode,i.concat([e])),i=(e,t)=>getComputedStyle(e,null).getPropertyValue(t),o=(t,o)=>e.test(((e,t)=>i(e,t?`overflow-${t}`:"overflow"))(t,o));return(e,i)=>{if(!(e instanceof HTMLElement||e instanceof SVGElement))return;const s=t(e.parentNode,[]);for(let e=0;e<s.length;e+=1)if(o(s[e],i))return s[e];return document.scrollingElement||document.documentElement}}();!function(e){e.videoImgFallback=i,e.getCookie=o,e.setCookie=s,e.deleteCookie=n,e.getJsonFromUrl=a,e.chunkSplit=l,e.freezeVp=c,e.preventBodyScrolling=d,e.scrollParent=h}(window);class u{on(e,t){}one(e,t){}off(e,t){}emit(e,...t){}constructor(){!function(e){"object"!=typeof e&&(e=this);const t={_JQInit(){this._JQ=$({})},emit(e,t){return this._JQ||this._JQInit(),this._JQ.trigger(e,t),this},one(e,t){return this._JQ||this._JQInit(),this._JQ.one(e,t),this},on(e,t){return this._JQ||this._JQInit(),this._JQ.on(e,t),this},off(e,t){return this._JQ||this._JQInit(),this._JQ.off(e,t),this}};Object.keys(t).forEach((i=>{e[i]=t[i].bind(e)}))}(this)}}var p=new u;const m=2560,f={avif:null,webp:null};function _(){var e;const t="object"==typeof flexbe_cli&&(null==(e=flexbe_cli.vars)?void 0:e._group.images)||{};return{lazy:!0,lazy_priority:!1,avif:!1,webp:!1,avif_support:f.avif||t.avif_support,webp_support:f.webp||t.webp_support,slow_network:!1,quality_map:{jpg:70,webp:70,avif:55}}}async function g(e){try{const t=new Image;return"decode"in t?(t.src=e,await t.decode(),!0):await new Promise((i=>{t.onload=()=>i(!0),t.onerror=()=>i(!1),t.src=e}))}catch(e){return!1}}async function w(e){return new Promise(((t,i)=>{const o=new Image,s=()=>{t(o),setTimeout((()=>{"function"==typeof o.remove&&o.remove()}),10)};"decode"in o&&!/\.svg/.test(e)?(o.src=e,o.decode().then(s).catch(i)):(o.onerror=i,o.onload=s,o.src=e)}))}function b(e){if("string"!=typeof e)return e;e=e.replace(/(\/img\/[\d_q]+)\/[\w-]+(\.\w{3,4})/i,"$1$2");let[,t,i,o,s]=e.match(/\/img\/(\d+)_?(\d+)?_?q?(\d+)?\.(\w{3,4})/i)||[];return i=i?+i:0,o=o?+o:"none",{id:t,ext:s,name:`${t}.${s}`,size:i,quality:o}}function A(e,t){const i=t.avif_support,o=t.webp_support,s=t.avif,n=t.webp;let a=e.ext;return i&&s?a="avif":o&&n?a="webp":"webp"===e.ext&&(a=o?"webp":e.transparent?"png":"jpg"),a}function v(e,t=null,i=null){var o;i={..._(),...i};const{id:s,ext:n}=e;if(!s)return"";t||"webp"!==e.ext||i.webp_support||(t=Math.min(e.width||m,m));const a=null!=(o=e.animated)?o:"gif"===n,r=`/img/${s}.${n}`;if(!t||a||"svg"===n)return r;const l=A(e,i),c=i.slow_network&&I();let d=i.quality_map;switch(c&&(d={jpg:50,webp:50,avif:45}),l){case"png":return`/img/${s}_${t}.png`;case"avif":case"webp":case"jpg":return`/img/${s}_${t}_q${d[l]}.${l}`;case"gif":default:return r}}function y(e){const t=String(e).match(/\.(jpg|jpeg|png|gif|svg|bmp|webp)$/i);return t&&t[1]?t[1]:""}function x(e){return"transparent"!==e?e:"#000000"}function k(e){if("string"==typeof e&&(e=b(e)),!e||"object"!=typeof e)return{};let t=e.img_ext||e.ext;const i=e.img_id||e.id,o=e.img_name||e.name;t&&"false"!==t||(t=o?y(o):"jpg");const s=e.img_border||e.border;return{id:i,ext:t,average:x(e.img_average||e.average),preview:e.img_preview||e.preview||"",width:e.img_width||e.width||0,height:e.img_height||e.height||0,proportion:+(+e.img_proportion||+e.proportion||0).toFixed(2),border:s,animated:e.img_animated||e.animated||"gif"===t,transparent:e.img_transparent||e.transparent||0}}function C(e,t=0,i){return v(k(e),"number"==typeof t?Math.round(t):t,i)}async function S(e){let t=e,i=+e.proportion;if(i&&(i<2||i<5&&i%1>0)&&(i*=100),"string"==typeof t||!i){"object"==typeof t&&(t=C(e,50));const o=await w(t);i=o.naturalHeight/o.naturalWidth*100}return i}function I(){var e;return"4g"!==((null==(e=navigator.connection)?void 0:e.effectiveType)||"4g")}var T=Object.freeze({__proto__:null,resolveImageSupports:async function(){var e,t;return f.avif=null!=(e=f.avif)?e:await g("data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A="),f.webp=null!=(t=f.webp)?t:await g("data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA"),f},getDefaultLoadingOptions:_,checkFormatSupport:g,preloadImage:w,parseImageUrl:b,getOptimalExt:A,createUrl:v,getExtensionFromFilename:y,normalizeAverage:x,getImage:k,getImageUrl:C,getImageProportion:S,getImageOptimalSize:async function(e,t,i){i={..._(),...i};const o=e.width||0,s=e.img_scale||e.scale||"cover",n=e.img_type||e.type||"background",a=t.height/t.width,r=await S(e)/100,l=i.slow_network&&I()?Math.min(1.5,window.devicePixelRatio):Math.min(2,window.devicePixelRatio),c=A(e,i);let d,h;return"image"===n||a>r&&"contain"===s||a<r&&"cover"===s?(d=t.width,h=d*r):(h=t.height,d=h/r),l>1&&(d*=l,h*=l),i.sizes&&(d=function(e,t){let i=(t=t.sort(((e,t)=>t-e)))[0];return t.forEach((t=>{e<i&&e<=t&&(i=t)})),i}(d,i.sizes),h=d*r),d<=150&&/webp|jpg/.test(c)&&(d=d/l*2,h=d*r),o&&d>o&&(d=o,h=d*r),d>m&&(d=m,h=d*r),{width:Math.ceil(d),height:Math.ceil(h)}}});var E={init(){const e=document.getElementById("flexbe-globals");try{const t=JSON.parse(e.getAttribute("data-store"));Object.assign(this,t),e.parentNode.removeChild(e)}catch(e){}}};function P(e,t){let i=["screen"];return null!=e&&i.push(`(min-width: ${e}px)`),null!=t&&i.push(`(max-width: ${t}px)`),i=i.join(" and "),window.matchMedia(i).matches}const M={async init(){this.deviceInfo(),this.applyClasses(),await this.supportsInfo(),$(window).on("resize.deviceInfo",(()=>{this.deviceInfo()})),$(window).on("resized.deviceInfo",(()=>{this.applyClasses()}))},async supportsInfo(){const e=flexbe_cli.vars._group.images||{},[t,i]=await Promise.all([e.webp_support||g("data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA"),e.avif_support||g("data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A=")]);e.webp_support=t,e.avif_support=i},deviceInfo(){var e,t;const i=null==(e=window.CSS)?void 0:e.supports("zoom",1),o=navigator.userAgent.toLowerCase();this.is_responsive=!!flexbe_cli.vars._page.responsive,this.is_screen_mobile=P(0,767),this.is_screen_mobile_scaled=i&&P(0,399),this.is_screen_desktop=P(768,1e4),this.is_screen_desktop_scaled=i&&P(768,1199),this.is_touch=window.matchMedia("(any-pointer: coarse)").matches,this.is_pointer=window.matchMedia("(any-hover: hover)").matches,this.is_tablet=/ipad|xoom|kindle|playbook|tablet/i.test(o),this.is_mobile=!this.is_tablet&&-1!==o.indexOf("mobile"),this.is_desktop=!this.is_mobile&&!this.is_tablet,this.is_chrome=/(chromium|chrome)\/(\d+)/.test(o),this.is_safari=-1!==o.indexOf("safari")&&(null==(t=o.match(/version\/(\d+)/))?void 0:t[1]),this.is_firefox=-1!==o.indexOf("firefox"),this.is_mobile_ie=-1!==o.indexOf("iemobile"),this.is_ie=-1!==o.indexOf("trident")||-1!==o.indexOf("msie"),this.is_EDGE=-1!==o.indexOf("edge"),this.is_OSX=/ipad|iphone|ipod|macintosh/gi.test(o),this.is_android=-1!==o.indexOf("android"),this.is_ios=this.is_OSX&&this.is_touch&&!this.is_desktop,this.is_bot=/bot|aolbuild|bingpreview|msnbot|baidu|duckduckgo|mediapartners-google|teoma|slurp/gi.test(o),this.is_instagram=/instagram/i.test(o),this.is_mobile&&this.is_touch?this.device_type="mobile":this.is_tablet&&this.is_touch?this.device_type="tablet":this.device_type="desktop"},applyClasses(){const e=$(document.body);e.toggleClass("is-mobile",M.is_mobile),e.toggleClass("is-tablet",M.is_tablet),e.toggleClass("is-desktop",M.is_desktop),e.toggleClass("is-pointer",M.is_pointer),e.toggleClass("is-touch",M.is_touch),e.toggleClass("is-ios",!!M.is_ios),e.toggleClass("is-android",M.is_android),e.toggleClass("is-osx",M.is_OSX&&M.is_desktop),e.toggleClass("is-safari",!!M.is_safari),M.is_safari&&e.addClass(`is-safari-${M.is_safari}`),e.toggleClass("is-edge",M.is_EDGE),e.toggleClass("is-firefox",M.is_firefox),e.toggleClass("is-chrome",M.is_chrome),e.toggleClass("is-instagram",M.is_instagram)}};let O;var z=new class{constructor(){this.containerWidth=null,this.oldWidth=null,this.oldHeight=null,this.locked=!1,this.clientWidth=null,this.clientHeight=null,this.viewportWidth=null,this.viewportHeight=null,this.proportion=null}init(){this.simulateWindowResized(),this.simulateDocumentResize(),this.updateSizes({resize:!1}),this.watchContainerSize(),this.applySizeVariablesOnResize()}trigger(e,t=window){t.dispatchEvent(new CustomEvent(e))}updateSizes({width:e,height:t,proportion:i=null,lock:o=null,resize:s=!0}){var n,a,r;const l=document.documentElement,c=l.clientWidth,d=l.clientHeight,h=null!=(n=this.scrollbarWidth)?n:window.innerWidth-c;e=null!=(a=e)?a:this.locked?this.viewportWidth:c,t=null!=(r=t)?r:this.locked?this.viewportHeight:d,e=Math.min(e,c),t=Math.min(t,d);const u=e>=768&&e<=1199;(u||e>=0&&e<=399)&&(e=u?1200:400),this.oldWidth=this.clientWidth,this.oldHeight=this.clientHeight,this.scrollbarWidth=h,this.clientWidth=c,this.clientHeight=d,this.viewportWidth=e,this.viewportHeight=t,null!=i&&(this.proportion=i),null!=o&&(this.locked=o),this.responsiveMode=M.is_responsive&&e<=767?"mobile":"desktop",s&&(this.trigger("resize"),this.trigger("resized"))}applySizeVariablesOnResize(){const e=M.is_desktop||flexbe_cli.is_admin?10:200,t=$(document.documentElement),i=$(document.body),o=()=>{const o=this.proportion?this.viewportWidth/this.proportion:this.viewportHeight;(!this.coverHeight||Math.abs(this.coverHeight-o)>e)&&(this.coverHeight=o),t.css("--100vw",`${this.viewportWidth}px`),t.css("--100vh",`${this.viewportHeight}px`),t.css("--coverHeight",`${this.coverHeight}px`),t.css("--scrollbarWidth",`${this.scrollbarWidth}px`),i.toggleClass("adaptive-mobile","mobile"===this.responsiveMode),i.toggleClass("adaptive-desktop","desktop"===this.responsiveMode)};o(),M.is_ios&&setTimeout((()=>o()),150),$(window).on("resized.setVars",(()=>o()))}watchContainerSize(){const e=()=>{const e=document.createElement("div");e.classList.add("container"),requestAnimationFrame((()=>{document.body.appendChild(e),this.containerWidth=e.offsetWidth,document.body.removeChild(e)}))};e(),$(window).on("resized.setContainer",(()=>e()))}simulateWindowResized(){let e,t=this.oldWidth,i=this.oldHeight;$(window).on("resize orientationchange",(o=>{o.originalEvent&&(this.updateSizes({resize:!1}),clearTimeout(e),e=setTimeout((()=>{this.oldWidth=t,this.oldHeight=i,t=this.clientWidth,i=this.clientHeight,this.trigger("resized")}),80))}))}simulateDocumentResize(){requestAnimationFrame((()=>{this.documentHeight=document.body.offsetHeight}));const e=flexbe_cli.is_admin?500:150,t=(e=0)=>{const t=document.body.offsetHeight;Math.abs(t-this.documentHeight)>=5&&(this.documentHeight=t,this.trigger("documentresize",document),clearTimeout(O),O=setTimeout((()=>{this.trigger("documentresized",document)}),e))};if("function"==typeof ResizeObserver){let i=!0;new ResizeObserver((()=>{i?i=!1:t(e)})).observe(document.querySelector("body"))}else setInterval((()=>{t(0)}),e)}};const F=[];function D(e="",t=(()=>{}),i=15e3,o=!1){if(e&&0!==e.length||t(!1),!o){"string"==typeof e&&(e=[e]);let o=0;const s=i=>{const s=e.every((e=>"boolean"==typeof F[e]));o+=1,s&&o===e.length&&t(i)};return Array.isArray(e)&&e.forEach((e=>{D(e,s,i,!0)})),!1}if(!0===F[e])t(!0);else if(Array.isArray(F[e]))F[e].push(t);else{let o,s=!1;const n=(t=!0)=>{if(s)return;s=!0,clearTimeout(o);const i=F[e];F[e]=t,i.forEach((e=>{"function"==typeof e&&e(t)}))};if(F[e]=[t],/\.css(\?.*)?$/.test(e)){const t=document.createElement("link");t.onerror=n.bind(this,!1),t.onload=n.bind(this,!0),o=setTimeout(n.bind(this,"timeout"),i),t.rel="stylesheet",t.href=e,document.body.appendChild(t)}else{const t=document.createElement("script");t.onload=n.bind(this,!0),t.onerror=n.bind(this,!1),o=setTimeout(n.bind(this,"timeout"),i),t.async=!0,t.src=e,document.body.appendChild(t)}}}const L={inScroll:!1,skip:!1,_latest:null,get latest(){return this._latest},init(){requestAnimationFrame((()=>{this._latest=window.scrollY})),document.addEventListener("wheel",(()=>{this.$inScrollElement&&(this.$inScrollElement.stop(),this.$inScrollElement=null)}),{passive:!0}),document.addEventListener("scroll",(()=>{this.inScroll=!0,this._latest=window.scrollY}),{passive:!0}),document.addEventListener("scrollend",(()=>{this.inScroll=!1}),{passive:!0}),this.scrollLock.init(),this.scrollImprovement.init()},scrollImprovement:{scrollTimer:0,pointerState:!1,init(){this.createStopScrollEvent(),this.scrollRestore()},createStopScrollEvent(){let e=L.latest;document.addEventListener("scroll",(()=>{const t=e>L.latest?"up":"down",i=Math.max(L.latest-e,e-L.latest);clearTimeout(this.scrollTimer),this.scrollTimer=setTimeout((()=>{e=L.latest,document.dispatchEvent(new CustomEvent("scrollend",{detail:{direction:t,distance:i}}))}),200)}),{passive:!0})},scrollRestore(){window.history.scrollRestoration&&(window.history.scrollRestoration="auto")}},scrollLock:{loaded:!1,locked:!1,init(){this.loaded||D(["/_s/lib/scroll-lock/scroll-lock.min.js"],(()=>{this.loaded=!0,window.scrollLock._state.lockableSelectors=["html","[data-scroll-lock-lockable]"],window.scrollLock._state.scrollableSelectors=["[data-scroll-lock-scrollable]",".scroller",".scrollable"],window.scrollLock._state.fillGapSelectors=["html","[data-scroll-lock-lockable]","[data-scroll-lock-fill-gap]"],this.locked&&(window.scrollLock.disablePageScroll(),z.trigger("resized"))}))},lock(){this.locked=!0,void 0!==window.scrollLock&&(window.scrollLock.disablePageScroll(),z.trigger("resized"))},unlock(){this.locked=!1,void 0!==window.scrollLock&&(window.scrollLock.clearQueueScrollLocks(),window.scrollLock.enablePageScroll(),z.trigger("resized"))}},to(e){document.scrollingElement.scrollTo(0,e)},toElement(e,t={}){const i=$(e);if(!(e=i[0]))return!1;null==t.animation&&(t.animation=!0),null==t.centered&&(t.centered=!0),null==t.force&&(t.force=!0);let o,s=0,n=0,a=window.scrollParent(e,"y");a&&!$(a).is(".b_block, .container-list")||(a=document.scrollingElement);const r=t.padding||0,l=a===document.body||a===document.documentElement,c=l?flexbe_cli.resize.clientHeight:a.offsetHeight,d=i.offset().top,h=e.offsetHeight,u=l?$("html, body"):$(a);M.is_mobile?o=u.find(".menu-fixed > .nav-header"):4===flexbe_cli.theme_id?n=flexbe_cli.fixed.getAllFixedHeight(d):o=u.find('.floating[data-floating="true"]'),o&&o.length&&(n+=o[0].offsetHeight-2);const p=Math.max(0,c-n-h);if(h>=c&&(t.centered=!1),s=t.centered?d-Math.max(0,p/2)-n:d-r-n,t.offset&&(s+=t.offset),!t.force){const e=a.offsetTop,o=i[0].getBoundingClientRect();if(o.top>=e&&o.bottom<=e+c)return"function"==typeof t.complete&&t.complete(),!1}this.$inScrollElement=u,$(document).off("documentresize.scrollTo").on("documentresize.scrollTo",(()=>{this.toElement(e,t)})),u.stop(),u.animate({scrollTop:s},{delay:t.delay||0,duration:t.duration?t.duration:t.animation?450:0,easing:t.animation?"swing":"linear",always:(...e)=>{this.$inScrollElement=!1,$(document).off("documentresize.scrollTo"),"function"==typeof t.complete&&t.complete(...e)}})}};function B(e,t=!1){const i=$(e).eq(0);if(i.length&&(t||i.is(":hidden"))){const e=new Event("bringIntoView",{bubbles:!0,cancelable:!0});i[0].dispatchEvent(e)}}function V(e,t=!1){const i=window.parent||window;if(!e)return console.warn("WRONG ACTION","empty_link"),void(flexbe_cli.is_admin&&p.emit("editor_page_error",{type:"action",error:"link_is_wrong"}));flexbe_cli.is_admin?p.emit("editor_leave_page",{href:e}):i.location.host===window.location.host?t?i.open(e,"_blank").focus():i.location.href=e:window.location.href=e}function j(e="",{blank:t}={}){if("string"!=typeof e)return!1;if(!/#{1,2}.+/.test(e))return V(e,t),!0;{4===flexbe_cli.theme_id&&$('nav[data-opened="true"]').length&&p.emit("ui_mobilemenu_close",{}),4!==flexbe_cli.theme_id&&$(".mobile-menu.show").length&&$(".mobile-menu").removeClass("show").trigger("close");const t=(e=e.replace(/^\.\/#{2}/,"#").trim()).trim().split("#"),i=t[t.length-1];if(!(""===t[0]||"./"===t[0]||t[0]===new URL(document.baseURI).pathname))return V(e),!0;const o=$(`._anchor[name="${i}" i]`),s=o.length?o.closest("[data-id]"):$(`[data-id="${i}" i]`),n=s.closest(".b_block"),a=s.closest(".m_modal");if("cart"===i)p.emit("ui_modal_close",{}),p.emit("ui_cart_open",{});else if(n.length)B(o.length?o:s),p.emit("ui_cart_close",{}),p.emit("ui_modal_close",{}),setTimeout((()=>{let e=n;if(s&&!n.is(s)){const t=n.offset().top;s.offset().top-t>z.viewportHeight-100&&(e=s)}L.toElement(e)}),30),window.history.replaceState(null,null,`#${i}`);else if(a.length){const e=a.data("id");B(o.length?o:s),p.emit("ui_cart_close",{}),p.emit("ui_modal_open",{id:e})}else window.location.hash=`#${i}`}}function H(e=document){$(e).find("[data-product]").each(((e,t)=>{const i=$(t);let o=i.data("product");i.removeAttr("data-product"),(null==o||"object"==typeof o&&!Object.keys(o).length)&&(o=null),null!==o?i.data("product",o):i.removeData("product")}))}var W=Object.freeze({__proto__:null,gotoLink:j,fixProductData:H});if(window.parent===window&&/mode=/.test(window.location.search)){const e=window.location.href.replace(/mode=\w+/,"").replace(/\?&/,"?").replace(/\?$/,"");window.history.replaceState(null,null,e)}function q(){if(flexbe_cli.lockPopstate)return;const e=window.location.hash||window.parent.location.hash;flexbe_cli.lockPopstate=!0,/^#/.test(e)?j(e):Object.keys(flexbe_cli.modal.opened).length&&p.emit("ui_modal_close"),flexbe_cli.lockPopstate=!1}const R=new WeakMap,G=new WeakMap;function N(e,t=!0){e.updateTween({force:t})}function U(e,t,i){R.set(e,setTimeout((()=>{R.delete(e),i&&i()}),t))}function Q(e,t,i=80){const o="object"==typeof e?e:document.querySelector(`[data-id="${e}"]`),s=null==o?void 0:o._core;s&&(R.get(s)?G.set(s,!0):(N(s,t),U(s,i,(()=>{G.get(s)&&(G.set(s,!1),N(s,t),U(s,i))}))))}function J(e="",t={}){return new Promise(((i,o)=>{$.ajax({url:e,type:t.type||t.method||"POST",dataType:"json",...t}).done((e=>{i(e)})).fail((e=>{const t=e.responseJSON,i=t?new Error(t.message):e;i.status=e.status,i.data=t,o(i)}))}))}var Y={fetch:J,links:W,image:T,entity:Object.freeze({__proto__:null,forceUpdateTween:Q})};let Z;const X={get u_id(){return localStorage.getItem("f_uid")||0},set u_id(e){localStorage.setItem("f_uid",e)},time:0,goals:{quiz:"quiz_start",modal:"modal_open",modal_form:"form_open",modal_done:"done_open",modal_product:"product_show",order_done:"order_done",pay_done:"pay_done",cart:"add_to_cart",link:"link_open",file:"file_load",close:"modal_close",app_link:"app_link_open"},init(){this.reach_goal=this.reachGoal;const e=window.getCookie("user_id");if(flexbe_cli.is_admin||flexbe_cli.is_service||flexbe_cli.run.is_bot||!flexbe_cli.p_id||e)return!1;const{delayed_counters_ms:t}=flexbe_cli.vars._group.optimization;setTimeout((()=>{const e=window.getCookie("f_uid")||X.u_id;e?(X.u_id=e,async function(){try{const e=await J("/mod/stat/visit/",{data:{s_id:flexbe_cli.s_id,group_id:flexbe_cli.group_id,p_id:flexbe_cli.p_id,u_id:X.u_id}});e.v_id||console.warn("Visit was not registered",e)}catch(e){console.error("Visit was not registered",e)}}()):async function(){try{const e=await J("/mod/stat/",{data:{s_id:flexbe_cli.s_id,group_id:flexbe_cli.group_id,p_id:flexbe_cli.p_id,utm_data:K(),device:{type:flexbe_cli.run.device_type,width:flexbe_cli.resize.clientWidth,height:flexbe_cli.resize.clientHeight,dpi:window.devicePixelRatio,browser:navigator.userAgent}}});window.setCookie("f_uid",e.u_id,{Path:"/"}),X.u_id=e.u_id,p.emit("user_created")}catch(e){console.warn("Cookie visit not created",e)}}()}),t),this.AB.init(),this.ecommerce.init(),this.QUIZ.init()},getGoal(e,t){return"modal"===e&&(/form/.test(t)?e="modal_form":/done/.test(t)?e="modal_done":/product/.test(t)?e="modal_product":/quiz/.test(t)&&(e="quiz")),this.goals[e]||!1},reachGoal(e,t={}){!flexbe_cli.is_admin&&e&&(t={goalAction:"send",goalValue:"",...t},p.emit("reach_goal",{name:e,params:t}))},reachGoals(e={},t={}){const i=`${e.goal||""}`.trim(),o=`${e.mainGoal||""}`.trim(),s=`${e.htmlGoal||""}`.trim();if(o&&this.reachGoal(o,t),i)try{this.reachGoal(i,t)}catch(e){console.warn("reachGoals [goal]: ",e.message)}if(s)try{const e=s.replace(/{{\s*goalAction\s*}}/g,t.goalAction||"").replace(/{{\s*goalValue\s*}}/g,t.goalValue||"").replace(/(["']?){{\s*goalParams\s*}}\1/g,JSON.stringify(t.goalParams||{})),i=document.write;document.write=function(e){$("body").eq(0).append(e)};const o=$(`<div style="display:none">${e}</div>`);$("body").eq(0).append(o),setTimeout((()=>{o.remove()}),2e3),clearTimeout(Z),Z=setTimeout((()=>{document.write=i}),1e4)}catch(e){console.warn("reachGoals [htmlGoal]: ",e.message)}},ecommerce:{inited:!1,init(){this.inited=!0,window.dataLayer||(window.dataLayer=[])},add(e){this.inited||this.init(),window.dataLayer.push({ecommerce:{currencyCode:flexbe_cli.locale.currency.code,add:{products:[this._normalizeItem(e)]}}})},remove(e){this.inited||this.init(),window.dataLayer.push({ecommerce:{currencyCode:flexbe_cli.locale.currency.code,remove:{products:[this._normalizeItem(e)]}}})},purchase(e,t=!1){if(e||0!==e.length){this.inited||this.init(),t||(t=Math.ceil(1e4*Math.random()));try{window.dataLayer.push({ecommerce:{currencyCode:flexbe_cli.locale.currency.code,purchase:{actionField:{id:t},products:e.map((e=>this._normalizeItem(e)))}}})}catch(e){}}},_normalizeItem(e){var t,i,o;return{id:e.id,name:e.name||e.title,price:null!=(t=e.price)?t:e.orderPrice,brand:null!=(i=e.brand)?i:e.vendorCode,variant:e.optionsInfo?e.optionsInfo.map((e=>e.name)).join(", "):"",quantity:null!=(o=e.count)?o:e.quantity}}},AB:{proccess:{},init(){p.off("entity_event.abstat").on("entity_event.abstat",((e,{type:t,core:i,params:o})=>{if(!i||"view"!==t||!o.state||!o.first)return;const{abtestId:s,abtestVariant:n}=i;n&&this.fixView(s,n)}))},setCookie(e){window.setCookie("f_ab",JSON.stringify(e),{expires:604800,path:"/",domain:document.location.hostname})},getCookie(){let e=window.getCookie("f_ab");if(e)try{e=JSON.parse(decodeURIComponent(e))}catch(e){console.warn("Can`t parse abtest cookie",e)}return e||(e={view:{},lead:[]}),e},async fixView(e,t){if(null==e||null==t||"a"!==t&&"b"!==t)return!1;if(null==this.getCookie().view[e]&&!this.proccess[e]){this.proccess[e]=!0;try{await J("/mod/stat/abtest/",{data:{testId:e,variant:t,s_id:flexbe_cli.s_id,p_id:flexbe_cli.p_id}});const i=this.getCookie();i.view[e]=t,this.setCookie(i)}catch(e){console.error("Can't fix abtest",e)}this.proccess[e]=!1}}},QUIZ:{inited:!1,init(){this.inited||(this.inited=!0,p.on("quiz_event.stat",((e,t={})=>{const i=t.payload||{};if(!["step","submit"].includes(t.event))return;if("step"===t.event&&!i.toNext)return;const o=t.quiz,s=o.$area.attr("data-page-id"),n=t.answerGoals,a=t.resultGoals,r=o.core.id,l=i.fromAnswers||[],c=i.toId,d=i.sessionId,h=i.fromId,u=l.reduce(((e,t)=>e.concat((t.variants||[]).map((e=>e.id)))),[]);if(this.fixAnswer({sessionId:d,sectionId:r,answerStep:h,answerVariants:u,viewStep:c,pId:s}),n){const e="answer";l.forEach((t=>{if(t.variants&&t.variants.length)t.variants.forEach((t=>{const i=t.value;X.reachGoals(n,{goalAction:e,goalValue:i})}));else{let i=t.value||"";["email","phone","name"].includes(t.type)&&(i=""),X.reachGoals(n,{goalAction:e,goalValue:i})}}))}a&&X.reachGoals(a)})))},fixAnswer({sectionId:e,sessionId:t,answerStep:i,viewStep:o,answerVariants:s,pId:n}){let a;function r(){return J(a,{data:{s_id:flexbe_cli.s_id,group_id:flexbe_cli.group_id,f_uid:X.u_id,page_id:n||flexbe_cli.p_id,session_id:t,section_id:e,answer_step:i,answer_variants:s,view_step:o}})}o&&i?a="/mod/quiz/stat/save/composite/":i?a="/mod/quiz/stat/save/answer/":o&&(a="/mod/quiz/stat/save/view/"),a&&(X.u_id?r():p.one("user_created",(()=>{r()})))}}};function K(){const e=function(e){if(""===e)return{};const t={};for(let i=0;i<e.length;++i){const o=e[i].split("=");2===o.length&&(t[o[0]]=decodeURIComponent(o[1].replace(/\+/g," ")))}return t}(window.location.search.substr(1).split("&")),t={};return $.each(e,((e,i)=>{"utm_"===e.substring(0,4)&&(t[e]=i)})),document.referrer&&(t.url=document.referrer),t}const ee=(e,t=2,i=",",o=".")=>{let s,n;Number.isNaN(t=Math.abs(t))&&(t=2),s=`${parseInt(e=(+e||0).toFixed(t),10)}`,(n=s.length)>3?n%=3:n=0;return(n?s.substr(0,n)+o:"")+s.substr(n).replace(/(\d{3})(?=\d)/g,`$1${o}`)+(t?i+Math.abs(e-s).toFixed(t).replace(/-/,"0").slice(2):"")},te={language:"en",country:"US",currency:{code:"USD",symbol:"$"},date_format:{dateLiteral:"/",dateMask:"DD/MM/YYYY",firstDay:1,dateTimeLiteral:", ",hour12:!1,timeLiteral:":",timeMask:"HH:MM"},translation:{},currency_format:{},tr(e,t){if(!e)return"";const i=/^currency/.test(e)?this.currency:this.translation,o=String(e).replace(/^currency\./,"").split(/\.|:{2}/).reduce(((e,t)=>e&&e[t]),i)||"";return o?this.interpolate(o,t):e},interpolate(e,t={}){const i=e=>{const t=e%100,i=t%10;return 11!==t&&1===i?"one":i>=2&&i<=4&&!(t>=12&&t<=14)?"few":"many"},o=e=>1!==e?"other":"one",s=e=>1===e?"one":e>=2&&e<=4?"few":"many",n={en:o,by:i,cs:s,cz:s,cs_CZ:s,fr:e=>e>1?"other":"one",ge:o,de:o,it:o,kz:o,pl:e=>{if(1===e)return"one";const t=e%10;return t>=2&&t<=4&&(e%100<10||e%100>=20)?"few":"many"},pt:o,ro:o,ro_RO:o,ru:i,es:o,ua:i,lv:e=>{var t;return 0===e?"zero":(null!=(t=e%10==1)?t:e%100==11)?"one":"other"}};return Object.keys(t).forEach((i=>{if("_"!==i&&t.hasOwnProperty(i)){if(e instanceof Object){const o=t[i];e=e[n[te.language](o)]}e=e.replace(new RegExp(`%${i}%`,"g"),t[i])}})),e},parseMoney(e,t=2){const i=(e=String(e).replace(/,/g,".").replace(/ /g,"").replace(/(?!^)-/g,"").replace(/^\./g,"0.")).replace(/[^\d.]/g,"");let o=((i.match(new RegExp(`\\.\\d{1,${t}}$`))||[])[0]||"").replace(/\D/g,""),s=i.replace(new RegExp(`\\.${o}$`),"");s=parseInt(s.replace(/[^\d-]/g,""),10)||0,parseInt(o,10)||(o="");const n=parseFloat(o?`${s}.${o}`:s);return/^-/.test(e)?-n:n},formatMoney(e,{currencyFormat:t=this.currency_format,currencyData:i=this.currency,freeLabel:o=!1,useNonBreakingSpace:s=!1}={}){if(!(e=parseFloat(e))&&o)return te.tr("cart::free_price");const n=t.str,a=t.d,r=Math.abs(e)>=1e4?t.t:"",l=t.d_force||parseInt(e,10)!==e?i.decimals:0,c=ee(Math.abs(e),l,a,r);let d=c;return n&&(d=n.replace(":value",c).replace(":symbol",i.symbol),s&&(d=d.replace(/\s/g,"&nbsp"))),e<0&&(d=`-${d}`),d.trim()},dateToLocaleTimezone(e){if(!e)return null;const t=flexbe_cli.vars._group.timezone||"UTC",i=new Date,o=new Date(i.toLocaleString("en-US",{timeZone:t}));i.setMilliseconds(0),o.setMilliseconds(0);const s=i.getTime()-o.getTime(),n=new Date(e.slice(0,19).replace("T"," "));return new Date(n.getTime()-s)},formatNumber(e,t,i=this.currency_format){const o=i.d,s=Math.abs(e)>=1e4?i.t:"";return t=null!=t?t:i.d_force||parseInt(e,10)!==e?this.currency.decimals:0,ee(Math.abs(e),t,o,s)},animateNumber({target:e,from:t,to:i,asMoney:o,freeLabel:s=!0,duration:n,easing:a}){if(!e)return!1;const r=$(e);null==t&&(t=this.parseMoney(r.text())||"");const l=Math.abs(t-i);if(t===i)return;e._animation&&(e._animation.pause(),e._animation.reset());if(o&&(!i||!t)||l<3||"function"!=typeof anime)r.text(o?this.formatMoney(i,{freeLabel:s}):i);else{const c={value:t};null==n&&(n=Math.max(150,Math.min(.3*l,650))),null==a&&(a="linear"),e._animation=anime({targets:c,value:i,duration:n,easing:a,update:()=>{const e=Math.floor(c.value),t=o?this.formatMoney(e,{freeLabel:s}):e;r.text(t)},complete:()=>{const e=o?this.formatMoney(i,{freeLabel:s}):i;r.text(e)}})}},...flexbe_cli.locale||{}},ie="hover";var oe={init(){this.adaptiveHoverInit(),this.initIosHacks()},adaptiveHoverInit(){$(document).on("touchstart.adaptive_hover_in mouseenter.adaptive_hover_in",".js-hover",(function(e){const t=$(e.currentTarget),i=`adaptive_hover_out_${Math.floor(1e6*Math.random())}`;function o(){t.off(`.${i}`),$(document).off(`.${i}`),t.removeClass(ie)}t.addClass(ie),t.one(`mouseleave.${i}`,o),$(document).one(`touchend.${i}`,o)}))},initIosHacks(e="body"){flexbe_cli.run.is_ios&&$("a, [data-action-target]",e).off("click.iosHacks").on("click.iosHacks",(()=>!0))}};const se={content:"",contentAsHTML:!0,theme:"dark",animation:"fall",animationDuration:[250,180],delay:[180,100],position:"top",autoClose:!0,hideOnClick:!1,interactive:!1,distance:3,maxWidth:350,IEmin:12,trigger:"custom",triggerOpen:{click:!1,touchstart:!1,mouseenter:!0},triggerClose:{click:!1,originClick:!1,mouseleave:!0,touchleave:!0}};var ne={async init(e,t={}){var i,o;if(!e)return!1;let s;await(async()=>{const e=flexbe_cli.vars,t=e._page.themeId,i=e._globals.versionId;return new Promise((e=>{D(["/_s/lib/jquery/tooltipster/tooltipster.patched.min.js",`/_s/build/theme/${t}/_tooltipster.css?${i}`],e)}))})();const n=$(e),a={...se,...t,content:null!=(i=null!=(o=t.content)?o:n.attr("data-tip"))?i:e.innerHTML};a.theme=`tooltipster-${(n.attr("data-theme")||a.theme||se.theme).replace("tooltipster-","")}`,a.maxWidth=parseInt(n.attr("data-width"),10)||a.maxWidth,a.position=n.attr("data-tip-position")||a.position;const r=a.content||"";if(null==jQuery.fn.tooltipster)return console.warn("Tooltipster is not loaded"),!1;try{s=n.tooltipster("instance")}catch(e){}return s||r?(s?(clearTimeout(s._contentTmt),r&&r!==s.content()?(s.content(r),s.enable()):r||this.destroy(e)):(e.tooltipstered=!0,n.tooltipster(a),s=n.tooltipster("instance"),s.on("created",(()=>{n.attr("data-tooltipstered","true"),s._$tooltip.addClass("editor-ui")})),s.on("destroy",(()=>{e.tooltipstered=!1,n.removeAttr("data-tooltipstered")})),s.on("ready",(()=>{s.reposition()}))),t.show&&s.open(),s):void 0},destroy(e){if(!e)return!1;let t;const i=$(e);try{t=i.tooltipster("instance")}catch(e){}t&&(t.destroy(),e.tooltipstered=!1,i.removeAttr("data-tooltipstered"))}};let ae=!1;const re="f_cookies_allowed";var le=new class{constructor(){this.cookieApplied=!1,this.params={show:0,dont_set_if_not_agree:0,use_custom_warning_text:0,custom_warning_text:"",policy_uri:"",style:"right_bottom"}}init(){setTimeout((()=>requestAnimationFrame((()=>{this.params={...this.params,...flexbe_cli.vars._group.cookies_warning||{}},flexbe_cli.is_admin||flexbe_cli.is_service||99===flexbe_cli.theme_id||!this.params.show||localStorage.getItem(re)||ae||this.createNotify()}))),1e3)}createNotify(){const e=this.params,t=$("body"),i=z.viewportHeight/2,o="/\\r\\n|\\r|\\n/g";let s=flexbe_cli.scroll.latest,n=0;if(ae=!0,+e.use_custom_warning_text&&e.custom_warning_text)this.content=e.custom_warning_text.replace(o,"<br />");else{const t="center_compact"===e.style?"cookies.compact_text":"cookies.long_text";this.content=flexbe_cli.locale.tr(t)}const a=e.button_text&&e.use_custom_warning_text?e.button_text.replace(o,"<br />"):flexbe_cli.locale.tr("cookies.button"),r=e.link_text?e.link_text.replace(o,"<br />"):flexbe_cli.locale.tr("cookies.button_link"),l=e.policy_uri?e.policy_uri.replace(o,"<br />"):"/legal/cookie-policy/",c=+e.use_policy?"show":"",d=$(`\n            <div class="cookies-wrap style--${e.style}">\n                <div class="cookies-container">\n                    <div class="cookies-content scrollable">\n                        <span>\n                            ${this.content}\n                            <a href="${l}" target="_blank" class="cookies-button-more ${c}">\n                             ${r}\n                            </a>\n                        </span>\n                    </div>\n\n                    <div class="cookies-button-container">\n                        <a href="${l}" target="_blank" class="cookies-button-more scrollable ${c}">\n                            ${r}\n                        </a>\n                        <div class="cookies-button scrollable">\n                            ${a}\n                        </div>\n                    </div>\n\n                    <div class="cookies-close">\n                        <svg width="14" height="14" viewBox="0 0 14 14" xmlns="http://www.w3.org/2000/svg">\n                             <path d="M7 6L13 0L14 1L8 7L14 13L13 14L7 8L1 14L0 13L6 7L0 1L1 0L7 6Z"/>\n                        </svg>\n                    </div>\n                </div>\n            </div>\n        `);t.find(".cookies-wrap").remove(),t.append(d);const h=()=>{this.cookieApplied||e.dont_set_if_not_agree&&(this.cookieApplied=!0,"function"==typeof window.applyCookies&&window.applyCookies(),document.removeEventListener("scroll",u),$(document).off("click.cookies"))},u=()=>{const e=Math.max(flexbe_cli.scroll.latest-s,s-flexbe_cli.scroll.latest);clearTimeout(this.scrollTimer),this.scrollTimer=setTimeout((()=>{s=flexbe_cli.scroll.latest,n+=e,n>=i&&h()}),200)};setTimeout((()=>{document.addEventListener("scroll",u,{passive:!0})}),500),d.outerWidth(),d.addClass("show"),t.addClass("cookies-warning--show"),d.on("click.cookies",".cookies-button, .cookies-close",(()=>{(()=>{const e=$(".cookies-wrap");e.removeClass("show"),t.removeClass("cookies-warning--show"),localStorage.setItem(re,"allowed"),setTimeout((()=>{e.remove()}),1e3)})(),h()})),$(document).on("click.cookies","a, [data-component]",(()=>h()))}};let ce,de,he=!1;const ue="position-fixed";var pe={createMap:()=>$('[data-is="block"][data-fixed="true"]').toArray().map(((e,t)=>{const i=$(e),o=i.attr("data-fixed-wrapper")||"self",s=i.attr("data-fixed-element"),n="self"===o?i:i.find(o),a=i.find(s);if(!a.length||!n.length)return null;const r=!!i.data("fixed-animation"),l=!!i.data("sticky"),c=a.closest("[data-static-contrast]").attr("data-static-contrast")||a.closest("[data-contrast]").attr("data-contrast"),d=a.closest("[data-fixed-contrast]").attr("data-fixed-contrast")||c,h=Math.round(n.outerHeight()),{top:u}=function(e){if(!e||!e.offsetParent)return null;let t=0,i=0;for(;e;){if("fixed"===$.css(e,"position")){t+=window.scrollY,i+=window.scrollX;break}t+=e.offsetTop-e.scrollTop,i+=e.offsetLeft-e.scrollLeft,e=e.offsetParent}return{top:Math.round(t),left:Math.round(i)}}(n[0])||{},p=u+h;let m=h;if(r){a.hasClass(ue)?m=Math.round(a.outerHeight()):(a.addClass(ue),m=Math.round(a.outerHeight()),a.removeClass(ue))}return{index:t,$block:i,$wrap:n,$fixed:a,top:u,bottom:p,height:h,heightFixed:m,contrastStatic:c,contrastFixed:d,isSticky:l,hasFixedAnimation:r,isFixed:!1,isReplaced:!1}})).filter((e=>{const t="mobile"===flexbe_cli.resize.responsiveMode,i=e.$block.data("hidden");return(!t||"mobile"!==i)&&!(!t&&"desktop"===i)})),modifyMap(e,t){let i=0,o=0;return e.forEach(((s,n)=>{const a=i+t;s.isFixedOld=s.isFixed,s.isFixed=s.hasFixedAnimation?a>s.bottom+50:a>s.top,s.fixOffset=i,s.isSticky&&s.isFixed&&(i+=s.heightFixed),s.isFixed&&(o+=s.heightFixed);const r=n&&e[n-1];s.replaceOffset=0,r&&!r.isSticky&&t+r.fixOffset+r.heightFixed>s.top&&(r.replaceOffset=Math.min(r.fixOffset+r.heightFixed,t+r.fixOffset+r.heightFixed-s.top))})),{allFixedHeight:o}},applyMap(e){const t=!e.applied&&he;e.forEach((e=>{if((e.isFixedOld!==e.isFixed||t)&&(e.$fixed.toggleClass("position-sticky",e.isFixed&&e.isSticky),e.contrastStatic&&e.contrastStatic!==e.contrastFixed&&e.$fixed.attr("data-contrast",e.isFixed?e.contrastFixed:e.contrastStatic),e.hasFixedAnimation?(clearTimeout(e._fixedAnimationBouncer),e.isFixed?(e.$wrap.css("height",`${e.height}px`),e.$fixed.removeClass("fade-out"),e.replaceOffset||(e.$fixed.addClass("position-fixed fade-in"),e._fixedAnimationBouncer=setTimeout((()=>{e.$fixed.removeClass("fade-in")}),200))):(e.$fixed.removeClass("fade-in"),e.replaceOffset||e.$fixed.addClass("fade-out"),e._fixedAnimationBouncer=setTimeout((()=>{e.$wrap.css("height",""),e.$fixed.removeClass("position-fixed fade-out")}),150))):(e.$wrap.css("height",e.isFixed?`${e.height}px`:""),e.$fixed.toggleClass(ue,e.isFixed))),e.isFixed?(e.$fixed[0].style.setProperty("top",`${e.fixOffset}px`,"important"),e.$fixed[0].style.setProperty("transform",e.replaceOffset?`translateY(-${e.replaceOffset}px)`:"none","important")):(e.$fixed[0].style.removeProperty("top"),e.$fixed[0].style.removeProperty("transform")),e.isFixedOld!==e.isFixed){const t=e.$block[0]._core;t&&t.updateTween({fixed:e.isFixed})}})),he=!0,e.applied=!0},getAllFixedHeight(e){const t=this.createMap(),{allFixedHeight:i}=this.modifyMap(t,e);return i},initFixed(){const e=flexbe_cli.is_admin,t="mobile"===flexbe_cli.resize.responsiveMode,i=this.createMap();de=null,ce&&ce(),!i.length||e||t||(ce=function(e,t=60){let i,o,s=0;return i=requestAnimationFrame((function n(a){o||(cancelAnimationFrame(i),i=requestAnimationFrame(n),a-s<1e3/t||(e(a),s=a))})),()=>{o=!0}}((()=>{const e=window.scrollY;de!==e&&(de=e,this.modifyMap(i,e),this.applyMap(i))}),i.length>1?120:30))},init(){this.initFixed();new ResizeObserver((()=>this.initFixed())).observe($("body")[0])}};const me=(e,t=0)=>(...i)=>setTimeout(e,t,...i),fe=(e,t=0,...i)=>me(e,t)(...i);class _e{constructor(e,t={}){this.require=[],this.components=null,this.inited=!1,this.isVisible=null,this.inScreen=!1,this.inBeside=!1,this.inView=!1,this.inFocus=!1,this.wasVisible=null,this.wasScreen=!1,this.wasBeside=!1,this.wasView=!1,this.wasFocus=!1;const i=$(e),o=i.attr("data-is"),s=i.attr("data-id"),n="zone"===o?"e":o[0],a=i.attr(`data-${n}-id`),r=i.attr("data-mod-id")||0;this.$area=i,this.area=i[0],this.$content=i,this.content=this.$content[0],this.$root=i,this.root=i[0],this.is=o,this.id=s,this.template_id=a,this.mod_id=r,this.tween={},this.type=JSON.parse(i.attr(`${n}-type`)||"[]"),Object.keys(t).forEach((e=>{const i=Object.getOwnPropertyDescriptor(t,e);if("value"in i){const i=t[e];this[e]="object"==typeof i?$.extend(!0,Array.isArray(i)?[]:{},i):i}else Object.defineProperty(this,e,i)})),["_onVisible","_onBeside","_onFocus","_onScreen","_onView","_onResize","_onOpen","_onClose","_sendEvent"].forEach((e=>{this[e]=this[e].bind(this)}));let l=this.components;l||(l=4===flexbe_cli.theme_id?[]:Array.from(new Set(i.find("[data-component]").map(((e,t)=>t.getAttribute("data-component"))).toArray()))),l=l.map((e=>"string"==typeof e?flexbe_cli.components.getComponentClass(e):e)).filter((e=>e)),this.components=l}onInit(){}onUpdate(){}onLoad(){}onReady(){}onDestroy(){}onVisible(){}onBeside(){}onFocus(){}onScreen(){}onView(){}onMsg(){}onResize(){}onOpen(){}onClose(){}init(e,t=(this.inited?"update":"init")){"init"===t?this._onInit(e):"update"===t&&this._onUpdate(e),("init"===t||e.templateRendered)&&flexbe_cli.require(this.require,(()=>this._onLoad(e)))}destroy(e){this._onDestroy(e)}_sendEvent(e,t){flexbe_cli.events.emit("entity_event",{type:e,core:this,params:t});const i=new CustomEvent(e,{detail:t});this.area.dispatchEvent(i,{bubbles:!1})}_onInit(e){this.inited=!0,this._sendEvent("init",e),this.onInit(e),requestAnimationFrame((()=>this.updateTween()))}_onLoad(e){this.loaded=!0,this._sendEvent("load",e),this.onLoad(e),this.onReady(e),this.require.length&&requestAnimationFrame((()=>this.updateTween({force:!0})))}_onUpdate(e){this.inited=!0,this.updated=!0,this.modId=this.$area.attr("data-mod-id")||0,this._sendEvent("update",e),this.onUpdate(e),(e.templateRendered||e.styleRendered)&&requestAnimationFrame((()=>this.updateTween({force:!0})))}_onResize(e={}){this.isVisible&&(this._sendEvent("resize",e),this.onResize(e))}_onDestroy(e){this.$area.off(".inherit"),this._sendEvent("destroy",e),this.onDestroy(e),delete this.area._core}_onMsg(e,t){this._sendEvent("msg",{msg:e,data:t}),this.onMsg(e,t)}_onVisible({state:e,force:t}){if(null==this.isVisible)return this.isVisible=e,void(this.wasVisible=e);if(this.isVisible===e&&!t)return;const i=e?!this.wasVisible:void 0;this.isVisible=e,this._sendEvent("visible",{state:e,first:i}),this.onVisible({state:e,first:i}),e&&(this.wasVisible=!0)}_onFocus({state:e,force:t}){if(this.isVisible||(e=!1),this.inFocus===e&&!t)return;const i=e?!this.wasFocus:void 0;this.inFocus=e,this._sendEvent("focus",{state:e,first:i}),this.onFocus(e,i),e&&(this.wasFocus=!0)}_onScreen({state:e,force:t}){if(this.isVisible||(e=!1),this.inScreen===e&&!t)return;const i=e?!this.wasScreen:void 0;this.inScreen=e,this._sendEvent("screen",{state:e,first:i}),this.onScreen(e,i),e&&(this.wasScreen=!0)}_onView({state:e,force:t}){if(this.isVisible||(e=!1),this.inView===e&&!t)return;const i=e?!this.wasView:void 0;this.inView=e,"block"===this.is&&i&&(this.$area.addClass("was-view"),setTimeout((()=>{this.$area.removeClass("wait-animation")}),1200)),this._sendEvent("view",{state:e,first:i}),this.onView(e,i),e&&(this.wasView=!0)}_onBeside({state:e,force:t}){if(this.isVisible||(e=!1),this.inBeside===e&&!t)return;const i=e?!this.wasBeside:void 0;this.inBeside=e,this._sendEvent("beside",{state:e,first:i}),this.onBeside(e,i),e&&(this.wasBeside=!0)}updateTween(){}_onOpen(e){this.updateTween(),this._sendEvent("open",e),this.onOpen(e)}_onClose(e){this.updateTween(),this._sendEvent("close",e),this.onClose()}}var ge=0;function we(e){return"__private_"+ge+++"_"+e}function be(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}const Ae=["id","is","area","content","isVisible","inBeside","inView","inFocus","inScreen","wasBeside","wasFocus","wasScreen","wasView","wasVisible"];let ve=!1;const ye={};function xe(e,t){return Object.keys(t).filter((t=>0===t.indexOf(e)||0===e.indexOf(".")&&t===`${t.split(".")[0]}${e}`))}var $e=we("listeners");class ke{static create(e){return ve||(ve=!0,flexbe_cli.events.on("entity_event.entityPublicApi",((e,{type:t,params:i,core:o})=>{const s=ye[o.id];s&&s.emit(t,i)}))),ye[e.id]&&ye[e.id].clear(),ye[e.id]=new ke(e),ye[e.id]}constructor(e){Object.defineProperty(this,$e,{writable:!0,value:{}});const t=Ae.reduce(((t,i)=>{const o={...t};return o[i]={enumerable:!0,get:()=>e[i]},o}),{});Object.defineProperties(this,t),Object.defineProperties(this,{size:{enumerable:!0,get:()=>({width:e.tween.width,height:e.tween.height})}})}async emit(e,t){const i=xe(e,be(this,$e)[$e]).flatMap((e=>be(this,$e)[$e][e]));for(const e of i)await e(t)}on(e,t){return"function"!=typeof t||(be(this,$e)[$e][e]||(be(this,$e)[$e][e]=[]),be(this,$e)[$e][e].push(t)),this}off(e,t){return xe(e,be(this,$e)[$e]).forEach((e=>{const i=be(this,$e)[$e][e];be(this,$e)[$e][e]=t?i.filter((e=>e!==t)):[]})),this}clear(){be(this,$e)[$e]={}}}const Ce=new Map,Se=".b_block",Ie=".m_modal",Te=".w_widget",Ee='[data-is="zone"]',Pe='[data-is="element"]',Me={block:class extends _e{constructor(e,t){super(e,t),this.is="block",this.$block=this.$area,this.$content=this.$area.find(".container-fluid"),this.content=this.$content[0],this.abtestVariant=this.$area.attr("data-abtest-variant"),this.abtestId=this.abtestVariant&&this.$area.attr("data-abtest-id")}_onInit(e){super._onInit(e)}_onUpdate(e){this.$content=this.$area.find(".container-fluid"),this.content=this.$content[0],super._onUpdate(e)}_onDestroy(e){this.inited=!1,super._onDestroy(e)}updateTween({force:e=!1,fixed:t=!1}={}){if(!this.inited)return!1;let i=this.area,o=0;const s=i.offsetWidth,n=i.offsetHeight;for(;i;)o+=i.offsetTop,i=i.offsetParent;const a=o+n,r=!(!s&&!n),l=null==this.tween.width&&null==this.tween.height,c=e||s!==this.tween.width||n!==this.tween.height,d=1/(n||1)*(flexbe_cli.scroll.latest-o),h=function(){const e=o-flexbe_cli.resize.clientHeight;return 1/(a-e)*(flexbe_cli.scroll.latest-e)}(),u=function(){const e=n||1,t=flexbe_cli.scroll.latest+flexbe_cli.resize.clientHeight/2;return(t-(o+e/2)+e/2)/e}();this.tween.start=o,this.tween.end=a,this.tween.width=s,this.tween.height=n,this.tween.position=d,this.tween.positionAbs=h,this.tween.positionCenter=u;const p=r&&u>0&&u<1,m=p||function(){if(t)return!0;const e=Math.min(n/3,flexbe_cli.resize.clientHeight/4);return flexbe_cli.scroll.latest+flexbe_cli.resize.clientHeight>=o+e&&flexbe_cli.scroll.latest<=a-e}(),f=m||function(){if(t)return!0;return h>=0&&h<=1}(),_=f||function(){if(t)return!0;const e=flexbe_cli.resize.clientHeight/4;return flexbe_cli.scroll.latest+flexbe_cli.resize.clientHeight>o-e&&flexbe_cli.scroll.latest<a+e}();return fe((()=>{this._onVisible({state:r}),!l&&c&&this._onResize({force:e}),this._onBeside({force:e,state:_}),this._onScreen({force:e,state:f}),this._onView({force:e,state:m}),this._onFocus({force:e,state:p})})),fe(this._sendEvent,0,"tween",{tween:this.tween,force:e}),c}},modal:class extends _e{constructor(e,t){super(e,t),this.is="modal",this.isOpen=!1,this.cssPath=`/_s/build/theme/${flexbe_cli.theme_id}/modal/${this.template_id}/modal.css`,this.$modal=this.$area}open({fromId:e,data:t,options:i={}}){if(this.isOpen)return;["OPTIONS","CAPTCHA"].includes(this.template_id)||D([this.cssPath]),this.isOpen=!0,this.lastOptions=i,this.lastScroll=L.latest;const o=this.$area.find(".modal-data > ._anchor").attr("name")||this.id;(i.hash||null==i.hash)&&(this._prevHash=window.location.hash,flexbe_cli.lockPopstate=!0,window.history.pushState(null,null,`#${o}`),flexbe_cli.lockPopstate=!1),this.$area.addClass("show"),flexbe_cli.modal.$list.addClass("show"),$("body").addClass("is-modal-open"),$(".w_cart.show").length&&flexbe_cli.modal.$list.addClass("rise"),setTimeout((()=>{flexbe_cli.modal.$list.addClass("overlay"),this._onOpen({data:t}),this._onBeside({state:!0}),this._onScreen({state:!0}),this._onView({state:!0}),this._onFocus({state:!0}),"function"==typeof i.onOpen&&i.onOpen()}),30),L.scrollLock.lock(),p.emit("modal_opened",{id:this.id,fromId:e,data:t,options:i})}close({openId:e}={}){if(!this.isOpen)return;const t=this.lastOptions,i=!e&&!this.$area.siblings(".show").length;if(this.lastOptions={},this.isOpen=!1,(t.hash||null==t.hash)&&i&&/^#{1,2}/.test(window.location.hash)){const e=this._prevHash&&this._prevHash!==window.location.hash?this._prevHash:window.location.pathname;flexbe_cli.lockPopstate=!0,window.history.replaceState(null,null,e),flexbe_cli.lockPopstate=!1}this.$area.removeClass("show").addClass("hide"),setTimeout((()=>{this.$area.removeClass("show hide"),i&&(flexbe_cli.modal.$list.removeClass("show rise overlay fade-out"),"#cart"!==window.location.hash&&L.scrollLock.unlock(),$("body").removeClass("is-modal-open")),flexbe_cli.run.is_screen_mobile&&$("body, html").scrollTop(this.lastScroll)}),200),this._onClose(),this._onBeside({state:!1}),this._onScreen({state:!1}),this._onView({state:!1}),this._onFocus({state:!1}),"function"==typeof t.onClose&&t.onClose(this),p.emit("modal_closed",{id:this.id,openId:e})}updateTween({force:e}={}){if(!this.inited)return!1;const t=this.area,i=t.offsetWidth,o=t.offsetHeight,s=null==this.tween.width&&null==this.tween.height,n=e||i!==this.tween.width||o!==this.tween.height,a=this.isOpen;return this.tween.width=i,this.tween.height=o,fe((()=>{this._onVisible({force:e,state:a}),!s&&n&&this._onResize({force:e}),this._onBeside({force:e,state:a}),this._onScreen({force:e,state:a}),this._onView({force:e,state:a}),this._onFocus({force:e,state:a})})),fe(this._sendEvent,0,"tween",{tween:this.tween,force:e}),n}},widget:class extends _e{constructor(e,t){super(e,t),this.is="widget",this.$widget=this.$area}updateTween({force:e}={}){if(!this.inited)return!1;const t=this.area,i=t.offsetWidth,o=t.offsetHeight;let s;s=null!=this.isOpen?!!this.isOpen:!(!i&&!o);const n=null==this.tween.width&&null==this.tween.height,a=!!e||i!==this.tween.width||o!==this.tween.height;return a&&(this.tween.width=i,this.tween.height=o),fe((()=>{this._onVisible({force:e,state:s}),!n&&a&&this._onResize({force:e}),this._onBeside({force:e,state:s}),this._onScreen({force:e,state:s}),this._onView({force:e,state:s}),this._onFocus({force:e,state:s})})),fe(this._sendEvent,0,"tween",{tween:this.tween,force:e}),a}},element:class extends _e{constructor(e,t){super(e,t),this.is="element";const i=this.$area.closest("[data-cloned]");this.isClone=i.attr("data-cloned")||!1,this.$content=this.$area.find("> .element-content").addBack().last(),this.content=this.$content[0],this.$root=this.$area.closest(".b_block, .m_modal, .w_widget"),this.root=this.$root[0],this.$parent=this.$area.parent().closest("[data-is]"),this.parent=this.$parent[0]}_onInit(e){super._onInit(e),this._inheritEvents()}_onUpdate(e){this.$area.off(`.inherit.${this.id}`),this.$content=this.$area.find("> .element-content").addBack().last(),this.content=this.$content[0],super._onUpdate(e),this._inheritEvents()}_onDestroy(e){super._onDestroy(e),this.$area.off(".inherit"),this.$parent.off(`.inherit.${this.id}`)}_inheritEvents(){const e=`.inherit.${this.id}.${this.isClone?`clone${Number(this.isClone)}`:"original"}`;this.$parent.off(e),this.$parent.on(`tween${e}`,(e=>{this.updateTween(e.detail||{})})),["visible"].forEach((t=>{this.$parent.on(`${t}${e}`,(()=>{this.updateTween({})}))})),["_onOpen","_onClose","_onDestroy"].forEach((t=>{const i=`${t.replace("_on","").toLowerCase()}${e}`;this.$parent.on(i,((e,...i)=>{!i.length&&e.detail&&(i[0]=e.detail),this[t](...i)}))}))}updateTween({force:e}={}){const t=this.content||this.area,i=this.parent&&this.parent._core,o=this.root&&this.root._core;if(!i||!this.inited)return;const s=null==this.tween.width&&null==this.tween.height;let n=i.isVisible,a=i.inBeside,r=a,l=r,c=r,d=!1;if(o&&"block"===o.is&&n&&a){const{top:i,bottom:o}=t.getBoundingClientRect(),s=t.offsetWidth,h=t.offsetHeight,u=flexbe_cli.resize.clientHeight;if(n=!(!s&&!h),d=e||s!==this.tween.width||h!==this.tween.height,this.tween.width=s,this.tween.height=h,n){a=o>-u/3&&i<u+u/3,r=a&&r&&o>0&&i<u,c=r&&c&&i<=u/2&&i+h>=u/2;const e=Math.min(h/3,flexbe_cli.resize.clientHeight/4);l=c||r&&l&&i+e>0&&o-e<u}}fe((()=>{this.isVisible!==n&&this._onVisible({force:e,state:n}),!s&&d&&this._onResize({force:e}),this._onBeside({force:e,state:a}),this._onScreen({force:e,state:r}),this._onView({force:e,state:l}),this._onFocus({force:e,state:c})})),a&&fe(this._sendEvent,0,"tween",{tween:this.tween,force:e})}}},Oe={block:"sectionApi",modal:"modalApi",widget:"widgetApi",element:"elementApi",zone:"elementApi"};var ze={init(){this.dispatchEvents(),this.initArea(flexbe_cli.block.$list),this.initArea(flexbe_cli.modal.$list),this.initArea(flexbe_cli.widget.$list)},createPublicApi(e){const t={sectionApi:null,modalApi:null,widgetApi:null,elementApi:null,require:D},i=document.querySelector(`[data-id="${e}"]`),o=i.getAttribute("data-is");if(!("block"===o||"modal"===o)){const e=i.closest(".b_block, .m_modal"),o=e.getAttribute("data-is"),s=this.bind(e,{is:o,skipInit:!0});t[Oe[o]]=ke.create(s)}const s=this.bind(i,{is:o,skipInit:!0});return t[Oe[o]]=ke.create(s),t},bind(e,t={}){const i=t.is||e.getAttribute("data-is"),o=e.getAttribute(`data-${i[0]}-id`);if(o&&!e._core){const t=this.getClientJs(i,o)||{};e._core=new Me[i](e,t)}return e._core&&!t.skipInit&&e._core.init(t),e._core},setClientJs(e,t,i){Ce.set(`${e}:${t}`,i)},getClientJs:(e,t)=>Ce.get(`${e}:${t}`),initArea(e,t={}){if(!e.length)return!1;const i=[["block",Se],["modal",Ie],["widget",Te],["element",Ee],["element",Pe]];return H(e),e.toArray().forEach((e=>{const o=$(e);i.forEach((([i,s])=>{const n={...t,is:i};o.is(s)&&this.bind(e,n),o.find(s).toArray().forEach(me((e=>this.bind(e,n))))}))})),e[0]._core},dispatchEvents(){flexbe_cli.is_admin&&(flexbe_cli.events.on("entity_render.core_entity",((e,t)=>{if(!t||!t.id)return;if(t.originId&&t.originId!==t.id)return;const i=t.entity&&t.entity.$area||$(document).find(`[data-id="${t.id}"]`);i.length&&this.initArea(i,t)})),flexbe_cli.events.on("layout_change.core_entity",((e,t)=>{if("before_remove"!==t.action)return;(t.entity&&t.entity.$area||$(document).find(`[data-id="${t.id}"]`)).each(((e,i)=>{i._core&&i._core.destroy(t)}))})),flexbe_cli.events.on("client_msg.core_entity",((e,t)=>{if(!t||!t.id||!t.is)return;const i=t.entity&&t.entity.$area||$(document).find(`[data-id="${t.id}"]`);i.length&&i.each(((e,i)=>{i._core&&i._core._onMsg(t.msg,t.data)}))})))}},Fe={$list:$(".container-list").eq(0),$blocks:$(".b_block"),init(){this.dispatchEvents()},dispatchEvents(){const e=()=>{this.$blocks.each(((e,t)=>Q(t,!1)))};$(window).on("resized.flexbe_block",$.debounce((()=>e()),20)),$(document).on("documentresized.flexbe_block",$.debounce((()=>e()),20)),window.addEventListener("scroll",$.throttle((()=>{this.$blocks.each(((e,t)=>Q(t,!1)))}),96),{passive:!0}),flexbe_cli.is_admin&&flexbe_cli.events.off("layout_change.flexbe_block").on("layout_change.flexbe_block",((e,t)=>{t&&"block"===t.is&&(this.$blocks=$(".b_block"),this.$blocks.each(((e,t)=>Q(t,!1))))}))}};const De=()=>{if(flexbe_cli.is_admin){if((window.parent.flexbe.modal.visible||[]).length)return!1}return!0};var Le={opened:{},$list:$(".modal-list"),init(){const e=window.getJsonFromUrl();if(e.service&&e.m_id)return this.$list.addClass("noanimate"),this.open({id:e.m_id}),!1;this.dispatchEvents()},dispatchEvents(){const e=$("body");if($(window).off("load.preload_modals").one("load.preload_modals",(()=>{setTimeout((()=>{D(this.$list.find(".m_modal").toArray().map((e=>e._core)).filter((e=>e)).map((e=>e.cssPath)))}),5e3)})),flexbe_cli.events.on("ui_modal_open.core_modal",((e,t={})=>{this.open(t)})),flexbe_cli.events.on("ui_modal_close.core_modal",((e,t={})=>{this.close(t)})),e.on("click.modal-close",".m_modal .close",(e=>{e.preventDefault();const t=$(e.currentTarget).closest(".m_modal.show").attr("data-id");this.close({id:t})})),!flexbe_cli.is_admin){let t,i,o={x:0,y:0};e.off(".modal-close-overlay").on("pointerdown.modal-close-overlay pointerup.modal-close-overlay",".modal-data",(e=>{Object.keys(this.opened).length&&De()&&("pointerdown"===e.type?(o={x:e.pageX,y:e.pageY},i=$(e.target).is(".modal-data")||$(e.target).is('[data-overlay="true"]')?e.target:null,t=e.target.clientWidth<=e.pageX):!t&&i===e.target&&Math.sqrt((e.pageX-o.x)**2+(e.pageY-o.y)**2)<10&&setTimeout((()=>{this.close({id:$(i).closest(".m_modal").attr("data-id")})}),50))})),$(window).off(".modal-close-esc").on("keyup.modal-close-esc",(e=>{if(27===e.which&&De()&&Object.keys(this.opened).length){const e=Object.keys(this.opened),t=e[e.length-1];this.close({id:t})}}))}},find(e){if(null==this.$list||!this.$list.length)return!1;const t=this.$list.find(`[data-id="${e}"]`);if(null==t||!t.length)return!1;const i=t.toArray(),o=i[0]||!1;return!!o&&{modals:i,modal:o}},open({id:e,data:t={},options:i={}}={}){let{modal:o}=this.find(e)||{};if(!o)return console.warn("WRONG ACTION","modal_not_found",e),!1;const s=ze.bind(o,{is:"modal"});if(o&&!s)return console.warn("Try to open modal without core object,",`id: ${e},`,"modal: ",o),!1;const n=Object.keys(this.opened),a=n[n.length-1];return!i.rise&&a&&a!==e&&this.close({id:a,openId:e}),n.includes(e)||s.open({fromId:a,data:t,options:i}),s.$area.css("zIndex",Object.keys(this.opened).length+1),delete this.opened[e],this.opened[e]=s,!0},close({id:e,openId:t}={}){if(!e)return Object.keys(this.opened).map((e=>!(!this.opened[e]||e===t)&&this.close({id:e,openId:t})));if(!this.opened[e])return!1;delete this.opened[e];const{modal:i}=this.find(e)||{},o=ze.bind(i,{is:"modal"});return i?o?(o.close({openId:t}),o.$area.css("zIndex",""),!0):(console.warn("Try to close modal without core object"),!1):void 0}},Be={$list:$(".widget-list")};function Ve(e,t=!1){const i=$(e);let o=t?{}:i.data("product");if(!1===o)return!1;if(!o){o=$(e).closest("[data-product-item]").find("[data-product-action]").data("product")}if((null==o||"object"!=typeof o||Array.isArray(o))&&(o={img:i.attr("data-product-image"),title:i.attr("data-product-name"),price:i.attr("data-product-price"),count:i.attr("data-product-count")}),"object"==typeof o&&!o.strict){let e;if(4===flexbe_cli.theme_id?(e=i.parents(".content-zone, .flexbe-card, .flexbe-column, .modal-content").last(),e.length||(e=i.parents("[data-item-id]").last())):e=i.closest("[data-item-id], .modal-data").eq(0),o={...o},o.count||(o.count=1),t||!o.img){const t=e=>{const t=e.find("[data-img-id]").filter(((e,t)=>!$(t).closest(".swiper-slide-duplicate").length)).eq(0),i=t.attr("data-img-id"),o=t.attr("data-img-ext"),s=o?null:t.attr("data-img-name");return i?{id:i,ext:o,name:s}:null};o.img=t(e)||t(e.closest(".flexbe-row"))}if(t||!o.title){let t=e.find(".name, .title, .item-title, .text_title, .element-text--title, .text-style-title:not(.text-rotator), .text-style-subtitle:not(.text-rotator)").eq(0);t.length||(t=e.find(".text-style-content").eq(0)),o.title=t.text().trim()||""}if(t||!o.price&&0!==o.price){const t=e=>{const t=e.clone();flexbe_cli.is_admin&&t.find('[class^="editor"]').remove(),t.find(".text-rotator").remove(),t.find(".component-image").remove(),t.find("del, s, strike").remove();let i=String(t[0]&&t[0].innerText||"").replace(/\n/g,"<br>").replace(/\.$/,"").replace(/\u00a0/g," ");const o=i.match(/(?:\d?\D{0,2} ?)?[1-9](?:[ ,.]?\d{0,3}){2}(?:[,.]\d{1,2})?(?: ?\D)?/g)||[];return i=o.find((e=>e.includes(te.currency.symbol)))||o[0]||"",i=(i.match(/([\d\s]+[ ,.]\d+|[\d\s]+)/g)||[])[0],i?(i=te.parseMoney(i),i):null};o.price=t(i.closest(".element-item").find(".price, .item-price, .main-price, .element-text--price").eq(0))||t(i)||t(e.find(".price, .item-price, .main-price, .element-text--price").eq(0))||t(e)}}if(!o.id)if(o.productId)o.id=`product_${o.productId}:${o.variantId||"default"}`;else{const e=flexbe_cli.p_id,t=i.parents("[data-id], [data-item-id], [data-multivar]").toArray().map((e=>(e.getAttribute("data-id")||e.getAttribute("data-item-id")||"")+(e.getAttribute("data-multivar")||""))).join(":"),n=(s=o.title+o.price,String(s).split("").reduce(((e,t)=>(e=(e<<5)-e+t.charCodeAt(0))&e),0).toString(16));o.id=`${e}_${t||0}:${n}`}var s;return{type:o.productId?"product":"custom",...o}}const je=({date:e,timezone:t,format:i="date"})=>{if(!e||!t)return null;let o=new Date(e);"string"==typeof e&&(o=new Date(e.slice(0,19).replace("T"," ")));const s=new Date,n=new Date(s.toLocaleString("en-US",{timeZone:t}));s.setMilliseconds(0),n.setMilliseconds(0);const a=s.getTime()-n.getTime(),r=o.getTime()-a;return"milliseconds"===i?r:new Date(r)},He=({dateFrom:e,dateTo:t,timezone:i=(()=>{var e,t,i;return null==(e=flexbe)||null==(t=e.vars)||null==(i=t.group)?void 0:i.timezone})()})=>{const o=Date.now(),s=je({date:e,timezone:i,format:"milliseconds"}),n=je({date:t,timezone:i,format:"milliseconds"});return!(s&&s>o||n&&n<o)};let We=[];class qe extends u{constructor(){super(),this.initList()}dispatch(e,...t){const i=this[e];if("function"!=typeof i)throw new Error(`Cart dispatch: action '${e}' doesnt exist`);const o=i.apply(this,t);return this.emit("dispatch",{name:e,args:t,result:o}),o}initList(){let e=[];if(flexbe_cli.is_admin){const t="ru"===flexbe_cli.locale.language,i="RUB"===flexbe_cli.locale.currency.code;e=[{id:"default1",count:1,protect:!0,img:{unq_id:"default1",id:1000000945,ext:"jpg"},title:t?" ":"Example Item",price:i?750:10},{id:"default2",count:2,protect:!0,img:{unq_id:"default2",id:1000000948,ext:"jpg"},title:t?" ":"Another Item",price:i?2550:25}]}else try{e=JSON.parse(localStorage.getItem("f_cart"))||[],e=e.filter((e=>e&&+e.count))}catch(e){console.error(e)}this.dispatch("updateList",e)}getList(){return We}getItem(e){return We.find((t=>t.id===e))}getCount(){return We.reduce(((e,t)=>e+t.count),0)}getTotal(){return We.reduce(((e,t)=>(t.count&&t.price&&(e+=parseInt(String(t.count),10)*parseFloat(String(t.price))),e)),0)}updateList(e){if(!Array.isArray(e))return null;if(e=e.map((e=>{var t;const i=this.getItem(e.id);if("string"==typeof e.img){const t=b(e.img);e.img=t&&{id:t.id,ext:t.ext}}else null!=(t=e.img)&&t.img_id&&(e.img={id:e.img.img_id,ext:e.img.img_ext,unq_id:String(e.img.unq_id||e.img.id)});var o,s,n;(e.img=e.img||null,e.type=e.type||"custom",e.price=null==e.price?null:parseFloat(e.price),i&&null==e.orderPrice)?e.orderPrice=null!=(o=i.orderPrice)?o:i.price:null==e.orderPrice&&(e.orderPrice=e.price);return e.quantity=(n=s=e).quantity===1/0||-1===n.quantity||null==n.quantity?1/0:s.quantity,e.count=+e.count||0,e})),!flexbe_cli.is_admin)try{localStorage.setItem("f_cart",JSON.stringify(e))}catch(e){}return We=e,We}purchase(){flexbe_cli.stat.ecommerce.purchase(We),this.resetList()}resetList(){const e=[...We].filter((e=>e.protect));this.updateList(e)}addItem(e){if(!e.id)throw new Error("Cart add item: product ID is not defined");const t=[...We],i={...e,count:parseFloat(e.count)||1},o=this.getItem(i.id);if(o){const e=t.indexOf(o);i.count+=o.count,t.splice(e,1,i)}else t.push(i);return this.updateList(t),flexbe_cli.stat.ecommerce.add(i),t}removeItem(e){const t=this.getItem(e),i=[...We];return!t||t.protect?We:(i.splice(i.indexOf(t),1),flexbe_cli.stat.ecommerce.remove(t),this.updateList(i))}updateCount({id:e,count:t}){const i=this.getItem(e);if(!i)return null;const o=+i.count||0;"+"===t?i.count+=1:"-"===t&&i.count>0?i.count-=1:i.count=""===t?1:t,Number.isNaN(+i.count)&&(i.count=o),this.updateList(We);const s=i.count-o;return s>0?flexbe_cli.stat.ecommerce.add({...i,count:s}):s<0&&flexbe_cli.stat.ecommerce.remove({...i,count:-s}),i}normalizeListItems(e=We,t={price:!0,count:!1,unavailable:!1}){let i=e.map((e=>{const i={...e};return t.price&&(i.orderPrice=e.price),t.count&&!Ne.cartSettings.allowPreorder&&(i.count=Math.min(e.count,e.quantity)),i}));return t.unavailable&&(i=i.filter((e=>!e.hidden&&e.count))),this.updateList(i),i}}class Re extends u{constructor(){super(),this.enabled=void 0,this.activeMethod=void 0,this.methods=void 0,this.cartSettings=void 0,this.methods=(E._group.ecommerce.delivery||[]).filter((e=>e.enabled)),this.cartSettings=Ne.cartSettings,this.enabled=this.methods.length>0,this.activeMethod=this.methods[0]}dispatch(e,...t){const i=this[e];if("function"!=typeof i)throw new Error(`Delivery dispatch: action '${e}' doesnt exist`);const o=i.apply(this,t);this.emit("dispatch",{name:e,args:t,result:o})}getActive(){const e=this.activeMethod;return e?{id:e.id,type:e.type,title:e.title,desc:e.desc,price:this.getPrice(e.id)}:null}getMethod(e){return this.methods.find((t=>`${t.id}`===e))}selectMethod(e){return this.activeMethod=this.getMethod(e)||this.methods[0],this.activeMethod}getPrice(e){const{appliedPromocode:t}=Ne.promotionStore||{},i=e?this.getMethod(e):this.activeMethod,o=this.cartSettings.useMinTotal?+this.cartSettings.minTotal:0;let s,n=0,a="",r=0,l="",c=0,d="",h=0,u="",p=0,m="",f=!1;if(i){const e=Ne.cartStore.getTotal(),a=(null==t?void 0:t.hasFreeDelivery)&&(null==t?void 0:t.isActive);i.prices.filter((e=>""!==e.from)).forEach(((t,s)=>{i.useMinTotal&&!s&&+t.from&&(n=+t.price,+t.from>o&&(h=+t.from)),(e>=+t.from||!s)&&(n=+t.price),a&&(n=0)}));const _=i.prices.find((e=>0===e.price));f=!!i.useNotFixTotal,s=f&&(!_||""===_.from),_&&(r=+_.from||0,c=Math.max(0,r-e),l=te.formatMoney(r),d=te.formatMoney(c)),h&&(p=Math.max(0,h-e),u=te.formatMoney(h),m=te.formatMoney(p))}return(!f||r&&c<=0)&&(f=!1,a=te.formatMoney(n,{freeLabel:!0})),{current:n,currentFormatted:a,freeFrom:r,freeFromFormatted:l,untilFree:c,untilFreeFormatted:d,minTotal:h,minTotalFormatted:u,untilMinTotal:p,untilMinTotalFormatted:m,notFixedPrice:f,notHasFree:s}}}class Ge extends u{get hasPromotionChanges(){var e,t;return!(null==(e=this.promotionsChanges)||!e.discount)||!(null==(t=this.promotionsChanges)||!t.promocode)}get groupId(){return"object"==typeof flexbe_cli?flexbe_cli.group_id:null}get timezone(){return"object"==typeof flexbe_cli?flexbe_cli.vars._group.timezone:null}constructor(e){super(),this.options=void 0,this.discounts=void 0,this.promocode=void 0,this.activeDiscount=void 0,this.nearestDiscount=void 0,this.appliedPromocode=void 0,this.promotionsChanges=void 0,this.getTotal=void 0,this.getTotalIncludingPromotions=void 0,this.promotions=void 0,this.options=e,this.appliedPromocode=null,this.activeDiscount=null,this.nearestDiscount=null,this.promotionsChanges={},this.getTotal=()=>(null==e.getTotal?void 0:e.getTotal())||0,this.getTotalIncludingPromotions=()=>{var e,t;return this.getTotal()-((null==(e=this.activeDiscount)?void 0:e.discountValue)||0)-((null==(t=this.appliedPromocode)?void 0:t.discountValue)||0)},flexbe_cli.is_admin||this.init(e)}init(e){var t;this.updateDiscountList(null!=(t=flexbe_cli.vars._group.discounts)?t:[],{updateChanges:!1}),e.needUpdateWithLS&&this.updateFromLocalStorage(),this.updateActiveDiscount(!1),this.updateNearestDiscount(),this.bindEvents()}async dispatch(e,...t){const i=this[e];if("function"!=typeof i)throw new Error(`Promotion dispatch: action '${e}' doesnt exist`);const o=await i.apply(this,t);this.emit("dispatch",{name:e,args:t,result:o})}bindEvents(){this.on("dispatch.promotion-store",((e,{name:t})=>{["applyPromocode","removePromocode"].includes(t)&&(this.updateActiveDiscount(),this.updateNearestDiscount())}))}updateActiveDiscount(e=!1){var t;if(!this.discounts.length||this.appliedPromocode&&!this.appliedPromocode.usage_with_any_discount)return void(this.activeDiscount=null);const i=this.discounts.filter((e=>e.isAvailableByTime)),o=this.getTotal(),s=i.filter((e=>o>=e.active_from&&o-e.discountValue>=0)).sort(((e,t)=>t.discountValue-e.discountValue))[0]||null,n=this.activeDiscount,a=s?this.getDiscountData(s.id):null;e&&(null==s?void 0:s.discountValue)!==(null==(t=this.activeDiscount)?void 0:t.discountValue)&&(this.promotionsChanges.discount={oldData:n,newData:a}),this.activeDiscount=a}updateNearestDiscount(){var e;const t=this.getTotal(),i=this.getTotalIncludingPromotions();if(!this.discounts.length||this.appliedPromocode&&!this.appliedPromocode.usage_with_any_discount||i<=0)return void(this.nearestDiscount=null);const o=this.discounts.filter((e=>e.isAvailableByTime)),s=null==(e=o.filter((e=>e.active_from>t)).filter((e=>{if(this.activeDiscount){if("percent"===e.discount_type){const t=e.active_from*e.discount_amount;return"percent"===this.activeDiscount.discount_type?t>e.active_from*this.activeDiscount.discount_amount:t>this.activeDiscount.discount_amount}return+e.discount_amount>this.activeDiscount.discountValue}return!0})).sort(((e,t)=>e.discountValue-t.discountValue)).sort(((e,t)=>e.active_from-t.active_from))[0])?void 0:e.active_from;if(s){const e=o.filter((e=>e.active_from===s)).filter((e=>{var t;return!this.activeDiscount||e.discountValue>(null==(t=this.activeDiscount)?void 0:t.discountValue)})).sort(((e,t)=>t.discountValue-e.discountValue))[0]||{};this.nearestDiscount=e?this.getDiscountData(e.id):null}else this.nearestDiscount=null}updateAppliedPromocode(){var e,t;if(!this.appliedPromocode)return;const i=(null==(e=this.promotionsChanges)||null==(t=e.promocode)?void 0:t.oldData)||this.appliedPromocode,o=this.getPromocodeData();if(i&&o){var s,n;if(i.discountValue!==(null==o?void 0:o.discountValue)||i.delivery_free!==(null==o?void 0:o.delivery_free))this.promotionsChanges.promocode={oldData:(null==(s=this.promotionsChanges)||null==(n=s.promocode)?void 0:n.oldData)||this.appliedPromocode,newData:o,code:this.appliedPromocode.code};else this.acceptPromotionChanges({promocode:!0});this.appliedPromocode=this.promocode}}async applyPromocode(e){const t=this.getTotal();let i;try{i=await this.loadDataPromocode(e)}catch(e){const t=Error();throw t.name="default_error",t}if(this.updatePromocode(i,{updatePromotions:!1}),t&&this.promocode.active_from&&this.promocode.active_from>t){const e=new Error(this.promocode.active_from.toString());throw e.name="total_error",e}if(!this.promocode.isAvailableByTime){const e=new Error;throw e.name="timeout_error",e}this.appliedPromocode=i,this.options.needUpdateWithLS&&localStorage.setItem("applied_promocode",JSON.stringify({code:e,id:this.promocode.id}))}removePromocode(){this.appliedPromocode=null,this.acceptPromotionChanges({promocode:!0}),localStorage.removeItem("applied_promocode")}acceptPromotionChanges({promocode:e,discount:t}={}){e||t?(e&&delete this.promotionsChanges.promocode,t&&delete this.promotionsChanges.discount):this.promotionsChanges={}}async updateFromLocalStorage(){const e=JSON.parse(localStorage.getItem("applied_promocode"));if(e&&e.id&&e.code){var t;let i;try{i=await this.loadDataPromocode(e.code)}catch(e){return void this.removePromocode()}if(this.updatePromocode(i,{updatePromotions:!1}),null==(t=this.promocode)||!t.isActive)return void this.removePromocode();this.appliedPromocode=this.promocode}}getDiscountData(e){return this.discounts.find((t=>t.id===e))}getPromocodeData(){return this.promocode}async loadPromotionList(e){return new Promise(((t,i)=>$.ajax({url:"/api/promotions/get_list/",type:"GET",dataType:"json",data:{promotionType:e}}).done((e=>{t(e)})).fail((e=>{i(e)}))))}async loadDataPromocode(e){return new Promise(((t,i)=>$.ajax({url:"/api/promotions/get_promocode/",type:"GET",dataType:"json",data:{promoCode:e}}).done((e=>{t(e)})).fail((e=>{i(e)}))))}updatePromocode(e,{updatePromotions:t=!0}={}){void 0!==typeof e&&Object.defineProperties(e,{isAvailableByTime:{get:()=>{const{date_from:t,date_to:i}=e;return He({dateFrom:t,dateTo:i,timezone:this.timezone})}},discountValue:{get:()=>{const t=this.getTotal();return e&&"percent"===e.discount_type?Math.round(t*e.discount_amount)/100:+e.discount_amount}},isAvailable:{get:()=>e.isAvailableByTime&&!!this.promocode},isActive:{get:()=>{if(!e.isAvailable)return!1;const t=this.getTotal();return(null==e?void 0:e.active_from)<=t}},hasFreeDelivery:{get:()=>(null==e?void 0:e.delivery_free)||"delivery"===(null==e?void 0:e.discount_type)}}),this.promocode=e,t&&this.updateAppliedPromocode()}updateDiscountList(e,{updateChanges:t=!0,updatePromotions:i=!0}={}){e.forEach((e=>{Object.defineProperties(e,{isAvailableByTime:{get:()=>{const{date_from:t,date_to:i}=e;return He({dateFrom:t,dateTo:i,timezone:this.timezone})}},discountValue:{get:()=>{const t=this.getTotal();return e&&"percent"===e.discount_type?Math.round(t*e.discount_amount)/100:+e.discount_amount}}})})),this.discounts=e,i&&(this.updateActiveDiscount(t),this.updateNearestDiscount())}async loadDiscountList({updateChanges:e=!0,updatePromotions:t=!0}={}){let i;try{i=await this.loadPromotionList("discount")}catch(e){return void(this.discounts=[])}this.updateDiscountList(i,{updateChanges:e,updatePromotions:t})}}var Ne=new class{constructor(){this.cartStore=null,this.deliveryStore=null,this.promotionStore=null,this.getProductInfo=Ve}get cartSettings(){var e,t,i,o;const s=E._group.ecommerce,n=s.cart,a=null!=(e=s.out_of_stock_action)?e:"forbid_preorder",r="allow_preorder"===a,l=n.use_total&&n.total>0;return{useMinTotal:l,minTotal:l?n.total:0,autoOpen:null!=(t=n.auto_open)&&t,inStockStatus:null!=(i=s.in_stock_status)?i:"in_stock",outOfStockStatus:null!=(o=s.out_of_stock_status)?o:"out_of_stock",outOfStockAction:a,allowPreorder:r}}init(e=!1,t=!1){this.cartStore=new qe,t&&(this.promotionStore=new Ge({getTotal:this.cartStore.getTotal,needUpdateWithLS:!flexbe_cli.is_admin})),e&&(this.deliveryStore=new Re)}};void 0===window.flexbe_cli&&(window.flexbe_cli={}),flexbe_cli.helpers=Y,flexbe_cli.vars=E,flexbe_cli.run=M,flexbe_cli.stat=X,flexbe_cli.events=p,flexbe_cli.locale=te,flexbe_cli.adaptive=oe,flexbe_cli.scroll=L,flexbe_cli.resize=z,flexbe_cli.tip=ne,flexbe_cli.require=D,flexbe_cli.fixed=pe,flexbe_cli.entity=ze,flexbe_cli.block=Fe,flexbe_cli.modal=Le,flexbe_cli.widget=Be,flexbe_cli.ecommerce=Ne,function(e=(()=>{})){let t=!1;function i(){t||("undefined"!=typeof jQuery&&jQuery.debounce?(t=!0,requestAnimationFrame((async()=>{await e(),flexbe_cli.is_service||(q(),setTimeout((()=>q()),1e3),window.addEventListener("popstate",q)),flexbe_cli.isInited=!0}))):setTimeout(i,10))}["complete","loaded"].includes(document.readyState)?i():document.addEventListener("DOMContentLoaded",(()=>i()))}((async()=>{E.init(),await M.init(),L.init(),z.init(),oe.init(),fe((()=>X.init())),fe((()=>Ne.init(!0,!0))),fe((()=>Fe.init())),fe((()=>Le.init())),fe((()=>ze.init())),flexbe_cli.components&&fe((()=>flexbe_cli.components.init())),fe((()=>le.init())),fe((()=>pe.init()),200)}))}();
